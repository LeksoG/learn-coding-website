<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DevLearn - Master Programming</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
    font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
    background: #0a0a0a;
    color: #e0e0e0;
    min-height: 100vh;
    overflow-x: hidden;
    transition: background 0.3s ease, color 0.3s ease;
    padding-bottom: 80px;
    /* FIX: Prevent background from showing */
    position: relative;
}

body.light-mode {
    background: #f5f5f5;
    color: #1a1a1a;
}

/* FIX: Ensure html element also has proper background */
html {
    background: #0a0a0a;
    overflow-x: hidden;
}

html.light-mode {
    background: #f5f5f5;
}

/* AUTH SCREEN STYLES - FIXED */
.auth-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: #0a0a0a; /* Solid background instead of gradient on mobile */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    animation: fadeIn 0.5s ease;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}

body.light-mode .auth-screen {
    background: #f5f5f5;
}

        .auth-container {
            background: rgba(30, 30, 30, 0.95);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 25px;
            padding: 50px;
            width: 450px;
            max-width: 90%;
            backdrop-filter: blur(20px);
            animation: slideUp 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        body.light-mode .auth-container {
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(10, 122, 94, 0.3);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .auth-logo {
            text-align: center;
            margin-bottom: 40px;
        }

        .auth-logo-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .auth-logo-text {
            font-size: 2.2em;
            color: #64ffda;
            font-weight: 700;
            text-shadow: 0 0 30px rgba(100, 255, 218, 0.3);
        }

        body.light-mode .auth-logo-text {
            color: #0a7a5e;
        }

        .auth-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .auth-tab {
            flex: 1;
            padding: 12px;
            background: rgba(100, 255, 218, 0.05);
            border: 1px solid rgba(100, 255, 218, 0.2);
            color: #8b949e;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 600;
        }

        .auth-tab.active {
            background: rgba(100, 255, 218, 0.2);
            border-color: #64ffda;
            color: #64ffda;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #e0e0e0;
            font-weight: 600;
            font-size: 0.95em;
        }

        body.light-mode .form-label {
            color: #1a1a1a;
        }

        .form-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(100, 255, 218, 0.05);
            border: 1px solid rgba(100, 255, 218, 0.2);
            border-radius: 15px;
            color: #e0e0e0;
            font-size: 1em;
            font-family: inherit;
            transition: all 0.3s ease;
            outline: none;
        }

        body.light-mode .form-input {
            background: rgba(10, 122, 94, 0.05);
            color: #1a1a1a;
        }

        .form-input:focus {
            border-color: #64ffda;
            background: rgba(100, 255, 218, 0.1);
        }

        .form-button {
            width: 100%;
            padding: 15px;
            background: rgba(100, 255, 218, 0.2);
            border: 1px solid #64ffda;
            color: #64ffda;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .form-button:hover {
            background: rgba(100, 255, 218, 0.3);
            transform: translateY(-2px);
        }

        .form-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .auth-message {
            margin-top: 15px;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            font-weight: 600;
            animation: fadeIn 0.3s ease;
        }

        .auth-message.error {
            background: rgba(255, 100, 100, 0.1);
            border: 1px solid rgba(255, 100, 100, 0.3);
            color: #ff6b6b;
        }

        .auth-message.success {
            background: rgba(100, 255, 100, 0.1);
            border: 1px solid rgba(100, 255, 100, 0.3);
            color: #00ff00;
        }

        /* NAVIGATION - DESKTOP */
        .nav-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            animation: slideDown 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            width: auto;
        }

        .nav-container.search-active {
            width: 500px;
        }

        @keyframes slideDown {
            from { transform: translateX(-50%) translateY(-50px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        .nav-tabs {
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(100, 255, 218, 0.1);
            padding: 8px;
            border-radius: 50px;
            display: flex;
            gap: 8px;
            box-shadow: 0 8px 32px rgba(100, 255, 218, 0.1);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        body.light-mode .nav-tabs {
            background: rgba(255, 255, 255, 0.9);
            border-color: rgba(0, 0, 0, 0.1);
        }

        .nav-tab {
            padding: 12px 28px;
            border: none;
            background: transparent;
            color: #8b949e;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s ease;
        }

        body.light-mode .nav-tab {
            color: #666;
        }

        .nav-tab:hover {
            color: #64ffda;
            background: rgba(100, 255, 218, 0.05);
        }

        .nav-tab.active {
            background: rgba(100, 255, 218, 0.15);
            color: #64ffda;
            box-shadow: 0 0 20px rgba(100, 255, 218, 0.2);
        }

        /* TAB ICONS SCALE ANIMATION */
.nav-tab {
    animation: scaleIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) backwards;
}

.nav-tab:nth-child(1) { animation-delay: 0s; }
.nav-tab:nth-child(2) { animation-delay: 0.1s; }
.nav-tab:nth-child(3) { animation-delay: 0.15s; }
.nav-tab:nth-child(4) { animation-delay: 0.2s; }
.nav-tab:nth-child(5) { animation-delay: 0.25s; }

@keyframes scaleIn {
    0% {
        opacity: 0;
        transform: scale(0.3);
    }
    50% {
        transform: scale(1.1);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}

/* Apply animation when tabs reappear */
.nav-tabs.show-tabs .nav-tab {
    animation: scaleIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55) backwards;
}

        .search-icon {
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: #8b949e;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s ease;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-icon:hover {
            color: #64ffda;
            background: rgba(100, 255, 218, 0.05);
        }

        .search-icon svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .search-input-container {
    display: none;
    position: relative;
    width: 100%;
    padding: 8px 20px;
    opacity: 0;
    transform: scale(0.95);
    transition: all 0.25s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    background: rgba(30, 30, 30, 0.98);
    backdrop-filter: blur(20px);
    border-radius: 50px;
}

body.light-mode .search-input-container {
    background: rgba(255, 255, 255, 0.98);
}

.search-input-container.active {
    display: block;
    opacity: 1;
    transform: scale(1);
}

        .search-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-input {
            width: 100%;
            background: rgba(100, 255, 218, 0.05);
            border: 2px solid rgba(100, 255, 218, 0.3);
            color: #64ffda;
            font-size: 1em;
            font-weight: 600;
            outline: none;
            padding: 10px 40px 10px 15px;
            border-radius: 25px;
            transition: all 0.3s ease;
        }

        body.light-mode .search-input {
            color: #0a7a5e;
            background: rgba(10, 122, 94, 0.05);
            border-color: rgba(10, 122, 94, 0.3);
        }

        .search-input:focus {
            border-color: #64ffda;
            background: rgba(100, 255, 218, 0.1);
        }

        .search-input::placeholder {
            color: #8b949e;
        }

        .search-close-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(100, 255, 218, 0.1);
            border: none;
            color: #64ffda;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1.2em;
            font-weight: 600;
        }

        .search-close-btn:hover {
            background: rgba(100, 255, 218, 0.2);
            transform: translateY(-50%) scale(1.1);
        }

        .search-results {
            position: absolute;
            top: calc(100% + 10px);
            left: 0;
            right: 0;
            background: rgba(30, 30, 30, 0.95);
            border: 2px solid rgba(100, 255, 218, 0.3);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            max-height: 400px;
            overflow-y: auto;
            display: none;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        body.light-mode .search-results {
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(10, 122, 94, 0.3);
        }

        .search-results.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .search-result-item {
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid rgba(100, 255, 218, 0.1);
        }

        .search-result-item:hover {
            background: rgba(100, 255, 218, 0.1);
        }

        .search-result-title {
            color: #64ffda;
            font-weight: 600;
            margin-bottom: 5px;
        }

        body.light-mode .search-result-title {
            color: #0a7a5e;
        }

        .search-result-desc {
            color: #8b949e;
            font-size: 0.85em;
        }

        /* MOBILE NAV - ALWAYS FIXED AT BOTTOM */
.mobile-nav {
    display: none;
    position: fixed;
    bottom: 15px;
    left: 50%;
    transform: translateX(-50%);
    width: calc(100% - 30px);
    max-width: 420px;
    background: rgba(30, 30, 30, 0.95);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(100, 255, 218, 0.2);
    padding: 10px 5px;
    z-index: 10000; /* Increased z-index */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 
                0 0 0 1px rgba(100, 255, 218, 0.1);
    border-radius: 30px;
    transition: none; /* Remove transition to prevent movement */
}

body.light-mode .mobile-nav {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(10, 122, 94, 0.3);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15),
                0 0 0 1px rgba(10, 122, 94, 0.1);
}

@media (max-width: 768px) {
    .mobile-nav {
        display: block;
    }
    
    body {
        padding-bottom: 100px;
    }
}

.mobile-nav-items {
    display: flex;
    justify-content: space-around;
    align-items: center;
    gap: 5px;
}

.mobile-nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 10px 8px;
    color: #8b949e;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    border-radius: 18px;
    min-width: 60px;
    position: relative;
}

.mobile-nav-item::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(100, 255, 218, 0.1);
    border-radius: 18px;
    opacity: 0;
    transform: scale(0.8);
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.mobile-nav-item.active::before {
    opacity: 1;
    transform: scale(1);
}

.mobile-nav-item.active {
    color: #64ffda;
    transform: translateY(-3px);
}

body.light-mode .mobile-nav-item.active {
    color: #0a7a5e;
}

.mobile-nav-icon {
    font-size: 1.5em;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
    z-index: 1;
}

.mobile-nav-item.active .mobile-nav-icon {
    transform: scale(1.15);
}

.mobile-nav-label {
    font-size: 0.7em;
    font-weight: 600;
    position: relative;
    z-index: 1;
}

/* Ripple effect on tap */
.mobile-nav-item:active {
    transform: scale(0.95) translateY(-3px);
}
        .mobile-search-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    z-index: 9999; /* Lower than mobile nav */
    animation: fadeIn 0.3s ease;
}

        .mobile-search-overlay.active {
            display: block;
        }

        .mobile-search-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(30, 30, 30, 0.98);
    backdrop-filter: blur(20px);
    padding: 20px;
    transform: translateY(-100%);
    transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    z-index: 9999; /* Lower than mobile nav */
    border-bottom: 2px solid rgba(100, 255, 218, 0.2);
}

body.light-mode .mobile-search-container {
    background: rgba(255, 255, 255, 0.98);
}

.mobile-search-container.active {
    transform: translateY(0);
}

        .mobile-search-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .mobile-search-back {
            background: rgba(100, 255, 218, 0.1);
            border: none;
            color: #64ffda;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2em;
        }

        .mobile-search-input {
            flex: 1;
            background: rgba(100, 255, 218, 0.05);
            border: 2px solid rgba(100, 255, 218, 0.3);
            color: #64ffda;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1em;
            outline: none;
        }

        .mobile-search-results {
            max-height: calc(100vh - 140px);
            overflow-y: auto;
        }

        .main-content {
            padding-top: 100px;
            min-height: 100vh;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dashboard {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .dashboard-title {
            font-size: 3.5em;
            color: #64ffda;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(100, 255, 218, 0.3);
        }

        body.light-mode .dashboard-title {
            color: #0a7a5e;
            text-shadow: 0 0 20px rgba(10, 122, 94, 0.2);
        }

        .dashboard-subtitle {
            font-size: 1.2em;
            color: #8b949e;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }

        .stat-card {
            background: rgba(30, 30, 30, 0.6);
            border: 1px solid rgba(100, 255, 218, 0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        body.light-mode .stat-card {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(10, 122, 94, 0.2);
        }

        .stat-card:hover {
            border-color: rgba(100, 255, 218, 0.3);
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(100, 255, 218, 0.1);
        }

        .stat-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 2.5em;
            color: #64ffda;
            font-weight: 700;
            margin-bottom: 10px;
        }

        body.light-mode .stat-value {
            color: #0a7a5e;
        }

        .stat-label {
            color: #8b949e;
            font-size: 0.95em;
        }

        .progress-section {
            background: rgba(30, 30, 30, 0.6);
            border: 1px solid rgba(100, 255, 218, 0.1);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        body.light-mode .progress-section {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(10, 122, 94, 0.2);
        }

        .progress-section h2 {
            color: #64ffda;
            margin-bottom: 30px;
            font-size: 1.8em;
        }

        body.light-mode .progress-section h2 {
            color: #0a7a5e;
        }

        .chart-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .chart-tab {
            padding: 10px 24px;
            background: rgba(100, 255, 218, 0.05);
            border: 1px solid rgba(100, 255, 218, 0.2);
            color: #8b949e;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9em;
        }

        .chart-tab:hover {
            background: rgba(100, 255, 218, 0.1);
            color: #64ffda;
        }

        .chart-tab.active {
            background: rgba(100, 255, 218, 0.2);
            border-color: #64ffda;
            color: #64ffda;
        }

        .chart-container {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .chart-container.active {
            display: block;
        }

        /* IMPROVED BAR CHART ALIGNMENT */
.bar-chart {
    display: flex;
    align-items: flex-end;
    gap: 20px;
    height: 320px;
    padding: 20px 0;
    justify-content: center;
}

.bar-item {
    flex: 0 1 140px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    position: relative;
}

.bar {
    width: 100%;
    background: linear-gradient(180deg, #64ffda, #00d4ff);
    border-radius: 15px 15px 0 0;
    transition: height 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
    box-shadow: 0 -5px 30px rgba(100, 255, 218, 0.3);
    min-height: 20px;
}

.bar-value {
    position: absolute;
    top: -35px;
    left: 50%;
    transform: translateX(-50%);
    color: #64ffda;
    font-weight: 700;
    font-size: 0.95em;
    white-space: nowrap;
}

body.light-mode .bar-value {
    color: #0a7a5e;
}

.bar-label {
    color: #8b949e;
    font-size: 0.85em;
    text-align: center;
    word-break: break-word;
    max-width: 100%;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1.3;
}

/* IMPROVED LIGHT THEME */
body.light-mode .form-button {
    background: rgba(10, 122, 94, 0.2);
    border: 2px solid #0a7a5e;
    color: #0a7a5e;
}

body.light-mode .form-button:hover {
    background: rgba(10, 122, 94, 0.3);
}

body.light-mode .run-button {
    background: rgba(10, 122, 94, 0.2);
    border: 2px solid #0a7a5e;
    color: #0a7a5e;
}

body.light-mode .run-button:hover {
    background: rgba(10, 122, 94, 0.3);
}

body.light-mode .submit-button,
body.light-mode .next-button {
    background: rgba(10, 122, 94, 0.2);
    border: 2px solid #0a7a5e;
    color: #0a7a5e;
}

body.light-mode .submit-button:hover,
body.light-mode .next-button:hover {
    background: rgba(10, 122, 94, 0.3);
}

body.light-mode .modal-button.retry {
    background: rgba(10, 122, 94, 0.2);
    border: 2px solid #0a7a5e;
    color: #0a7a5e;
}

body.light-mode .modal-button.retry:hover {
    background: rgba(10, 122, 94, 0.3);
}

body.light-mode .back-button {
    background: rgba(10, 122, 94, 0.15);
    border: 2px solid #0a7a5e;
    color: #0a7a5e;
}

/* GOAL SETTING STYLES */
.set-goal-btn {
    background: rgba(100, 255, 218, 0.2);
    border: 1px solid #64ffda;
    color: #64ffda;
    padding: 10px 25px;
    border-radius: 50px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.95em;
}

.set-goal-btn:hover {
    background: rgba(100, 255, 218, 0.3);
    transform: translateY(-2px);
}

.goal-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 3000;
    animation: fadeIn 0.3s ease;
}

.goal-modal.active {
    display: flex;
}

.goal-modal-content {
    background: rgba(30, 30, 30, 0.95);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 25px;
    padding: 40px;
    max-width: 500px;
    width: 90%;
    animation: modalSlide 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

body.light-mode .goal-modal-content {
    background: rgba(255, 255, 255, 0.95);
}

.goal-header {
    text-align: center;
    margin-bottom: 30px;
}

.goal-header h2 {
    color: #64ffda;
    font-size: 2em;
    margin-bottom: 10px;
}

body.light-mode .goal-header h2 {
    color: #0a7a5e;
}

.goal-input-group {
    margin-bottom: 25px;
}

.goal-input-group label {
    display: block;
    color: #e0e0e0;
    margin-bottom: 10px;
    font-weight: 600;
}

body.light-mode .goal-input-group label {
    color: #1a1a1a;
}

.goal-input {
    width: 100%;
    padding: 15px;
    background: rgba(100, 255, 218, 0.05);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 15px;
    color: #e0e0e0;
    font-size: 1em;
    outline: none;
}

body.light-mode .goal-input {
    background: rgba(10, 122, 94, 0.05);
    border-color: rgba(10, 122, 94, 0.3);
    color: #1a1a1a;
}

.goal-input:focus {
    border-color: #64ffda;
}

.goal-buttons {
    display: flex;
    gap: 15px;
    margin-top: 30px;
}

.goal-btn {
    flex: 1;
    padding: 15px;
    border: none;
    border-radius: 50px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
}

.goal-btn.save {
    background: rgba(100, 255, 218, 0.2);
    border: 2px solid #64ffda;
    color: #64ffda;
}

.goal-btn.save:hover {
    background: rgba(100, 255, 218, 0.3);
}

.goal-btn.cancel {
    background: rgba(100, 100, 100, 0.2);
    border: 2px solid rgba(100, 100, 100, 0.3);
    color: #8b949e;
}

.goal-btn.cancel:hover {
    background: rgba(100, 100, 100, 0.3);
}

/* PROGRESS TAB SWITCHES */
.progress-tab-switches {
    display: flex;
    gap: 12px;
    margin-bottom: 25px;
}

.progress-tab-switch {
    padding: 10px 24px;
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.2);
    color: #8b949e;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
}

.progress-tab-switch.active {
    background: rgba(100, 255, 218, 0.2);
    border-color: #64ffda;
    color: #64ffda;
}

.progress-content-panel {
    display: none;
    animation: fadeIn 0.4s ease;
}

.progress-content-panel.active {
    display: block;
}

.goal-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.goal-stat-card {
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.2);
    padding: 25px;
    border-radius: 15px;
    text-align: center;
}

.goal-stat-value {
    font-size: 2.5em;
    color: #64ffda;
    font-weight: 700;
    margin-bottom: 10px;
}

body.light-mode .goal-stat-value {
    color: #0a7a5e;
}

.goal-stat-label {
    color: #8b949e;
    font-size: 0.9em;
}

.motivational-message {
    background: rgba(100, 255, 218, 0.1);
    border: 1px solid rgba(100, 255, 218, 0.3);
    padding: 20px;
    border-radius: 15px;
    text-align: center;
    color: #64ffda;
    font-size: 1.1em;
    font-weight: 600;
    margin-top: 20px;
}

body.light-mode .motivational-message {
    color: #0a7a5e;
}

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 10, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            animation: fadeIn 0.3s ease-out;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-content {
            text-align: center;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(100, 255, 218, 0.2);
            border-top-color: #64ffda;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: #64ffda;
            font-size: 1.2em;
            font-weight: 600;
        }

        .learn-section {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .learn-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .learn-header h1 {
            font-size: 3em;
            color: #64ffda;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(100, 255, 218, 0.3);
        }

        body.light-mode .learn-header h1 {
            color: #0a7a5e;
        }

        .language-tabs {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .language-tab {
            padding: 12px 30px;
            background: rgba(30, 30, 30, 0.6);
            border: 1px solid rgba(100, 255, 218, 0.1);
            color: #8b949e;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        body.light-mode .language-tab {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(10, 122, 94, 0.2);
        }

        .language-tab:hover {
            border-color: rgba(100, 255, 218, 0.3);
            color: #64ffda;
        }

        .language-tab.active {
            background: rgba(100, 255, 218, 0.15);
            border-color: #64ffda;
            color: #64ffda;
            box-shadow: 0 0 20px rgba(100, 255, 218, 0.2);
        }

        .language-content {
            display: none;
        }

        .language-content.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .course-card {
            background: rgba(30, 30, 30, 0.6);
            border: 1px solid rgba(100, 255, 218, 0.1);
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        body.light-mode .course-card {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(10, 122, 94, 0.2);
        }

        .course-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .course-card:not(.locked):hover {
            border-color: rgba(100, 255, 218, 0.3);
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(100, 255, 218, 0.15);
        }

        .lock-overlay {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 100, 100, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            color: #ff6b6b;
            border: 1px solid rgba(255, 100, 100, 0.3);
        }

        .completed-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(100, 255, 100, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            color: #00ff00;
            border: 1px solid rgba(100, 255, 100, 0.3);
        }

        .course-header {
            padding: 30px;
            background: linear-gradient(135deg, rgba(100, 255, 218, 0.1), rgba(0, 212, 255, 0.1));
        }

        .course-title {
            font-size: 1.8em;
            color: #64ffda;
            margin-bottom: 10px;
        }

        body.light-mode .course-title {
            color: #0a7a5e;
        }

        .course-desc {
            color: #8b949e;
            font-size: 0.95em;
        }

        .course-progress-bar {
            margin: 20px 30px;
        }

        .course-progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .course-progress-name {
            font-weight: 600;
            color: #e0e0e0;
        }

        body.light-mode .course-progress-name {
            color: #1a1a1a;
        }

        .course-progress-percent {
            color: #64ffda;
            font-weight: 700;
        }

        body.light-mode .course-progress-percent {
            color: #0a7a5e;
        }

        .progress-bar {
            height: 8px;
            background: rgba(100, 255, 218, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #64ffda, #00d4ff);
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2500;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: rgba(30, 30, 30, 0.95);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 25px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            animation: modalSlide 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        body.light-mode .modal-content {
            background: rgba(255, 255, 255, 0.95);
        }

        @keyframes modalSlide {
            from { opacity: 0; transform: scale(0.8) translateY(30px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 1.8em;
            color: #64ffda;
            margin-bottom: 10px;
        }

        body.light-mode .modal-title {
            color: #0a7a5e;
        }

        .modal-text {
            color: #8b949e;
            line-height: 1.6;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .modal-button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 50px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-button.retry {
            background: rgba(100, 255, 218, 0.2);
            border: 1px solid #64ffda;
            color: #64ffda;
        }

        .modal-button.retry:hover {
            background: rgba(100, 255, 218, 0.3);
            transform: translateY(-2px);
        }

        .modal-button.continue {
            background: rgba(100, 100, 100, 0.2);
            border: 1px solid rgba(100, 100, 100, 0.3);
            color: #8b949e;
        }

        .modal-button.continue:hover {
            background: rgba(100, 100, 100, 0.3);
        }

        .practice-container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        .practice-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .practice-header h1 {
            font-size: 3em;
            color: #64ffda;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(100, 255, 218, 0.3);
        }

        body.light-mode .practice-header h1 {
            color: #0a7a5e;
        }

        .practice-workspace {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            height: calc(100vh - 250px);
        }

        .code-panel, .output-panel {
            background: rgba(30, 30, 30, 0.6);
            border: 1px solid rgba(100, 255, 218, 0.1);
            border-radius: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        body.light-mode .code-panel,
        body.light-mode .output-panel {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(10, 122, 94, 0.2);
        }

        .panel-header {
            background: rgba(20, 20, 20, 0.8);
            padding: 15px 25px;
            border-bottom: 1px solid rgba(100, 255, 218, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        body.light-mode .panel-header {
            background: rgba(240, 240, 240, 0.9);
        }

        .panel-title {
            color: #64ffda;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        body.light-mode .panel-title {
            color: #0a7a5e;
        }

        .run-button {
            background: rgba(100, 255, 218, 0.2);
            border: 1px solid #64ffda;
            color: #64ffda;
            padding: 8px 24px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .run-button:hover {
            background: rgba(100, 255, 218, 0.3);
            transform: scale(1.05);
        }

        .code-editor-area {
            flex: 1;
            padding: 0;
            overflow: hidden;
        }

        .code-editor-area textarea {
            width: 100%;
            height: 100%;
            background: #0a0a0a;
            color: #e0e0e0;
            border: none;
            padding: 25px;
            font-family: 'Courier New', monospace;
            font-size: 15px;
            line-height: 1.7;
            resize: none;
            outline: none;
        }

        body.light-mode .code-editor-area textarea {
            background: #fff;
            color: #1a1a1a;
        }

        .output-content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            background: #0a0a0a;
        }

        body.light-mode .output-content {
            background: #fff;
        }

        .output-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }

        .console-output {
            color: #64ffda;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            line-height: 1.8;
        }

        body.light-mode .console-output {
            color: #0a7a5e;
        }

        .settings-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .settings-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .settings-header h1 {
            font-size: 3em;
            color: #64ffda;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(100, 255, 218, 0.3);
        }

        body.light-mode .settings-header h1 {
            color: #0a7a5e;
        }

        .settings-section {
            background: rgba(30, 30, 30, 0.6);
            border: 1px solid rgba(100, 255, 218, 0.1);
            padding: 35px;
            border-radius: 20px;
            margin-bottom: 25px;
        }

        body.light-mode .settings-section {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(10, 122, 94, 0.2);
        }

        .settings-section h2 {
            color: #64ffda;
            margin-bottom: 25px;
            font-size: 1.5em;
        }

        body.light-mode .settings-section h2 {
            color: #0a7a5e;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(100, 255, 218, 0.1);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-info h3 {
            color: #e0e0e0;
            margin-bottom: 5px;
        }

        body.light-mode .setting-info h3 {
            color: #1a1a1a;
        }

        .setting-info p {
            color: #8b949e;
            font-size: 0.9em;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: rgba(100, 255, 218, 0.3);
            border-color: #64ffda;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: #64ffda;
            border-radius: 50%;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 2px 8px rgba(100, 255, 218, 0.4);
        }

        .toggle-switch.active::after {
            left: 33px;
        }

        .lesson-view {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #0a0a0a;
            z-index: 2000;
        }

        body.light-mode .lesson-view {
            background: #f5f5f5;
        }

        .lesson-view.active {
            display: flex;
            flex-direction: column;
            animation: iOSSlideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes iOSSlideIn {
            from { opacity: 0; transform: scale(0.9) translateY(50px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .lesson-header-bar {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(20px);
            padding: 20px 30px;
            border-bottom: 1px solid rgba(100, 255, 218, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        body.light-mode .lesson-header-bar {
            background: rgba(255, 255, 255, 0.95);
        }

        .lesson-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .back-button {
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            color: #64ffda;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .back-button:hover {
            background: rgba(100, 255, 218, 0.2);
            transform: translateX(-3px);
        }

        .lesson-title {
            font-size: 1.4em;
            color: #e0e0e0;
        }

        body.light-mode .lesson-title {
            color: #1a1a1a;
        }

        .lesson-progress-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .progress-indicator {
            background: rgba(100, 255, 218, 0.1);
            padding: 8px 20px;
            border-radius: 20px;
            border: 1px solid rgba(100, 255, 218, 0.3);
            font-weight: 600;
            color: #64ffda;
        }

        body.light-mode .progress-indicator {
            color: #0a7a5e;
        }

        .tab-switcher {
            background: rgba(30, 30, 30, 0.6);
            padding: 5px;
            border-radius: 50px;
            display: flex;
            gap: 5px;
        }

        body.light-mode .tab-switcher {
            background: rgba(255, 255, 255, 0.8);
        }

        .tab-switch-btn {
            padding: 8px 24px;
            border: none;
            background: transparent;
            color: #8b949e;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s ease;
        }

        .tab-switch-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .tab-switch-btn.active {
            background: rgba(100, 255, 218, 0.2);
            color: #64ffda;
        }

        body.light-mode .tab-switch-btn.active {
            color: #0a7a5e;
        }

        .lesson-content {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }

        .content-panel {
            display: none;
            max-width: 1000px;
            margin: 0 auto;
        }

        .content-panel.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        .chat-container {
            background: rgba(30, 30, 30, 0.4);
            border: 1px solid rgba(100, 255, 218, 0.1);
            border-radius: 20px;
            padding: 35px;
        }

        body.light-mode .chat-container {
            background: rgba(255, 255, 255, 0.6);
            border-color: rgba(10, 122, 94, 0.2);
        }

        /* Fix chat messages - prevent movement */
.chat-messages {
    display: flex;
    flex-direction: column;
    gap: 25px;
    overflow-x: hidden;
    width: 100%;
    max-width: 100%;
}

.message {
    display: flex;
    gap: 15px;
    animation: messageSlide 0.4s ease-out;
    min-height: fit-content;
    width: 100%;
}

.message-avatar {
    width: 45px;
    height: 45px;
    min-width: 45px;
    min-height: 45px;
    border-radius: 50%;
    background: rgba(100, 255, 218, 0.2);
    border: 2px solid rgba(100, 255, 218, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5em;
    flex-shrink: 0;
}

.message-bubble {
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.1);
    padding: 18px 22px;
    border-radius: 15px;
    line-height: 1.7;
    font-size: 1.05em;
    color: #e0e0e0;
    flex: 1;
    min-width: 0;
    word-wrap: break-word;
    overflow-wrap: break-word;
    /* CRITICAL: This prevents content from affecting layout */
    contain: layout;
}

body.light-mode .message-bubble {
    background: rgba(10, 122, 94, 0.05);
    color: #1a1a1a;
}

/* Ensure code blocks don't cause reflow */
.code-example {
    background: #1a1a1a;
    border: 1px solid rgba(100, 255, 218, 0.2);
    padding: 20px;
    border-radius: 12px;
    margin: 15px 0;
    font-family: 'Courier New', monospace;
    overflow-x: auto;
    max-width: 100%;
}

body.light-mode .code-example {
    background: #f0f0f0;
    border-color: rgba(10, 122, 94, 0.2);
}

.code-example code {
    color: #64ffda;
    line-height: 1.8;
    display: block;
}

body.light-mode .code-example code {
    color: #0a7a5e;
}

        .typing-indicator {
            display: flex;
            gap: 6px;
            padding: 15px 20px;
        }

        .typing-dot {
            width: 10px;
            height: 10px;
            background: #64ffda;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
            30% { transform: translateY(-10px); opacity: 1; }
        }

        .exercise-box {
            background: rgba(100, 255, 218, 0.05);
            border: 1px solid rgba(100, 255, 218, 0.2);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .exercise-title {
            color: #64ffda;
            font-weight: 700;
            margin-bottom: 18px;
            font-size: 1.15em;
        }

        body.light-mode .exercise-title {
            color: #0a7a5e;
        }

        .code-fill {
            background: #1a1a1a;
            border: 1px solid rgba(100, 255, 218, 0.2);
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            line-height: 2;
            margin: 15px 0;
            color: #e0e0e0;
        }

        body.light-mode .code-fill {
            background: #f0f0f0;
            color: #1a1a1a;
        }

        .code-blank-wrapper {
            display: inline-block;
            background: rgba(100, 255, 218, 0.2);
            border: 2px solid transparent;
            border-radius: 6px;
            padding: 2px 4px;
            transition: all 0.3s ease;
        }

        .code-blank-wrapper.correct {
            background: rgba(100, 255, 100, 0.2);
            border-color: #00ff00;
            animation: correctPulse 0.5s ease;
        }

        .code-blank-wrapper.incorrect {
            background: rgba(255, 100, 100, 0.2);
            border-color: #ff6b6b;
            animation: shake 0.5s ease;
        }

        .code-blank {
            background: transparent;
            border: none;
            color: #64ffda;
            font-family: 'Courier New', monospace;
            min-width: 80px;
            text-align: center;
            outline: none;
            font-weight: 600;
            font-size: 1em;
            padding: 2px 8px;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .mcq-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 15px 0;
        }

        .mcq-option {
            background: rgba(100, 255, 218, 0.05);
            border: 1px solid rgba(100, 255, 218, 0.2);
            padding: 15px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #e0e0e0;
        }

        body.light-mode .mcq-option {
            color: #1a1a1a;
        }

        .mcq-option:hover {
            background: rgba(100, 255, 218, 0.1);
            border-color: rgba(100, 255, 218, 0.4);
            transform: translateX(5px);
        }

        .mcq-option.selected {
            background: rgba(100, 255, 218, 0.15);
            border-color: #64ffda;
        }

        .mcq-option.correct {
            background: rgba(100, 255, 100, 0.15);
            border-color: #00ff00;
            animation: correctPulse 0.5s ease;
        }

        .mcq-option.incorrect {
            background: rgba(255, 100, 100, 0.15);
            border-color: #ff6b6b;
            animation: shake 0.5s ease;
        }

        .submit-button {
            background: rgba(100, 255, 218, 0.2);
            border: 1px solid #64ffda;
            color: #64ffda;
            padding: 12px 35px;
            border-radius: 50px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .submit-button:hover {
            background: rgba(100, 255, 218, 0.3);
            transform: translateY(-2px);
        }

        .next-button {
            background: rgba(100, 255, 218, 0.2);
            border: 1px solid #64ffda;
            color: #64ffda;
            padding: 12px 35px;
            border-radius: 50px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .next-button:hover {
            background: rgba(100, 255, 218, 0.3);
            transform: translateY(-2px);
        }

        .feedback {
            margin-top: 15px;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 600;
            animation: feedbackSlide 0.4s ease-out;
        }

        @keyframes feedbackSlide {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feedback.correct {
            background: rgba(100, 255, 100, 0.1);
            border: 1px solid rgba(100, 255, 100, 0.3);
            color: #00ff00;
        }

        .feedback.incorrect {
            background: rgba(255, 100, 100, 0.1);
            border: 1px solid rgba(255, 100, 100, 0.3);
            color: #ff6b6b;
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 768px) {
            body {
                padding-bottom: 70px;
            }

            .nav-container {
                display: none !important;
            }

            .mobile-nav {
                display: block;
            }

            .main-content {
                padding-top: 20px;
            }

            .dashboard-title {
                font-size: 2.5em;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .practice-workspace {
                grid-template-columns: 1fr;
                height: auto;
            }

            .code-panel, .output-panel {
                min-height: 400px;
            }

            .bar-chart {
                height: 200px;
            }

            .course-grid {
                grid-template-columns: 1fr;
            }

            .auth-container {
                padding: 30px 20px;
            }

            .lesson-header-bar {
                flex-wrap: wrap;
                gap: 15px;
            }

            .lesson-progress-info {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (max-width: 480px) {
            .dashboard-title {
                font-size: 2em;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 30px 20px;
            }

            .modal-buttons {
                flex-direction: column;
            }
        }

        /* IMPROVED SETTINGS */
.account-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(30, 30, 30, 0.6);
    border: 1px solid rgba(100, 255, 218, 0.1);
    padding: 30px 35px;
    border-radius: 20px;
    margin-bottom: 25px;
}

body.light-mode .account-header {
    background: rgba(255, 255, 255, 0.8);
    border-color: rgba(10, 122, 94, 0.2);
}

.account-info {
    display: flex;
    align-items: center;
    gap: 20px;
}

.account-avatar {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: linear-gradient(135deg, #64ffda, #00d4ff);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2em;
    font-weight: 700;
    color: #0a0a0a;
    box-shadow: 0 5px 20px rgba(100, 255, 218, 0.3);
}

.account-details h2 {
    color: #64ffda;
    margin-bottom: 5px;
    font-size: 1.5em;
}

body.light-mode .account-details h2 {
    color: #0a7a5e;
}

.account-details p {
    color: #8b949e;
    font-size: 0.9em;
}

.logout-btn {
    background: rgba(255, 100, 100, 0.2);
    border: 1px solid rgba(255, 100, 100, 0.3);
    color: #ff6b6b;
    padding: 12px 30px;
    border-radius: 50px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
}

.logout-btn:hover {
    background: rgba(255, 100, 100, 0.3);
    transform: translateY(-2px);
}

.settings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
}

.setting-card {
    background: rgba(30, 30, 30, 0.6);
    border: 1px solid rgba(100, 255, 218, 0.1);
    padding: 25px;
    border-radius: 15px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    transition: all 0.3s ease;
}

body.light-mode .setting-card {
    background: rgba(255, 255, 255, 0.8);
    border-color: rgba(10, 122, 94, 0.2);
}

.setting-card:hover {
    border-color: rgba(100, 255, 218, 0.3);
    transform: translateY(-3px);
}

.setting-card h3 {
    color: #64ffda;
    font-size: 1.1em;
    margin-bottom: 5px;
}

body.light-mode .setting-card h3 {
    color: #0a7a5e;
}

.setting-card p {
    color: #8b949e;
    font-size: 0.9em;
    flex: 1;
}

/* MOBILE SETTINGS OPTIMIZATION */
@media (max-width: 768px) {
    .settings-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .setting-card {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        padding: 20px;
        gap: 15px;
    }
    
    .setting-card h3 {
        font-size: 1em;
        margin-bottom: 0;
    }
    
    .setting-card p {
        font-size: 0.85em;
        margin: 0;
    }
    
    .setting-card > div:first-child {
        flex: 1;
    }
    
    .toggle-switch {
        flex-shrink: 0;
    }
    
    .submit-button {
        flex-shrink: 0;
        padding: 10px 20px;
        font-size: 0.9em;
    }
}

/* SMOOTH ANIMATIONS */
.nav-tabs {
    opacity: 1;
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.nav-tabs.hiding {
    opacity: 0;
    transform: scale(0.95);
}

.chat-messages {
    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* UPDATE SPLASH SCREEN */
.update-splash {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    animation: fadeIn 0.4s ease;
}

.update-splash.active {
    display: flex;
}

.update-content {
    background: linear-gradient(135deg, 
        rgba(30, 30, 30, 0.98), 
        rgba(20, 25, 35, 0.98));
    border: 2px solid rgba(100, 255, 218, 0.4);
    box-shadow: 0 20px 80px rgba(100, 255, 218, 0.3);
}

body.light-mode .update-content {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.98), 
        rgba(250, 252, 255, 0.98));
    border-color: rgba(10, 122, 94, 0.4);
    box-shadow: 0 20px 80px rgba(10, 122, 94, 0.2);
}

.close-splash-btn {
    font-size: 1.1em;
    padding: 15px 45px;
    background: linear-gradient(135deg, 
        rgba(100, 255, 218, 0.3), 
        rgba(0, 212, 255, 0.3));
    box-shadow: 0 5px 20px rgba(100, 255, 218, 0.4);
}

.close-splash-btn:hover {
    background: linear-gradient(135deg, 
        rgba(100, 255, 218, 0.4), 
        rgba(0, 212, 255, 0.4));
    transform: translateY(-3px);
    box-shadow: 0 8px 30px rgba(100, 255, 218, 0.5);
}

@keyframes splashSlide {
    from { opacity: 0; transform: scale(0.8) translateY(50px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

.update-icon {
    font-size: 5em;
    margin-bottom: 20px;
}

.update-title {
    font-size: 2.5em;
    color: #64ffda;
    margin-bottom: 15px;
    text-shadow: 0 0 30px rgba(100, 255, 218, 0.3);
}

body.light-mode .update-title {
    color: #0a7a5e;
}

.update-version {
    color: #8b949e;
    margin-bottom: 30px;
    font-size: 1.1em;
}

.changelog {
    text-align: left;
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.2);
    border-radius: 15px;
    padding: 25px;
    margin-bottom: 30px;
}

.changelog h3 {
    color: #64ffda;
    margin-bottom: 15px;
    font-size: 1.2em;
}

body.light-mode .changelog h3 {
    color: #0a7a5e;
}

.changelog ul {
    list-style: none;
    padding: 0;
}

.changelog li {
    color: #e0e0e0;
    padding: 10px 0;
    padding-left: 30px;
    position: relative;
}

body.light-mode .changelog li {
    color: #1a1a1a;
}

.changelog li::before {
    content: "✓";
    position: absolute;
    left: 0;
    color: #64ffda;
    font-weight: 700;
}

.close-splash-btn {
    background: rgba(100, 255, 218, 0.2);
    border: 1px solid #64ffda;
    color: #64ffda;
    padding: 15px 40px;
    border-radius: 50px;
    font-size: 1.1em;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
}

.close-splash-btn:hover {
    background: rgba(100, 255, 218, 0.3);
    transform: translateY(-2px);
}

.bar-chart {
    display: flex;
    align-items: flex-end;
    gap: 30px;
    height: 350px;
    padding: 20px 20px 60px 80px;
    justify-content: center;
    position: relative;
    background: 
        linear-gradient(90deg, rgba(100, 255, 218, 0.03) 1px, transparent 1px),
        linear-gradient(0deg, rgba(100, 255, 218, 0.03) 1px, transparent 1px);
    background-size: 50px 35px;
}

/* Y-axis (left vertical line) */
.bar-chart::before {
    content: '';
    position: absolute;
    left: 70px;
    bottom: 50px;
    width: 3px;
    height: calc(100% - 70px);
    background: linear-gradient(180deg, rgba(100, 255, 218, 0.5), rgba(100, 255, 218, 0.2));
    border-radius: 2px;
}

/* X-axis (bottom horizontal line) */
.bar-chart::after {
    content: '';
    position: absolute;
    left: 70px;
    bottom: 50px;
    width: calc(100% - 90px);
    height: 3px;
    background: linear-gradient(90deg, rgba(100, 255, 218, 0.5), rgba(100, 255, 218, 0.2));
    border-radius: 2px;
}

.chart-y-labels {
    position: absolute;
    left: 10px;
    top: 20px;
    bottom: 60px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    color: #64ffda;
    font-size: 0.85em;
    font-weight: 600;
    z-index: 10;
}

body.light-mode .chart-y-labels {
    color: #0a7a5e;
}

.chart-y-labels span {
    background: rgba(10, 10, 10, 0.8);
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px solid rgba(100, 255, 218, 0.3);
}

body.light-mode .chart-y-labels span {
    background: rgba(245, 245, 245, 0.9);
    border-color: rgba(10, 122, 94, 0.3);
}

.bar-item {
    flex: 0 1 120px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    position: relative;
    height: 280px; /* Fixed height for consistent calculation */
    justify-content: flex-end;
}

.bar {
    width: 100%;
    background: linear-gradient(180deg, #64ffda 0%, #00d4ff 100%);
    border-radius: 12px 12px 0 0;
    transition: height 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
    box-shadow: 
        0 -5px 30px rgba(100, 255, 218, 0.3),
        inset 0 -2px 10px rgba(255, 255, 255, 0.3);
    min-height: 0px;
    max-height: 100%;
    border: 2px solid rgba(100, 255, 218, 0.4);
    border-bottom: none;
}

body.light-mode .bar {
    background: linear-gradient(180deg, #0a7a5e 0%, #00a896 100%);
    box-shadow: 
        0 -5px 30px rgba(10, 122, 94, 0.3),
        inset 0 -2px 10px rgba(255, 255, 255, 0.5);
    border-color: rgba(10, 122, 94, 0.5);
}

.bar-value {
    position: absolute;
    top: -35px;
    left: 50%;
    transform: translateX(-50%);
    color: #64ffda;
    font-weight: 700;
    font-size: 1em;
    white-space: nowrap;
    background: rgba(10, 10, 10, 0.9);
    padding: 6px 12px;
    border-radius: 8px;
    border: 1px solid rgba(100, 255, 218, 0.3);
    box-shadow: 0 4px 15px rgba(100, 255, 218, 0.2);
}

body.light-mode .bar-value {
    color: #0a7a5e;
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(10, 122, 94, 0.3);
}

.bar-label {
    color: #8b949e;
    font-size: 0.9em;
    text-align: center;
    word-break: break-word;
    max-width: 100%;
    height: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1.3;
    position: absolute;
    bottom: -45px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* STREAK CELEBRATION */
.streak-celebration {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0);
    z-index: 5000;
    display: none;
    justify-content: center;
    align-items: center;
    pointer-events: none;
    transition: background 0.5s ease;
}

.streak-celebration.active {
    display: flex;
}

.streak-celebration.show-bg {
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(10px);
}

.streak-card-animated {
    background: rgba(30, 30, 30, 0.6);
    border: 1px solid rgba(100, 255, 218, 0.1);
    padding: 30px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
    box-shadow: 0 10px 40px rgba(100, 255, 218, 0.1);
    width: 280px;
    min-width: 280px;
    opacity: 0;
    position: fixed;
    transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    will-change: transform, opacity, left, top;
}

body.light-mode .streak-card-animated {
    background: rgba(255, 255, 255, 0.8);
    border-color: rgba(10, 122, 94, 0.2);
    box-shadow: 0 10px 40px rgba(10, 122, 94, 0.1);
}

.streak-icon-big {
    font-size: 2.5em;
    text-align: center;
    margin-bottom: 15px;
    transition: transform 0.3s ease;
}

.streak-number-container {
    position: relative;
    height: 60px;
    overflow: hidden;
    margin-bottom: 10px;
}

.streak-number-big {
    font-size: 2.5em;
    color: #64ffda;
    font-weight: 700;
    text-align: center;
    text-shadow: 0 0 30px rgba(100, 255, 218, 0.5);
    position: absolute;
    width: 100%;
    top: 0;
    left: 0;
    transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.6s ease;
    line-height: 1;
}

body.light-mode .streak-number-big {
    color: #0a7a5e;
    text-shadow: 0 0 30px rgba(10, 122, 94, 0.5);
}

.streak-text-big {
    font-size: 0.95em;
    color: #8b949e;
    text-align: center;
    font-weight: 600;
}

/* Add this new class */
.stat-card.animating {
    opacity: 0 !important;
    transition: opacity 0.3s ease;
}

body.light-mode .keyword-highlight {
    background: linear-gradient(120deg, rgba(10, 122, 94, 0.2) 0%, rgba(10, 122, 94, 0.1) 100%);
    color: #0a7a5e;
    border-bottom-color: rgba(10, 122, 94, 0.5);
}

/* AI Explanation Modal */
.ai-explanation-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 6000;
    animation: fadeIn 0.3s ease;
}

.ai-explanation-modal.active {
    display: flex;
}

.ai-explanation-content {
    background: rgba(30, 30, 30, 0.98);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 20px;
    padding: 40px;
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
    animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

body.light-mode .ai-explanation-content {
    background: rgba(255, 255, 255, 0.98);
    border-color: rgba(10, 122, 94, 0.3);
}

@keyframes popIn {
    0% {
        opacity: 0;
        transform: scale(0.3) translateY(100px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.ai-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: rgba(255, 100, 100, 0.2);
    border: 1px solid rgba(255, 100, 100, 0.3);
    color: #ff6b6b;
    font-size: 1.5em;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.ai-close-btn:hover {
    background: rgba(255, 100, 100, 0.3);
    transform: rotate(90deg);
}

.ai-keyword-display {
    font-size: 2em;
    color: #64ffda;
    font-weight: 700;
    text-align: center;
    margin-bottom: 25px;
    text-shadow: 0 0 20px rgba(100, 255, 218, 0.3);
}

body.light-mode .ai-keyword-display {
    color: #0a7a5e;
}

.ai-loading {
    text-align: center;
    color: #8b949e;
    padding: 20px;
}

.ai-spinner {
    width: 40px;
    height: 40px;
    border: 4px solid rgba(100, 255, 218, 0.2);
    border-top-color: #64ffda;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 20px auto;
}

.ai-explanation-text {
    color: #e0e0e0;
    line-height: 1.8;
    font-size: 1.05em;
}

body.light-mode .ai-explanation-text {
    color: #1a1a1a;
}

.ai-explanation-text p {
    margin-bottom: 15px;
}

.ai-explanation-text strong {
    color: #64ffda;
}

body.light-mode .ai-explanation-text strong {
    color: #0a7a5e;
}

.feature-preview {
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.2);
    border-radius: 15px;
    padding: 20px;
    margin-top: 25px;
    text-align: center;
}

.preview-label {
    color: #8b949e;
    font-size: 0.9em;
    margin-bottom: 15px;
    font-weight: 600;
}

.preview-demo {
    position: relative;
    display: inline-block;
    font-size: 1.5em;
}

.demo-highlight {
    animation: demoGlow 2s ease-in-out infinite;
}

@keyframes demoGlow {
    0%, 100% { box-shadow: 0 0 10px rgba(100, 255, 218, 0.3); }
    50% { box-shadow: 0 0 20px rgba(100, 255, 218, 0.6); }
}

.preview-explanation {
    position: absolute;
    top: calc(100% + 10px);
    left: 50%;
    transform: translateX(-50%) scale(0);
    background: rgba(30, 30, 30, 0.98);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 12px;
    padding: 15px 20px;
    min-width: 200px;
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    pointer-events: none;
    z-index: 10;
}

body.light-mode .preview-explanation {
    background: rgba(255, 255, 255, 0.98);
}

.preview-explanation.show {
    transform: translateX(-50%) scale(1);
    opacity: 1;
}

.preview-ai-icon {
    font-size: 2em;
    margin-bottom: 8px;
    animation: sparkle 1s ease-in-out infinite;
}

@keyframes sparkle {
    0%, 100% { transform: scale(1) rotate(0deg); }
    25% { transform: scale(1.1) rotate(-5deg); }
    75% { transform: scale(1.1) rotate(5deg); }
}

.preview-text {
    color: #64ffda;
    font-weight: 600;
    font-size: 0.9em;
}

body.light-mode .preview-text {
    color: #0a7a5e;
}

/* UPDATE SPLASH SCREEN */
.update-splash {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    animation: fadeIn 0.4s ease;
    overflow: hidden;
}

.update-splash.active {
    display: flex;
    overflow: hidden;
}

/* Prevent body scroll when splash is open */
body.splash-open {
    overflow: hidden;
}

.update-content {
    background: rgba(30, 30, 30, 0.95);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 25px;
    padding: 35px;
    max-width: 550px;
    width: 90%;
    max-height: 85vh;
    overflow-y: auto;
    text-align: center;
    animation: splashSlide 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

body.light-mode .update-content {
    background: rgba(255, 255, 255, 0.95);
}

.update-icon {
    font-size: 4em;
    margin-bottom: 15px;
}

.update-title {
    font-size: 2em;
    color: #64ffda;
    margin-bottom: 10px;
    text-shadow: 0 0 30px rgba(100, 255, 218, 0.3);
}

body.light-mode .update-title {
    color: #0a7a5e;
}

.update-version {
    color: #8b949e;
    margin-bottom: 25px;
    font-size: 1em;
}

.changelog {
    text-align: left;
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.2);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 25px;
}

.changelog h3 {
    color: #64ffda;
    margin-bottom: 15px;
    font-size: 1.1em;
    text-align: center;
}

body.light-mode .changelog h3 {
    color: #0a7a5e;
}

.changelog ul {
    list-style: none;
    padding: 0;
}

.changelog li {
    color: #e0e0e0;
    padding: 8px 0;
    padding-left: 25px;
    position: relative;
    font-size: 0.95em;
    line-height: 1.4;
}

body.light-mode .changelog li {
    color: #1a1a1a;
}

.changelog li::before {
    content: "✓";
    position: absolute;
    left: 0;
    color: #64ffda;
    font-weight: 700;
}

.feature-preview {
    background: rgba(100, 255, 218, 0.08);
    border: 1px solid rgba(100, 255, 218, 0.25);
    border-radius: 12px;
    padding: 15px;
    margin-top: 15px;
}

.preview-label {
    color: #8b949e;
    font-size: 0.85em;
    margin-bottom: 12px;
    font-weight: 600;
}

.preview-demo {
    position: relative;
    display: inline-block;
    font-size: 1.3em;
    padding-bottom: 100px;
}

.demo-highlight {
    pointer-events: none;
    animation: demoGlow 2s ease-in-out infinite;
}

@keyframes demoGlow {
    0%, 100% { 
        box-shadow: 0 0 10px rgba(100, 255, 218, 0.3);
        transform: translateY(0);
    }
    50% { 
        box-shadow: 0 0 20px rgba(100, 255, 218, 0.6);
        transform: translateY(-2px);
    }
}

.preview-explanation {
    position: absolute;
    top: calc(100% + 15px);
    left: 50%;
    transform: translateX(-50%) scale(0);
    background: rgba(30, 30, 30, 0.98);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 12px;
    padding: 15px 20px;
    min-width: 180px;
    opacity: 0;
    animation: previewPop 3s ease-in-out infinite;
    pointer-events: none;
    z-index: 10;
}

body.light-mode .preview-explanation {
    background: rgba(255, 255, 255, 0.98);
}

@keyframes previewPop {
    0%, 100% {
        transform: translateX(-50%) scale(0);
        opacity: 0;
    }
    20%, 80% {
        transform: translateX(-50%) scale(1);
        opacity: 1;
    }
}

.preview-ai-icon {
    font-size: 2em;
    margin-bottom: 5px;
    animation: sparkle 1.5s ease-in-out infinite;
}

@keyframes sparkle {
    0%, 100% { transform: scale(1) rotate(0deg); }
    25% { transform: scale(1.15) rotate(-8deg); }
    75% { transform: scale(1.15) rotate(8deg); }
}

.preview-text {
    color: #64ffda;
    font-weight: 600;
    font-size: 0.85em;
}

body.light-mode .preview-text {
    color: #0a7a5e;
}

.close-splash-btn {
    background: rgba(100, 255, 218, 0.2);
    border: 1px solid #64ffda;
    color: #64ffda;
    padding: 12px 35px;
    border-radius: 50px;
    font-size: 1em;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
}

.close-splash-btn:hover {
    background: rgba(100, 255, 218, 0.3);
    transform: translateY(-2px);
}

/* Horizontal wave loading - teal/cyan color */
.wave-container {
    display: flex;
    flex-direction: column;
    gap: 12px;
    width: 300px;
    max-width: 90%;
}

.wave-line {
    width: 100%;
    height: 8px;
    background: rgba(100, 255, 218, 0.2);
    border-radius: 20px;
    position: relative;
    overflow: hidden;
}

.wave-line::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent,
        rgba(100, 255, 218, 0.4),
        #64ffda,
        rgba(100, 255, 218, 0.4),
        transparent
    );
    animation: waveSlide 2.5s ease-in-out infinite; /* Changed from 1.8s to 2.5s */
    box-shadow: 0 0 20px rgba(100, 255, 218, 0.6);
}

body.light-mode .wave-line {
    background: rgba(10, 122, 94, 0.2);
}

body.light-mode .wave-line::before {
    background: linear-gradient(90deg, 
        transparent,
        rgba(10, 122, 94, 0.4),
        #0a7a5e,
        rgba(10, 122, 94, 0.4),
        transparent
    );
    box-shadow: 0 0 20px rgba(10, 122, 94, 0.6);
}

.wave-line:nth-child(1)::before {
    animation-delay: 0s;
}

.wave-line:nth-child(2)::before {
    animation-delay: 0.3s;
}

.wave-line:nth-child(3)::before {
    animation-delay: 0.6s;
}

@keyframes waveSlide {
    0% {
        left: -100%;
    }
    100% {
        left: 100%;
    }
}

/* Smooth typing animation - faster */
.typing-word {
    display: inline;
    opacity: 1 !important;
}

/* Teal glow following text - matches loading color */
.ai-explanation-text {
    position: relative;
}

.word-glow-effect {
    background: linear-gradient(90deg,
        transparent,
        rgba(100, 255, 218, 0.15),
        rgba(100, 255, 218, 0.3),
        rgba(100, 255, 218, 0.15),
        transparent
    );
    padding: 2px 6px;
    border-radius: 4px;
    display: inline;
    box-shadow: 0 0 15px rgba(100, 255, 218, 0.4);
    animation: glowFade 0.6s ease-out forwards;
}

body.light-mode .word-glow-effect {
    background: linear-gradient(90deg,
        transparent,
        rgba(10, 122, 94, 0.12),
        rgba(10, 122, 94, 0.25),
        rgba(10, 122, 94, 0.12),
        transparent
    );
    box-shadow: 0 0 15px rgba(10, 122, 94, 0.4);
}

@keyframes glowFade {
    0% {
        opacity: 0;
        transform: scale(0.98);
    }
    50% {
        opacity: 1;
        transform: scale(1);
    }
    100% {
        opacity: 0;
        transform: scale(1);
    }
}

/* MOBILE OPTIMIZATION */

/* Fix horizontal scrolling */
body, html {
    overflow-x: hidden;
    max-width: 100vw;
}

.main-content {
    overflow-x: hidden;
    max-width: 100vw;
}

/* Chat messages - prevent horizontal scroll */
.chat-messages {
    overflow-x: hidden;
    width: 100%;
    max-width: 100%;
}

.message-bubble {
    max-width: 100%;
    overflow-x: auto;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

.code-example, .code-fill {
    overflow-x: auto;
    max-width: 100%;
    -webkit-overflow-scrolling: touch;
}

/* Fix bar charts on mobile */
@media (max-width: 768px) {
    .bar-chart {
        height: 250px;
        padding: 20px 10px 60px 60px;
        gap: 15px;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
    }
    
    .chart-y-labels {
        left: 5px;
        font-size: 0.75em;
    }
    
    .bar-item {
        flex: 0 0 80px;
        min-width: 80px;
        height: 180px;
    }
    
    .bar-label {
        font-size: 0.75em;
        bottom: -40px;
    }
    
    .bar-value {
        font-size: 0.85em;
        top: -30px;
    }
    
    /* Make charts scrollable horizontally on mobile */
    .chart-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    /* Lesson view on mobile */
    .lesson-header-bar {
        padding: 15px 10px;
        flex-direction: column;
        align-items: flex-start;
    }
    
    .lesson-progress-info {
        width: 100%;
        margin-top: 10px;
    }
    
    .tab-switcher {
        width: 100%;
        justify-content: center;
    }
    
    /* Chat container spacing */
    .chat-container {
        padding: 20px 10px;
    }
    
    .message {
        max-width: 100%;
    }
    
    /* Exercise boxes on mobile */
    .exercise-box {
        padding: 15px;
    }
    
    .code-fill, .code-example {
        font-size: 0.85em;
        padding: 15px;
    }
    
    /* MCQ options on mobile */
    .mcq-option {
        padding: 12px 15px;
        font-size: 0.9em;
    }
    
    /* Input blanks on mobile */
    .code-blank {
        min-width: 60px;
        font-size: 0.9em;
    }
    
    /* AI Modal on mobile */
    .ai-explanation-content {
        width: 95%;
        max-height: 85vh;
        padding: 25px 15px;
    }
    
    .ai-keyword-display {
        font-size: 1.5em;
    }
    
    .wave-container {
        width: 250px;
    }
}

@media (max-width: 480px) {
    .dashboard-title {
        font-size: 2em;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .bar-chart {
        height: 220px;
        padding: 15px 5px 50px 50px;
    }
    
    .bar-item {
        flex: 0 0 70px;
        min-width: 70px;
    }
}

/* Improved bar chart for mobile */
.bar-chart {
    display: flex;
    align-items: flex-end;
    gap: 20px;
    height: 320px;
    padding: 20px 20px 60px 80px;
    justify-content: center;
    position: relative;
    background: 
        linear-gradient(90deg, rgba(100, 255, 218, 0.03) 1px, transparent 1px),
        linear-gradient(0deg, rgba(100, 255, 218, 0.03) 1px, transparent 1px);
    background-size: 50px 35px;
}

.chart-y-labels {
    position: absolute;
    left: 10px;
    top: 20px;
    bottom: 60px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    color: #64ffda;
    font-size: 0.85em;
    font-weight: 600;
    z-index: 10;
}

body.light-mode .chart-y-labels {
    color: #0a7a5e;
}

.chart-y-labels span {
    background: rgba(10, 10, 10, 0.8);
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px solid rgba(100, 255, 218, 0.3);
}

body.light-mode .chart-y-labels span {
    background: rgba(245, 245, 245, 0.9);
    border-color: rgba(10, 122, 94, 0.3);
}

.bar-item {
    flex: 0 1 100px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    position: relative;
    height: 240px;
    justify-content: flex-end;
}

.bar {
    width: 100%;
    background: linear-gradient(180deg, #64ffda 0%, #00d4ff 100%);
    border-radius: 12px 12px 0 0;
    transition: height 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
    box-shadow: 
        0 -5px 30px rgba(100, 255, 218, 0.3),
        inset 0 -2px 10px rgba(255, 255, 255, 0.3);
    min-height: 0px;
    max-height: 100%;
    border: 2px solid rgba(100, 255, 218, 0.4);
    border-bottom: none;
}

.bar-value {
    position: absolute;
    top: -35px;
    left: 50%;
    transform: translateX(-50%);
    color: #64ffda;
    font-weight: 700;
    font-size: 0.95em;
    white-space: nowrap;
    background: rgba(10, 10, 10, 0.9);
    padding: 6px 12px;
    border-radius: 8px;
    border: 1px solid rgba(100, 255, 218, 0.3);
    box-shadow: 0 4px 15px rgba(100, 255, 218, 0.2);
}

body.light-mode .bar-value {
    color: #0a7a5e;
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(10, 122, 94, 0.3);
}

.bar-label {
    color: #8b949e;
    font-size: 0.85em;
    text-align: center;
    word-break: break-word;
    max-width: 100%;
    position: absolute;
    bottom: -45px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    line-height: 1.2;
}

/* OPTIMIZED MOBILE PROGRESS BARS */
@media (max-width: 768px) {
    .bar-chart {
        height: 260px;
        padding: 15px 5px 50px 50px;
        gap: 10px;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
        justify-content: flex-start;
        scroll-padding-left: 50px;
    }
    
    .bar-chart::-webkit-scrollbar {
        height: 6px;
    }
    
    .bar-chart::-webkit-scrollbar-track {
        background: rgba(100, 255, 218, 0.1);
        border-radius: 10px;
        margin: 0 50px 0 10px;
    }
    
    .bar-chart::-webkit-scrollbar-thumb {
        background: rgba(100, 255, 218, 0.4);
        border-radius: 10px;
    }
    
    .bar-chart::before {
        left: 48px;
        bottom: 45px;
        height: calc(100% - 60px);
    }
    
    .bar-chart::after {
        left: 48px;
        bottom: 45px;
        width: calc(100% - 55px);
    }
    
    .chart-y-labels {
        left: 5px;
        font-size: 0.65em;
        bottom: 50px;
    }
    
    .chart-y-labels span {
        padding: 2px 4px;
        font-size: 0.9em;
    }
    
    .bar-item {
        flex: 0 0 65px;
        min-width: 65px;
        height: 180px;
    }
    
    .bar {
        border-radius: 8px 8px 0 0;
    }
    
    .bar-value {
        font-size: 0.75em;
        top: -28px;
        padding: 4px 8px;
    }
    
    .bar-label {
        font-size: 0.68em;
        bottom: -38px;
        max-width: 65px;
        line-height: 1.1;
    }
}

@media (max-width: 480px) {
    .bar-chart {
        height: 240px;
        padding: 12px 5px 45px 45px;
        gap: 8px;
    }
    
    .bar-item {
        flex: 0 0 58px;
        min-width: 58px;
        height: 165px;
    }
    
    .bar-value {
        font-size: 0.7em;
        top: -26px;
        padding: 3px 6px;
    }
    
    .bar-label {
        font-size: 0.65em;
        bottom: -36px;
        max-width: 58px;
    }
}

/* Smooth reveal with leading glow trail */
.word-reveal-container {
    position: relative;
    display: inline;
}

.word-glow-trail {
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    height: 120%;
    background: linear-gradient(90deg,
        rgba(100, 255, 218, 0.6),
        rgba(100, 255, 218, 0.4),
        rgba(100, 255, 218, 0.2),
        transparent
    );
    filter: blur(8px);
    pointer-events: none;
    z-index: 1;
    animation: glowSweep 0.8s ease-out forwards;
}

body.light-mode .word-glow-trail {
    background: linear-gradient(90deg,
        rgba(10, 122, 94, 0.5),
        rgba(10, 122, 94, 0.3),
        rgba(10, 122, 94, 0.15),
        transparent
    );
}

@keyframes glowSweep {
    0% {
        width: 0;
        opacity: 0;
    }
    20% {
        opacity: 1;
    }
    100% {
        width: 150%;
        opacity: 0;
    }
}

.word-reveal-text {
    position: relative;
    display: inline;
    opacity: 0;
    z-index: 2;
    animation: fadeInWord 0.6s ease-out forwards;
    animation-delay: 0.15s;
}

@keyframes fadeInWord {
    0% {
        opacity: 0;
        filter: blur(4px);
    }
    100% {
        opacity: 1;
        filter: blur(0);
    }
}

/* Enhanced Code Editor Interface */
.practice-workspace {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    height: calc(100vh - 250px);
    min-height: 500px;
}

.code-panel, .output-panel {
    background: rgba(30, 30, 30, 0.8);
    border: 2px solid rgba(100, 255, 218, 0.2);
    border-radius: 15px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

body.light-mode .code-panel,
body.light-mode .output-panel {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(10, 122, 94, 0.3);
}

.panel-header {
    background: rgba(20, 20, 20, 0.95);
    padding: 15px 25px;
    border-bottom: 2px solid rgba(100, 255, 218, 0.2);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

body.light-mode .panel-header {
    background: rgba(240, 240, 240, 0.95);
    border-bottom-color: rgba(10, 122, 94, 0.2);
}

.panel-title {
    color: #64ffda;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1.1em;
}

body.light-mode .panel-title {
    color: #0a7a5e;
}

.run-button {
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.2), rgba(0, 212, 255, 0.2));
    border: 2px solid #64ffda;
    color: #64ffda;
    padding: 10px 28px;
    border-radius: 50px;
    cursor: pointer;
    font-weight: 700;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 1em;
    box-shadow: 0 4px 15px rgba(100, 255, 218, 0.2);
}

.run-button:hover {
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.3), rgba(0, 212, 255, 0.3));
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(100, 255, 218, 0.3);
}

.run-button:active {
    transform: translateY(0);
}

body.light-mode .run-button {
    background: linear-gradient(135deg, rgba(10, 122, 94, 0.2), rgba(0, 168, 150, 0.2));
    border-color: #0a7a5e;
    color: #0a7a5e;
}

.code-editor-area {
    flex: 1;
    padding: 0;
    overflow: hidden;
    position: relative;
}

.code-editor-area textarea {
    width: 100%;
    height: 100%;
    background: #0d1117;
    color: #e6edf3;
    border: none;
    padding: 25px;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 15px;
    line-height: 1.8;
    resize: none;
    outline: none;
    tab-size: 4;
}

body.light-mode .code-editor-area textarea {
    background: #ffffff;
    color: #24292f;
}

.output-content {
    flex: 1;
    padding: 0;
    overflow: hidden;
    background: #ffffff;
}

.output-frame {
    width: 100%;
    height: 100%;
    border: none;
    background: white;
}

/* Mobile responsive */
@media (max-width: 768px) {
    .practice-workspace {
        grid-template-columns: 1fr;
        height: auto;
        gap: 15px;
    }
    
    .code-panel, .output-panel {
        min-height: 350px;
    }
    
    .panel-header {
        padding: 12px 15px;
    }
    
    .run-button {
        padding: 8px 20px;
        font-size: 0.9em;
    }
}

#languageDetector {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 8px 16px;
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.2);
    border-radius: 20px;
    font-size: 0.85em;
}

body.light-mode #languageDetector {
    background: rgba(10, 122, 94, 0.05);
    border-color: rgba(10, 122, 94, 0.2);
}

#detectedLang {
    font-weight: 700;
    transition: color 0.3s ease;
}

@media (max-width: 768px) {
    #languageDetector {
        font-size: 0.75em;
        padding: 6px 12px;
    }
}

.forgot-link {
    text-align: center;
    margin-top: 15px;
    color: #8b949e;
    font-size: 0.9em;
}

.forgot-link a {
    color: #64ffda;
    text-decoration: none;
    cursor: pointer;
    font-weight: 600;
    transition: color 0.3s ease;
}

.forgot-link a:hover {
    color: #00d4ff;
}

body.light-mode .forgot-link a {
    color: #0a7a5e;
}

.verification-input {
    width: 100%;
    padding: 15px 20px;
    background: rgba(100, 255, 218, 0.05);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 15px;
    color: #64ffda;
    font-size: 1.2em;
    text-align: center;
    letter-spacing: 8px;
    font-weight: 700;
    font-family: 'Courier New', monospace;
}

body.light-mode .verification-input {
    background: rgba(10, 122, 94, 0.05);
    color: #0a7a5e;
}

.auth-container .auth-form {
    display: none;
}

.auth-container .auth-form.active {
    display: block !important;
    animation: fadeIn 0.3s ease;
}

.otp-container {
    display: flex;
    gap: 8px;
    justify-content: center;
    margin: 20px 0;
    flex-wrap: nowrap; /* Prevent wrapping */
}

.otp-input {
    width: 45px;
    height: 50px;
    text-align: center;
    font-size: 20px;
    font-weight: 700;
    font-family: 'Courier New', monospace;
    background: rgba(100, 255, 218, 0.05);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 10px;
    color: #64ffda;
    outline: none;
    transition: all 0.3s ease;
}

.otp-input:focus {
    border-color: #64ffda;
    background: rgba(100, 255, 218, 0.15);
    transform: scale(1.08);
    box-shadow: 0 0 20px rgba(100, 255, 218, 0.4);
}

body.light-mode .otp-input {
    background: rgba(10, 122, 94, 0.05);
    border-color: rgba(10, 122, 94, 0.3);
    color: #0a7a5e;
}

body.light-mode .otp-input:focus {
    border-color: #0a7a5e;
    background: rgba(10, 122, 94, 0.15);
    box-shadow: 0 0 20px rgba(10, 122, 94, 0.4);
}

@media (max-width: 480px) {
    .otp-input {
        width: 38px;
        height: 42px;
        font-size: 18px;
    }
    
    .otp-container {
        gap: 6px;
    }
}

.lesson-view {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: #0a0a0a;
    z-index: 2000;
    /* FIX: Prevent background issues */
    overflow: hidden;
}

body.light-mode .lesson-view {
    background: #f5f5f5;
}

/* FIX: Ensure lesson content scrolls properly */
.lesson-content {
    flex: 1;
    overflow-y: auto;
    padding: 30px;
    background: #0a0a0a;
    -webkit-overflow-scrolling: touch;
}

body.light-mode .lesson-content {
    background: #f5f5f5;
}

/* STREAK BROKEN MODAL */
.streak-broken-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 5000;
    opacity: 0;
    transition: all 0.3s ease;
    pointer-events: none;
}

.streak-broken-modal.active {
    background: rgba(0, 0, 0, 0.8);
    opacity: 1;
    pointer-events: all;
}

.streak-broken-content {
    background: rgba(30, 30, 30, 0.98);
    border: 2px solid rgba(255, 100, 100, 0.3);
    border-radius: 20px;
    padding: 40px;
    text-align: center;
    max-width: 400px;
    transform: scale(0.8);
    transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.streak-broken-modal.active .streak-broken-content {
    transform: scale(1);
}

body.light-mode .streak-broken-content {
    background: rgba(255, 255, 255, 0.98);
}

.streak-broken-icon {
    font-size: 4em;
    margin-bottom: 20px;
}

.streak-broken-title {
    color: #ff6b6b;
    font-size: 2em;
    margin-bottom: 15px;
}

.streak-broken-text {
    color: #8b949e;
    font-size: 1.1em;
    margin-bottom: 10px;
}

.streak-broken-encourage {
    color: #64ffda;
    font-size: 1em;
    margin-bottom: 25px;
}

body.light-mode .streak-broken-encourage {
    color: #0a7a5e;
}

.close-broken-btn {
    background: rgba(100, 255, 218, 0.2);
    border: 2px solid #64ffda;
    color: #64ffda;
    padding: 12px 30px;
    border-radius: 50px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
}

.close-broken-btn:hover {
    background: rgba(100, 255, 218, 0.3);
    transform: translateY(-2px);
}

/* INLINE AI POPUP */
.inline-ai-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0);
    backdrop-filter: blur(0px);
    z-index: 6000;
    transition: all 0.3s ease;
}

.inline-ai-overlay.active {
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
}

.inline-ai-popup {
    position: fixed;
    background: rgba(30, 30, 30, 0.98);
    border: 2px solid rgba(100, 255, 218, 0.4);
    border-radius: 15px;
    padding: 20px;
    max-width: 400px;
    min-width: 300px;
    z-index: 6001;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
}

body.light-mode .inline-ai-popup {
    background: rgba(255, 255, 255, 0.98);
    border-color: rgba(10, 122, 94, 0.4);
}

.inline-ai-arrow {
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid rgba(100, 255, 218, 0.4);
}

body.light-mode .inline-ai-arrow {
    border-top-color: rgba(10, 122, 94, 0.4);
}

.inline-ai-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(100, 255, 218, 0.2);
}

.inline-ai-keyword {
    color: #64ffda;
    font-size: 1.3em;
    font-weight: 700;
}

body.light-mode .inline-ai-keyword {
    color: #0a7a5e;
}

.inline-ai-close {
    background: rgba(255, 100, 100, 0.2);
    border: 1px solid rgba(255, 100, 100, 0.3);
    color: #ff6b6b;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    font-size: 1.5em;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    line-height: 1;
}

.inline-ai-close:hover {
    background: rgba(255, 100, 100, 0.3);
    transform: rotate(90deg);
}

.inline-ai-content {
    color: #e0e0e0;
    line-height: 1.7;
    font-size: 0.95em;
}

body.light-mode .inline-ai-content {
    color: #1a1a1a;
}

.inline-ai-loading {
    padding: 20px 0;
}

.inline-ai-text {
    animation: fadeIn 0.4s ease;
}

.inline-ai-text p {
    margin-bottom: 10px;
}

@keyframes fadeInWord {
    from {
        opacity: 0;
        transform: translateY(5px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ENHANCED MOBILE AI POPUP */
@media (max-width: 768px) {
    .inline-ai-popup {
        position: fixed !important;
        left: 50% !important;
        top: 50% !important;
        transform: translate(-50%, -50%) scale(0.9) !important;
        width: 90vw !important;
        max-width: 90vw !important;
        max-height: 70vh;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    .inline-ai-popup.active {
        transform: translate(-50%, -50%) scale(1) !important;
    }
    
    .inline-ai-arrow {
        display: none !important;
    }
    
    .inline-ai-header {
        padding: 15px;
    }
    
    .inline-ai-keyword {
        font-size: 1.3em;
    }
    
    .inline-ai-close {
        width: 32px;
        height: 32px;
        font-size: 1.6em;
    }
    
    .inline-ai-content {
        padding: 0 15px 15px 15px;
    }
    
    .inline-ai-text {
        font-size: 0.95em;
        line-height: 1.7;
    }
    
    /* Better wave loading on mobile */
    .wave-container {
        width: 200px;
    }
    
    .wave-line {
        height: 6px;
    }
}

/* WORD REVEAL ANIMATIONS FOR AI POPUP */
@keyframes glowSweepInline {
    0% {
        width: 0;
        opacity: 0;
    }
    20% {
        opacity: 1;
    }
    100% {
        width: 150%;
        opacity: 0;
    }
}

@keyframes fadeInWordInline {
    0% {
        opacity: 0;
        filter: blur(6px);
        transform: translateY(5px);
    }
    50% {
        opacity: 0.5;
        filter: blur(3px);
    }
    100% {
        opacity: 1;
        filter: blur(0);
        transform: translateY(0);
    }
}

/* ENHANCED GENERATIVE AI WORD REVEAL */
.word-reveal-container {
    position: relative;
    display: inline-block;
    margin: 0 1px;
}

.word-glow-outer,
.word-glow-inner,
.word-glow-core {
    position: absolute;
    left: -15%;
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    height: 160%;
    pointer-events: none;
    border-radius: 50%;
}

/* Outer glow - soft and wide */
.word-glow-outer {
    background: radial-gradient(ellipse at left, 
        rgba(100, 255, 218, 0.4), 
        rgba(100, 255, 218, 0.2), 
        rgba(0, 212, 255, 0.15),
        transparent 75%);
    filter: blur(20px);
    animation: glowSweepOuter 1s ease-out forwards;
    z-index: 1;
}

/* Inner glow - medium intensity */
.word-glow-inner {
    background: radial-gradient(ellipse at left, 
        rgba(100, 255, 218, 0.7), 
        rgba(100, 255, 218, 0.4), 
        rgba(0, 212, 255, 0.25),
        transparent 65%);
    filter: blur(12px);
    animation: glowSweepInner 0.85s ease-out forwards;
    animation-delay: 0.05s;
    z-index: 2;
}

/* Core glow - sharp and bright */
.word-glow-core {
    background: linear-gradient(90deg, 
        rgba(255, 255, 255, 0.9),
        rgba(100, 255, 218, 0.9), 
        rgba(100, 255, 218, 0.6), 
        rgba(0, 212, 255, 0.4),
        transparent);
    filter: blur(6px);
    animation: glowSweepCore 0.7s ease-out forwards;
    animation-delay: 0.1s;
    z-index: 3;
}

.word-reveal-text-inline {
    position: relative;
    display: inline;
    z-index: 4;
    opacity: 0;
    filter: blur(8px);
    animation: fadeInWordGenAI 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    animation-delay: 0.15s;
}

/* Enhanced Animations */
@keyframes glowSweepOuter {
    0% {
        width: 0;
        opacity: 0;
    }
    20% {
        opacity: 1;
    }
    40% {
        opacity: 0.8;
    }
    100% {
        width: 200%;
        opacity: 0;
    }
}

@keyframes glowSweepInner {
    0% {
        width: 0;
        opacity: 0;
    }
    30% {
        opacity: 1;
    }
    50% {
        opacity: 0.9;
    }
    100% {
        width: 180%;
        opacity: 0;
    }
}

@keyframes glowSweepCore {
    0% {
        width: 0;
        opacity: 0;
    }
    40% {
        opacity: 1;
    }
    60% {
        opacity: 0.8;
    }
    100% {
        width: 160%;
        opacity: 0;
    }
}

@keyframes fadeInWordGenAI {
    0% {
        opacity: 0;
        filter: blur(10px) brightness(0.5);
        transform: translateY(10px) scale(0.9);
        text-shadow: 0 0 0 transparent;
    }
    30% {
        opacity: 0.3;
        filter: blur(6px) brightness(1.2);
        text-shadow: 0 0 15px rgba(100, 255, 218, 0.8);
    }
    60% {
        opacity: 0.7;
        filter: blur(3px) brightness(1.3);
        text-shadow: 0 0 20px rgba(100, 255, 218, 1);
    }
    80% {
        filter: blur(1px) brightness(1.1);
        text-shadow: 0 0 10px rgba(100, 255, 218, 0.6);
    }
    100% {
        opacity: 1;
        filter: blur(0) brightness(1);
        transform: translateY(0) scale(1);
        text-shadow: 0 0 5px rgba(100, 255, 218, 0.3);
    }
}

/* Light mode adjustments */
body.light-mode .word-glow-outer {
    background: radial-gradient(ellipse at left, 
        rgba(10, 122, 94, 0.4), 
        rgba(10, 122, 94, 0.2), 
        rgba(0, 168, 150, 0.15),
        transparent 75%);
}

body.light-mode .word-glow-inner {
    background: radial-gradient(ellipse at left, 
        rgba(10, 122, 94, 0.7), 
        rgba(10, 122, 94, 0.4), 
        rgba(0, 168, 150, 0.25),
        transparent 65%);
}

body.light-mode .word-glow-core {
    background: linear-gradient(90deg, 
        rgba(255, 255, 255, 0.9),
        rgba(10, 122, 94, 0.9), 
        rgba(10, 122, 94, 0.6), 
        rgba(0, 168, 150, 0.4),
        transparent);
}

body.light-mode .word-reveal-text-inline {
    animation: fadeInWordGenAILight 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    animation-delay: 0.15s;
}

@keyframes fadeInWordGenAILight {
    0% {
        opacity: 0;
        filter: blur(10px) brightness(1.5);
        transform: translateY(10px) scale(0.9);
        text-shadow: 0 0 0 transparent;
    }
    30% {
        opacity: 0.3;
        filter: blur(6px) brightness(1.2);
        text-shadow: 0 0 15px rgba(10, 122, 94, 0.8);
    }
    60% {
        opacity: 0.7;
        filter: blur(3px) brightness(1.1);
        text-shadow: 0 0 20px rgba(10, 122, 94, 1);
    }
    80% {
        filter: blur(1px) brightness(1);
        text-shadow: 0 0 10px rgba(10, 122, 94, 0.6);
    }
    100% {
        opacity: 1;
        filter: blur(0) brightness(1);
        transform: translateY(0) scale(1);
        text-shadow: 0 0 5px rgba(10, 122, 94, 0.3);
    }
}
/* Light mode adjustments */
body.light-mode .word-glow-outer {
    background: radial-gradient(ellipse at left, 
        rgba(10, 122, 94, 0.3), 
        rgba(10, 122, 94, 0.15), 
        transparent 70%);
}

body.light-mode .word-glow-inner {
    background: radial-gradient(ellipse at left, 
        rgba(10, 122, 94, 0.5), 
        rgba(10, 122, 94, 0.25), 
        transparent 60%);
}

body.light-mode .word-glow-core {
    background: linear-gradient(90deg, 
        rgba(10, 122, 94, 0.8), 
        rgba(10, 122, 94, 0.4), 
        transparent);
}

/* Enhanced typing indicator animation */
.typing-indicator {
    display: flex;
    gap: 6px;
    padding: 15px 20px;
}

.typing-dot {
    width: 10px;
    height: 10px;
    background: #64ffda;
    border-radius: 50%;
    animation: typingBounce 1.4s infinite;
    box-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
}

body.light-mode .typing-dot {
    background: #0a7a5e;
    box-shadow: 0 0 10px rgba(10, 122, 94, 0.5);
}

.typing-dot:nth-child(1) {
    animation-delay: 0s;
}

.typing-dot:nth-child(2) {
    animation-delay: 0.2s;
}

.typing-dot:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes typingBounce {
    0%, 60%, 100% {
        transform: translateY(0);
        opacity: 0.5;
    }
    30% {
        transform: translateY(-12px);
        opacity: 1;
        box-shadow: 0 0 20px rgba(100, 255, 218, 0.8);
    }
}

/* Smooth message appearance */
.message {
    transition: all 0.4s ease;
}

.message-bubble {
    overflow: visible;
}

/* Make sure chat messages container is smooth */
.chat-messages {
    scroll-behavior: smooth;
}

/* POPUP POSITIONING CLASSES */
.popup-above .inline-ai-arrow {
    bottom: -10px;
    top: auto;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid rgba(100, 255, 218, 0.4);
    border-bottom: none;
}

.popup-below .inline-ai-arrow {
    top: -10px;
    bottom: auto;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-bottom: 10px solid rgba(100, 255, 218, 0.4);
    border-top: none;
}

body.light-mode .popup-above .inline-ai-arrow {
    border-top-color: rgba(10, 122, 94, 0.4);
}

body.light-mode .popup-below .inline-ai-arrow {
    border-bottom-color: rgba(10, 122, 94, 0.4);
}

/* ENHANCED PROFESSIONAL AI WORD REVEAL */
.word-reveal-container {
    position: relative;
    display: inline-block;
    margin: 0 1px;
}

.word-glow-outer,
.word-glow-inner,
.word-glow-core {
    position: absolute;
    left: -10%;
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    height: 140%;
    pointer-events: none;
    border-radius: 50%;
}

/* Outer glow - soft and wide */
.word-glow-outer {
    background: radial-gradient(ellipse at left, 
        rgba(100, 255, 218, 0.3), 
        rgba(100, 255, 218, 0.15), 
        transparent 70%);
    filter: blur(15px);
    animation: glowSweepOuter 0.8s ease-out forwards;
    z-index: 1;
}

/* Inner glow - medium intensity */
.word-glow-inner {
    background: radial-gradient(ellipse at left, 
        rgba(100, 255, 218, 0.5), 
        rgba(100, 255, 218, 0.25), 
        transparent 60%);
    filter: blur(10px);
    animation: glowSweepInner 0.7s ease-out forwards;
    animation-delay: 0.05s;
    z-index: 2;
}

/* Core glow - sharp and bright */
.word-glow-core {
    background: linear-gradient(90deg, 
        rgba(100, 255, 218, 0.8), 
        rgba(100, 255, 218, 0.4), 
        transparent);
    filter: blur(5px);
    animation: glowSweepCore 0.6s ease-out forwards;
    animation-delay: 0.1s;
    z-index: 3;
}

.word-reveal-text-inline {
    position: relative;
    display: inline;
    z-index: 4;
    opacity: 0;
    filter: blur(5px);
    animation: fadeInWordSmooth 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    animation-delay: 0.2s;
}

/* Animations */
@keyframes glowSweepOuter {
    0% {
        width: 0;
        opacity: 0;
    }
    30% {
        opacity: 1;
    }
    100% {
        width: 180%;
        opacity: 0;
    }
}

@keyframes glowSweepInner {
    0% {
        width: 0;
        opacity: 0;
    }
    40% {
        opacity: 1;
    }
    100% {
        width: 160%;
        opacity: 0;
    }
}

@keyframes glowSweepCore {
    0% {
        width: 0;
        opacity: 0;
    }
    50% {
        opacity: 1;
    }
    100% {
        width: 140%;
        opacity: 0;
    }
}

@keyframes fadeInWordSmooth {
    0% {
        opacity: 0;
        filter: blur(8px);
        transform: translateY(8px) scale(0.95);
    }
    60% {
        opacity: 0.8;
        filter: blur(2px);
    }
    100% {
        opacity: 1;
        filter: blur(0);
        transform: translateY(0) scale(1);
    }
}

/* Light mode adjustments */
body.light-mode .word-glow-outer {
    background: radial-gradient(ellipse at left, 
        rgba(10, 122, 94, 0.3), 
        rgba(10, 122, 94, 0.15), 
        transparent 70%);
}

body.light-mode .word-glow-inner {
    background: radial-gradient(ellipse at left, 
        rgba(10, 122, 94, 0.5), 
        rgba(10, 122, 94, 0.25), 
        transparent 60%);
}

body.light-mode .word-glow-core {
    background: linear-gradient(90deg, 
        rgba(10, 122, 94, 0.8), 
        rgba(10, 122, 94, 0.4), 
        transparent);
}

/* MOBILE LEARN SECTION - NO HORIZONTAL MOVEMENT */
@media (max-width: 768px) {
    .lesson-content {
        overflow-x: hidden !important;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        width: 100%;
        max-width: 100vw;
    }
    
    .chat-container {
        overflow-x: hidden !important;
        width: 100%;
        max-width: 100%;
    }
    
    .chat-messages {
        overflow-x: hidden !important;
        width: 100%;
        max-width: 100%;
    }
    
    .message {
        max-width: 100%;
        overflow-x: hidden;
    }
    
    .message-bubble {
        max-width: 100%;
        overflow-x: auto;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    
    .code-example,
    .code-fill {
        overflow-x: auto;
        max-width: 100%;
        -webkit-overflow-scrolling: touch;
    }
}

/* MOBILE SWIPEABLE PROGRESS CAROUSEL */
.mobile-progress-carousel {
    display: none;
    width: 100%;
    overflow: hidden;
    padding: 20px 0;
}

@media (max-width: 768px) {
    .mobile-progress-carousel {
        display: block;
    }
}

.carousel-container {
    overflow: hidden;
    border-radius: 20px;
    background: rgba(30, 30, 30, 0.4);
    border: 1px solid rgba(100, 255, 218, 0.1);
    padding: 25px 20px;
}

body.light-mode .carousel-container {
    background: rgba(255, 255, 255, 0.6);
    border-color: rgba(10, 122, 94, 0.2);
}

.carousel-track {
    display: flex;
    transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    touch-action: pan-y;
}

.carousel-slide {
    min-width: 100%;
    padding: 10px;
}

.carousel-title {
    color: #64ffda;
    font-size: 1.8em;
    text-align: center;
    margin-bottom: 25px;
    text-shadow: 0 0 20px rgba(100, 255, 218, 0.3);
}

body.light-mode .carousel-title {
    color: #0a7a5e;
}

.mobile-course-bar {
    margin-bottom: 20px;
}

.mobile-course-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.mobile-course-name {
    color: #e0e0e0;
    font-weight: 600;
    font-size: 0.95em;
}

body.light-mode .mobile-course-name {
    color: #1a1a1a;
}

.mobile-course-percent {
    color: #64ffda;
    font-weight: 700;
    font-size: 0.95em;
}

body.light-mode .mobile-course-percent {
    color: #0a7a5e;
}

.mobile-progress-bar {
    height: 12px;
    background: rgba(100, 255, 218, 0.1);
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid rgba(100, 255, 218, 0.2);
}

.mobile-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #64ffda, #00d4ff);
    border-radius: 10px;
    transition: width 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
}

body.light-mode .mobile-progress-fill {
    background: linear-gradient(90deg, #0a7a5e, #00a896);
}

.carousel-dots {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 20px;
}

.carousel-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(100, 255, 218, 0.3);
    cursor: pointer;
    transition: all 0.3s ease;
}

.carousel-dot.active {
    background: #64ffda;
    width: 30px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
}

body.light-mode .carousel-dot {
    background: rgba(10, 122, 94, 0.3);
}

body.light-mode .carousel-dot.active {
    background: #0a7a5e;
}

/* Custom Logout Modal */
.custom-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(5px);
    z-index: 99999;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease;
}

.custom-modal.active {
    display: flex;
}

.custom-modal-content {
    background: #1a1f35;
    border: 2px solid #64ffda;
    border-radius: 20px;
    padding: 40px;
    max-width: 400px;
    text-align: center;
    animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 20px 60px rgba(100, 255, 218, 0.3);
}

.custom-modal-icon {
    font-size: 60px;
    margin-bottom: 20px;
    animation: wave 0.6s ease;
}

@keyframes wave {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(-10deg); }
    75% { transform: rotate(10deg); }
}

.custom-modal-title {
    font-size: 24px;
    color: #64ffda;
    margin-bottom: 10px;
    font-weight: 600;
}

.custom-modal-text {
    color: #8b949e;
    font-size: 16px;
    margin-bottom: 30px;
}

.custom-modal-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
}

.custom-modal-btn {
    padding: 12px 30px;
    border-radius: 10px;
    border: none;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    flex: 1;
}

.cancel-btn {
    background: transparent;
    color: #8b949e;
    border: 2px solid #8b949e;
}

.cancel-btn:hover {
    background: #8b949e;
    color: #0d1117;
    transform: translateY(-2px);
}

.confirm-btn {
    background: #ff6b6b;
    color: white;
    border: 2px solid #ff6b6b;
}

.confirm-btn:hover {
    background: #ff5252;
    border-color: #ff5252;
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);
}

@keyframes slideUp {
    from {
        transform: translateY(50px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* ==================== ENHANCED LEARNING INTERFACE ==================== */

/* Learning Container with Preview */
.lesson-container {
    display: flex;
    gap: 20px;
    margin-top: 20px;
}

.lesson-main {
    flex: 1;
}

.preview-panel {
    width: 350px;
    background: rgba(255, 255, 255, 0.03);
    border: 2px solid #64ffda;
    border-radius: 15px;
    padding: 20px;
    position: sticky;
    top: 20px;
    max-height: calc(100vh - 40px);
    overflow-y: auto;
}

.preview-panel h3 {
    color: #64ffda;
    font-size: 18px;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.preview-content {
    background: #0d1117;
    border: 1px solid #30363d;
    border-radius: 10px;
    padding: 15px;
    min-height: 200px;
}

.preview-iframe {
    width: 100%;
    height: 300px;
    border: none;
    border-radius: 8px;
    background: white;
}

/* Enhanced Chat Messages */
.chat-message {
    margin-bottom: 20px;
    animation: messageSlide 0.4s ease;
}

@keyframes messageSlide {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.bot-message .message-content {
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.1), rgba(100, 255, 218, 0.05));
    border: 1px solid rgba(100, 255, 218, 0.3);
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(100, 255, 218, 0.1);
}

/* Enhanced Code Examples */
.code-example {
    margin: 15px 0;
    position: relative;
    border-radius: 10px;
    overflow: hidden;
    background: #0d1117;
    border: 1px solid #30363d;
}

.code-example::before {
    content: 'Code Example';
    display: block;
    background: #161b22;
    padding: 8px 15px;
    font-size: 12px;
    color: #8b949e;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.code-example code {
    display: block;
    padding: 20px;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.6;
    color: #c9d1d9;
    overflow-x: auto;
}

/* Try It Button */
.try-it-btn {
    background: linear-gradient(135deg, #64ffda, #00d9ff);
    color: #0d1117;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    margin-top: 10px;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.try-it-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(100, 255, 218, 0.4);
}

/* Interactive Demo Container */
.demo-container {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
    border: 2px solid #64ffda;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .lesson-container {
        flex-direction: column;
    }
    
    .preview-panel {
        width: 100%;
        position: relative;
        top: 0;
        max-height: none;
    }
}

/* ==================== LIGHT MODE FIXES ==================== */

body.light-mode {
    background: #ffffff;
    color: #1a1f35;
}

body.light-mode .dashboard,
body.light-mode .lesson-view,
body.light-mode .language-selector,
body.light-mode .settings-menu,
body.light-mode .profile-card {
    background: #f8f9fa;
    color: #1a1f35;
}

body.light-mode h1,
body.light-mode h2,
body.light-mode h3,
body.light-mode h4,
body.light-mode p,
body.light-mode span,
body.light-mode .stat-label,
body.light-mode .course-desc,
body.light-mode .lesson-title {
    color: #1a1f35 !important;
}

body.light-mode .bot-message .message-content {
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.15), rgba(100, 255, 218, 0.08));
    border: 1px solid rgba(0, 150, 136, 0.3);
    color: #1a1f35;
}

body.light-mode .code-example {
    background: #f6f8fa;
    border: 1px solid #d0d7de;
}

body.light-mode .code-example::before {
    background: #e8ecef;
    color: #57606a;
}

body.light-mode .code-example code {
    color: #24292f;
}

body.light-mode .keyword-highlight {
    color: #0969da !important;
    background: rgba(9, 105, 218, 0.1);
}

body.light-mode .preview-panel {
    background: rgba(0, 0, 0, 0.03);
    border: 2px solid #00968a;
}

body.light-mode .preview-content {
    background: #ffffff;
    border: 1px solid #d0d7de;
}

body.light-mode .course-card,
body.light-mode .language-card {
    background: white;
    color: #1a1f35;
    border: 1px solid #d0d7de;
}

body.light-mode .sidebar {
    background: #f8f9fa;
    border-right: 1px solid #d0d7de;
}

body.light-mode .nav-item {
    color: #1a1f35;
}

body.light-mode .nav-item:hover {
    background: rgba(0, 150, 136, 0.1);
}

/* ==================== NOTIFICATION TOAST ==================== */
.notification-toast {
    position: fixed;
    top: 20px;
    right: 20px;
    background: #1a1f35;
    color: white;
    padding: 16px 24px;
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
    gap: 12px;
    z-index: 100000;
    transform: translateX(400px);
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    border: 2px solid #64ffda;
    max-width: 400px;
    font-size: 15px;
    font-weight: 500;
}

.notification-toast.show {
    transform: translateX(0);
    opacity: 1;
}

.notification-icon {
    font-size: 24px;
    flex-shrink: 0;
}

.notification-message {
    flex: 1;
    line-height: 1.4;
}

.notification-success {
    border-color: #64ffda;
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.1), rgba(100, 255, 218, 0.05));
}

.notification-error {
    border-color: #ff6b6b;
    background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05));
}

.notification-warning {
    border-color: #ffa500;
    background: linear-gradient(135deg, rgba(255, 165, 0, 0.1), rgba(255, 165, 0, 0.05));
}

.notification-info {
    border-color: #64b5f6;
    background: linear-gradient(135deg, rgba(100, 181, 246, 0.1), rgba(100, 181, 246, 0.05));
}

/* Light Mode */
body.light-mode .notification-toast {
    background: white;
    color: #1a1f35;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
}

/* MOBILE STATS CAROUSEL */
.mobile-stats-carousel {
    display: none;
}

@media (max-width: 768px) {
    .stats-grid {
        display: none;
    }
    
    .mobile-stats-carousel {
        display: block;
        width: 100%;
        overflow: hidden;
        padding: 0;
        margin-bottom: 50px;
    }
    
    .stats-carousel-track {
        display: flex;
        transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        touch-action: pan-y;
    }
    
    .stats-carousel-slide {
        min-width: 100%;
        padding: 0 10px;
    }
    
    .stats-carousel-dots {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
    }
    
    .stats-carousel-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: rgba(100, 255, 218, 0.3);
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .stats-carousel-dot.active {
        background: #64ffda;
        width: 30px;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
    }
    
    body.light-mode .stats-carousel-dot {
        background: rgba(10, 122, 94, 0.3);
    }
    
    body.light-mode .stats-carousel-dot.active {
        background: #0a7a5e;
    }
}

/* FIX PRACTICE SECTION ON MOBILE */
@media (max-width: 768px) {
    .panel-header {
        flex-direction: column;
        gap: 10px;
        align-items: stretch;
    }
    
    #languageDetector {
        order: 1;
        width: 100%;
        justify-content: center;
    }
    
    .run-button {
        order: 2;
        width: 100%;
        justify-content: center;
    }
}

/* FIX SETTINGS LOGOUT BUTTON ON MOBILE */
@media (max-width: 768px) {
    .account-header {
        flex-direction: column;
        gap: 20px;
        align-items: stretch;
    }
    
    .account-info {
        width: 100%;
        justify-content: center;
    }
    
    .logout-btn {
        width: 100%;
        padding: 15px 30px;
    }
}

/* FIX PROGRESS BARS ALIGNMENT */
.bar-chart {
    display: flex;
    align-items: flex-end;
    gap: 20px;
    height: 320px;
    padding: 20px 20px 60px 90px; /* Increased left padding */
    justify-content: center;
    position: relative;
    background: 
        linear-gradient(90deg, rgba(100, 255, 218, 0.03) 1px, transparent 1px),
        linear-gradient(0deg, rgba(100, 255, 218, 0.03) 1px, transparent 1px);
    background-size: 50px 35px;
}

.chart-y-labels {
    position: absolute;
    left: 15px; /* Better positioning */
    top: 20px;
    bottom: 60px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    color: #64ffda;
    font-size: 0.85em;
    font-weight: 600;
    z-index: 10;
}

@media (max-width: 768px) {
    .bar-chart {
        height: 280px;
        padding: 15px 10px 55px 65px; /* Adjusted padding */
        gap: 12px;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
        justify-content: flex-start;
    }
    
    .chart-y-labels {
        left: 8px;
        font-size: 0.7em;
        bottom: 55px;
    }
    
    .bar-item {
        flex: 0 0 70px;
        min-width: 70px;
        height: 200px;
    }
}

@media (max-width: 480px) {
    .bar-chart {
        padding: 15px 5px 50px 55px; /* Further adjusted */
    }
    
    .chart-y-labels {
        left: 5px;
        font-size: 0.65em;
    }
}

/* REMOVE BUGGY LINES BETWEEN CHAT MESSAGES */
.chat-messages {
    overflow-x: hidden !important;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
    border: none !important;
    outline: none !important;
}

.message {
    display: flex;
    gap: 15px;
    animation: messageSlide 0.4s ease-out;
    min-height: fit-content;
    width: 100%;
    margin-bottom: 25px;
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
}

.message-avatar {
    width: 45px;
    height: 45px;
    min-width: 45px;
    min-height: 45px;
    border-radius: 50%;
    background: rgba(100, 255, 218, 0.2);
    border: 2px solid rgba(100, 255, 218, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5em;
    flex-shrink: 0;
    box-shadow: none !important;
}

.message-bubble {
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.1);
    padding: 18px 22px;
    border-radius: 15px;
    line-height: 1.7;
    font-size: 1.05em;
    color: #e0e0e0;
    flex: 1;
    min-width: 0;
    word-wrap: break-word;
    overflow-wrap: break-word;
    contain: layout;
    outline: none !important;
    box-shadow: none !important;
}

body.light-mode .message-bubble {
    background: rgba(10, 122, 94, 0.05);
    color: #1a1a1a;
    border-color: rgba(10, 122, 94, 0.1);
}

/* Remove any default borders/outlines */
.chat-container * {
    outline: none !important;
}

.content-panel {
    border: none !important;
    outline: none !important;
}

.chat-container {
    background: rgba(30, 30, 30, 0.4);
    border: 1px solid rgba(100, 255, 218, 0.1);
    border-radius: 20px;
    padding: 35px;
    overflow: hidden !important;
}

body.light-mode .chat-container {
    background: rgba(255, 255, 255, 0.6);
    border-color: rgba(10, 122, 94, 0.2);
}

.auth-message.success {
    background: linear-gradient(135deg, rgba(100, 255, 100, 0.15), rgba(100, 255, 218, 0.15));
    border: 2px solid rgba(100, 255, 100, 0.4);
    color: #00ff00;
    padding: 20px;
    border-radius: 15px;
    animation: fadeIn 0.3s ease;
}

/* NEW COURSE BADGE */
.new-badge {
    position: absolute;
    top: 15px;
    left: 15px;
    background: linear-gradient(135deg, #ff6b6b, #ff8e53);
    color: white;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75em;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    z-index: 10;
    box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
    animation: newBadgePulse 2s infinite;
}

@keyframes newBadgePulse {
    0%, 100% {
        transform: scale(1);
        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
    }
    50% {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
    }
}

body.light-mode .new-badge {
    background: linear-gradient(135deg, #e63946, #f77f00);
    box-shadow: 0 4px 15px rgba(230, 57, 70, 0.4);
}

/* ENHANCED INTERFACE DESIGN */
.nav-tabs {
    box-shadow: 0 10px 40px rgba(100, 255, 218, 0.15);
    border: 2px solid rgba(100, 255, 218, 0.2);
}

.nav-tab {
    position: relative;
    overflow: hidden;
}

.nav-tab {
    position: relative;
    overflow: hidden;
}

.nav-tab::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(100, 255, 218, 0.15);
    border-radius: 50px;
    transform: scale(0);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    z-index: -1;
}

.nav-tab:hover::before {
    transform: scale(1);
}

.nav-tab.active::before {
    transform: scale(1);
    background: rgba(100, 255, 218, 0.2);
}

.stat-card {
    position: relative;
    overflow: hidden;
}

.stat-card {
    position: relative;
    overflow: hidden;
}

.stat-card::after {
    content: '';
    position: absolute;
    top: -50%;
    right: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(90deg, 
        transparent 0%,
        transparent 40%,
        rgba(100, 255, 218, 0.15) 50%,
        transparent 60%,
        transparent 100%);
    transform: translateX(-100%) rotate(45deg);
    transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.stat-card:hover::after {
    transform: translateX(100%) rotate(45deg);
}

/* Smooth fade in/out on hover */
.stat-card {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.stat-card:hover {
    transform: translateY(-5px) scale(1.02);
    box-shadow: 0 15px 50px rgba(100, 255, 218, 0.2);
}

/* Light mode */
body.light-mode .stat-card::after {
    background: linear-gradient(90deg, 
        transparent 0%,
        transparent 40%,
        rgba(10, 122, 94, 0.12) 50%,
        transparent 60%,
        transparent 100%);
}

body.light-mode .stat-card:hover {
    box-shadow: 0 15px 50px rgba(10, 122, 94, 0.15);
}

.course-card {
    position: relative;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.course-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent 0%,
        rgba(100, 255, 218, 0.08) 30%,
        rgba(100, 255, 218, 0.15) 50%,
        rgba(100, 255, 218, 0.08) 70%,
        transparent 100%);
    transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.course-card:not(.locked):hover::before {
    left: 100%;
}

.course-card:not(.locked):hover {
    transform: translateY(-5px) scale(1.01);
    box-shadow: 0 15px 50px rgba(100, 255, 218, 0.2);
}

/* Light mode */
body.light-mode .course-card::before {
    background: linear-gradient(90deg, 
        transparent 0%,
        rgba(10, 122, 94, 0.06) 30%,
        rgba(10, 122, 94, 0.12) 50%,
        rgba(10, 122, 94, 0.06) 70%,
        transparent 100%);
}

body.light-mode .course-card:not(.locked):hover {
    box-shadow: 0 15px 50px rgba(10, 122, 94, 0.15);
}

/* Improved Mobile Nav */
.mobile-nav {
    background: linear-gradient(135deg, 
        rgba(30, 30, 30, 0.98), 
        rgba(20, 20, 30, 0.98));
    box-shadow: 0 -5px 30px rgba(100, 255, 218, 0.2);
}

body.light-mode .mobile-nav {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.98), 
        rgba(250, 250, 255, 0.98));
}

/* Enhanced Button Styles */
.form-button,
.run-button,
.submit-button,
.next-button {
    position: relative;
    overflow: hidden;
}

.form-button::after,
.run-button::after,
.submit-button::after,
.next-button::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition: width 0.4s ease, height 0.4s ease;
}

.form-button:hover::after,
.run-button:hover::after,
.submit-button:hover::after,
.next-button:hover::after {
    width: 300px;
    height: 300px;
}

/* Smoother Transitions */
* {
    transition: background-color 0.3s ease, 
                color 0.3s ease, 
                border-color 0.3s ease;
}

/* TOUCH FEEDBACK FOR KEYWORDS */
.keyword-highlight {
    position: relative;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
}

.keyword-highlight::after {
    content: '';
    position: absolute;
    inset: -4px;
    background: rgba(100, 255, 218, 0.2);
    border-radius: 8px;
    opacity: 0;
    transform: scale(0.8);
    transition: all 0.2s ease;
    pointer-events: none;
    z-index: -1;
}

.keyword-highlight:active::after {
    opacity: 1;
    transform: scale(1);
}

body.light-mode .keyword-highlight::after {
    background: rgba(10, 122, 94, 0.15);
}

.keyword-highlight {
    position: relative;
    background: linear-gradient(120deg, rgba(100, 255, 218, 0.25) 0%, rgba(100, 255, 218, 0.15) 100%);
    padding: 3px 8px;
    border-radius: 6px;
    font-weight: 700;
    color: #64ffda;
    cursor: pointer;
    transition: all 0.3s ease;
    border-bottom: 2px solid rgba(100, 255, 218, 0.5);
    display: inline-block;
    margin: 0 2px;
}

body.light-mode .keyword-highlight {
    background: linear-gradient(120deg, rgba(10, 122, 94, 0.2) 0%, rgba(10, 122, 94, 0.1) 100%);
    color: #0a7a5e;
    border-bottom-color: rgba(10, 122, 94, 0.5);
}

/* SIMPLE TOOLTIP - NO CLIPPING */
.keyword-highlight {
    position: relative;
    background: linear-gradient(120deg, rgba(100, 255, 218, 0.25) 0%, rgba(100, 255, 218, 0.15) 100%);
    padding: 3px 8px;
    border-radius: 6px;
    font-weight: 700;
    color: #64ffda;
    cursor: pointer;
    transition: all 0.3s ease;
    border-bottom: 2px solid rgba(100, 255, 218, 0.5);
    display: inline-block;
    margin: 0 2px;
}

/* HIDE ON MOBILE - USE TAP INSTEAD */
@media (max-width: 768px) {
    .keyword-highlight::after,
    .keyword-highlight::before {
        display: none !important;
    }
    
    .keyword-highlight:active {
        transform: scale(0.95);
        background: linear-gradient(120deg, rgba(100, 255, 218, 0.4) 0%, rgba(100, 255, 218, 0.3) 100%);
    }
}

/* ALLOW TOOLTIPS TO SHOW - CRITICAL FIX */
.message-bubble {
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.1);
    padding: 18px 22px;
    border-radius: 15px;
    line-height: 1.7;
    font-size: 1.05em;
    color: #e0e0e0;
    flex: 1;
    min-width: 0;
    word-wrap: break-word;
    overflow-wrap: break-word;
    /* CRITICAL: Allow tooltip to escape */
    overflow: visible !important;
    position: relative;
}

.chat-messages {
    display: flex;
    flex-direction: column;
    gap: 25px;
    overflow-x: hidden !important;
    overflow-y: auto;
    width: 100%;
    max-width: 100%;
    position: relative;
    /* Keep horizontal scroll hidden, but allow tooltips */
    padding-top: 60px; /* Space for tooltips at top */
    margin-top: -60px; /* Offset the padding */
}

.chat-container {
    background: rgba(30, 30, 30, 0.4);
    border: 1px solid rgba(100, 255, 218, 0.1);
    border-radius: 20px;
    padding: 35px;
    /* CRITICAL: Allow tooltip to show outside */
    overflow: visible !important;
    position: relative;
}

.content-panel {
    overflow: visible !important;
    position: relative;
}

.lesson-content {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 30px;
    -webkit-overflow-scrolling: touch;
    position: relative;
}

/* PORTAL TOOLTIP - CREATED BY JAVASCRIPT */
.keyword-tooltip-portal {
    position: fixed;
    background: linear-gradient(135deg, rgba(30, 30, 30, 0.98), rgba(40, 45, 50, 0.98));
    color: #64ffda;
    padding: 12px 20px;
    border-radius: 12px;
    font-size: 0.9em;
    white-space: nowrap;
    border: 2px solid #64ffda;
    box-shadow: 
        0 10px 30px rgba(100, 255, 218, 0.5),
        0 0 0 1px rgba(100, 255, 218, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    z-index: 999999;
    font-weight: 700;
    letter-spacing: 0.8px;
    pointer-events: none;
    font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
    animation: tooltipFadeIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

body.light-mode .keyword-tooltip-portal {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(250, 252, 255, 0.98));
    color: #0a7a5e;
    border-color: #0a7a5e;
    box-shadow: 
        0 10px 30px rgba(10, 122, 94, 0.5),
        0 0 0 1px rgba(10, 122, 94, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
}

.keyword-tooltip-arrow {
    position: fixed;
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 12px solid #64ffda;
    z-index: 999998;
    pointer-events: none;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
}

body.light-mode .keyword-tooltip-arrow {
    border-top-color: #0a7a5e;
}

@keyframes tooltipFadeIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(10px) scale(0.9);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
    }
}

/* FILTER & GOALS CONTROLS */
.progress-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

/* Language Filter Dropdown */
.language-filter {
    position: relative;
    display: none; /* Hidden on desktop */
}

@media (max-width: 768px) {
    .language-filter {
        display: block;
        flex: 1;
        min-width: 150px;
    }
}

.filter-button {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    padding: 12px 20px;
    background: rgba(100, 255, 218, 0.1);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 50px;
    color: #64ffda;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
}

body.light-mode .filter-button {
    background: rgba(10, 122, 94, 0.1);
    border-color: rgba(10, 122, 94, 0.3);
    color: #0a7a5e;
}

.filter-button:hover {
    background: rgba(100, 255, 218, 0.2);
    transform: translateY(-2px);
}

.filter-arrow {
    font-size: 0.8em;
    transition: transform 0.3s ease;
}

.language-filter.active .filter-arrow {
    transform: rotate(180deg);
}

.filter-dropdown {
    position: absolute;
    top: calc(100% + 10px);
    left: 0;
    right: 0;
    background: rgba(30, 30, 30, 0.98);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 20px;
    backdrop-filter: blur(20px);
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transform: translateY(-10px);
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    z-index: 100;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
}

body.light-mode .filter-dropdown {
    background: rgba(255, 255, 255, 0.98);
    border-color: rgba(10, 122, 94, 0.3);
}

.language-filter.active .filter-dropdown {
    max-height: 400px;
    opacity: 1;
    transform: translateY(0);
}

.filter-option {
    padding: 15px 20px;
    cursor: pointer;
    transition: all 0.2s ease;
    border-bottom: 1px solid rgba(100, 255, 218, 0.1);
    color: #e0e0e0;
    font-weight: 600;
}

body.light-mode .filter-option {
    color: #1a1a1a;
    border-bottom-color: rgba(10, 122, 94, 0.1);
}

.filter-option:last-child {
    border-bottom: none;
}

.filter-option:hover {
    background: rgba(100, 255, 218, 0.1);
    padding-left: 30px;
}

.filter-option.active {
    background: rgba(100, 255, 218, 0.15);
    color: #64ffda;
}

body.light-mode .filter-option.active {
    background: rgba(10, 122, 94, 0.15);
    color: #0a7a5e;
}

/* Set Goals Button */
.set-goals-btn {
    padding: 12px 30px;
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.2), rgba(0, 212, 255, 0.2));
    border: 2px solid #64ffda;
    border-radius: 50px;
    color: #64ffda;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 10px;
    box-shadow: 0 4px 15px rgba(100, 255, 218, 0.2);
    white-space: nowrap;
}

body.light-mode .set-goals-btn {
    background: linear-gradient(135deg, rgba(10, 122, 94, 0.2), rgba(0, 168, 150, 0.2));
    border-color: #0a7a5e;
    color: #0a7a5e;
}

.set-goals-btn:hover {
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.3), rgba(0, 212, 255, 0.3));
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(100, 255, 218, 0.3);
}

/* Goals Modal */
.goals-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(10px);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    animation: fadeIn 0.3s ease;
    overflow-y: auto;
    padding: 20px;
}

.goals-modal.active {
    display: flex;
}

.goals-modal-content {
    background: rgba(30, 30, 30, 0.98);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 25px;
    padding: 40px;
    max-width: 700px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    animation: modalSlide 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

body.light-mode .goals-modal-content {
    background: rgba(255, 255, 255, 0.98);
}

.goals-header {
    text-align: center;
    margin-bottom: 35px;
    border-bottom: 2px solid rgba(100, 255, 218, 0.2);
    padding-bottom: 20px;
}

.goals-header h2 {
    font-size: 2.2em;
    color: #64ffda;
    margin-bottom: 10px;
}

body.light-mode .goals-header h2 {
    color: #0a7a5e;
}

.goals-subtitle {
    color: #8b949e;
    font-size: 1.05em;
}

.goal-language-section {
    margin-bottom: 30px;
    padding: 25px;
    background: rgba(100, 255, 218, 0.05);
    border: 1px solid rgba(100, 255, 218, 0.2);
    border-radius: 20px;
    transition: all 0.3s ease;
}

.goal-language-section:hover {
    background: rgba(100, 255, 218, 0.08);
    border-color: rgba(100, 255, 218, 0.3);
}

.goal-lang-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
}

.goal-lang-icon {
    font-size: 2em;
}

.goal-lang-name {
    font-size: 1.4em;
    font-weight: 700;
    color: #64ffda;
}

body.light-mode .goal-lang-name {
    color: #0a7a5e;
}

.goal-input-group {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.goal-input-row {
    display: flex;
    align-items: center;
    gap: 15px;
}

.goal-input-row label {
    color: #e0e0e0;
    font-weight: 600;
    min-width: 180px;
}

body.light-mode .goal-input-row label {
    color: #1a1a1a;
}

.goal-input-row input {
    flex: 1;
    padding: 12px 20px;
    background: rgba(100, 255, 218, 0.05);
    border: 2px solid rgba(100, 255, 218, 0.3);
    border-radius: 15px;
    color: #64ffda;
    font-size: 1em;
    font-weight: 700;
    outline: none;
    transition: all 0.3s ease;
}

body.light-mode .goal-input-row input {
    background: rgba(10, 122, 94, 0.05);
    border-color: rgba(10, 122, 94, 0.3);
    color: #0a7a5e;
}

.goal-input-row input:focus {
    border-color: #64ffda;
    background: rgba(100, 255, 218, 0.1);
}

.goals-actions {
    display: flex;
    gap: 15px;
    margin-top: 35px;
    padding-top: 25px;
    border-top: 2px solid rgba(100, 255, 218, 0.2);
}

.goal-action-btn {
    flex: 1;
    padding: 15px;
    border: none;
    border-radius: 50px;
    font-size: 1.1em;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
}

.goal-save-btn {
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.3), rgba(0, 212, 255, 0.3));
    border: 2px solid #64ffda;
    color: #64ffda;
}

.goal-save-btn:hover {
    background: linear-gradient(135deg, rgba(100, 255, 218, 0.4), rgba(0, 212, 255, 0.4));
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(100, 255, 218, 0.4);
}

.goal-cancel-btn {
    background: rgba(100, 100, 100, 0.2);
    border: 2px solid rgba(100, 100, 100, 0.3);
    color: #8b949e;
}

.goal-cancel-btn:hover {
    background: rgba(100, 100, 100, 0.3);
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    .goals-modal-content {
        padding: 30px 20px;
    }
    
    .goal-input-row {
        flex-direction: column;
        align-items: stretch;
    }
    
    .goal-input-row label {
        min-width: auto;
    }
    
    .goals-actions {
        flex-direction: column;
    }
}

/* HIDE DESKTOP CHART TABS ON MOBILE */
@media (max-width: 768px) {
    .chart-tabs {
        display: none !important; /* Hide the oval language buttons on mobile */
    }
    
    /* Make filter visible on mobile */
    .language-filter {
        display: block;
    }
}

/* INCREASE CHART SIZE ON MOBILE */
@media (max-width: 768px) {
    .bar-chart {
        height: 350px; /* Increased from 280px */
        padding: 15px 5px 55px 55px;
        gap: 12px;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
        justify-content: flex-start;
        scroll-padding-left: 50px;
    }
    
    .bar-item {
        flex: 0 0 70px;
        min-width: 70px;
        height: 260px; /* Increased from 180px */
    }
    
    .bar {
        border-radius: 8px 8px 0 0;
    }
    
    .bar-value {
        font-size: 0.8em;
        top: -30px;
        padding: 5px 10px;
    }
    
    .bar-label {
        font-size: 0.7em;
        bottom: -40px;
        max-width: 70px;
        line-height: 1.1;
    }
    
    /* Adjust Y-axis labels */
    .chart-y-labels {
        left: 5px;
        font-size: 0.7em;
        bottom: 55px;
        top: 15px;
    }
    
    .chart-y-labels span {
        padding: 3px 6px;
        font-size: 0.85em;
    }
    
    /* Adjust axis lines */
    .bar-chart::before {
        left: 50px;
        bottom: 50px;
        height: calc(100% - 65px);
    }
    
    .bar-chart::after {
        left: 50px;
        bottom: 50px;
        width: calc(100% - 55px);
    }
}

@media (max-width: 480px) {
    .bar-chart {
        height: 320px; /* Slightly smaller for very small screens */
        padding: 12px 5px 50px 50px;
        gap: 10px;
    }
    
    .bar-item {
        flex: 0 0 65px;
        min-width: 65px;
        height: 240px;
    }
    
    .bar-value {
        font-size: 0.75em;
        top: -28px;
        padding: 4px 8px;
    }
    
    .bar-label {
        font-size: 0.68em;
        bottom: -38px;
        max-width: 65px;
    }
}

/* HIDE SET GOALS BUTTON */
.set-goals-btn {
    display: none !important;
}

/* Adjust progress controls when goals button is hidden */
.progress-controls {
    justify-content: flex-start; /* Align filter to left */
}

@media (max-width: 768px) {
    .progress-controls {
        justify-content: stretch;
    }
    
    .language-filter {
        width: 100%; /* Make filter full width on mobile */
    }
}
    </style>
</head>
<body>
    <!-- AUTH SCREEN -->
    <div class="auth-screen" id="authScreen">
        <div class="auth-container">
            <div class="auth-logo">
                <div class="auth-logo-icon">⚡</div>
                <div class="auth-logo-text">DevLearn Pro</div>
            </div>

            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchAuthTab('login')">Login</div>
                <div class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</div>
            </div>

            <!-- LOGIN FORM -->
            <form class="auth-form active" id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="loginPassword" required>
                </div>
                <button type="submit" class="form-button" id="loginBtn">Login</button>
                <div id="loginMessage"></div>
                <div class="forgot-link">
                    <a onclick="switchAuthTab('forgot')">Forgot Password?</a>
                </div>
            </form>

            <!-- SIGNUP FORM -->
            <form class="auth-form" id="signupForm" onsubmit="handleSignup(event)">
                <div class="form-group">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-input" id="signupName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="signupEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="signupPassword" required minlength="6">
                </div>
                <button type="submit" class="form-button" id="signupBtn">Create Account</button>
                <div id="signupMessage"></div>
            </form>

            <!-- FORGOT PASSWORD FORM - MOVED INSIDE -->
            <form class="auth-form" id="forgotForm" onsubmit="handleForgotPassword(event)">
                <div class="form-group">
                    <label class="form-label">Enter your email</label>
                    <input type="email" class="form-input" id="forgotEmail" required>
                </div>
                <button type="submit" class="form-button" id="forgotBtn">Send Code</button>
                <div id="forgotMessage"></div>
                <div class="forgot-link">
                    <a onclick="switchAuthTab('login')">← Back to Login</a>
                </div>
            </form>

            <!-- VERIFY FORM -->
<form class="auth-form" id="verifyForm" onsubmit="handleVerifyCode(event)">
    <!-- Step 1: Enter Code -->
    <div id="codeStep">
        <div class="form-group">
            <label class="form-label">Enter 6-digit verification code</label>
            <div class="otp-container">
    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]" required>
    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]" required>
    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]" required>
    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]" required>
    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]" required>
    <input type="text" class="otp-input" maxlength="1" pattern="[0-9]" required>
</div>
        </div>
        <button type="button" class="form-button" id="verifyCodeBtn" onclick="verifyCodeOnly()">Verify Code</button>
        <div id="verifyMessage"></div>
    </div>
    
    <!-- Step 2: Enter New Password (Hidden Initially) -->
    <div id="passwordStep" style="display: none;">
        <div class="form-group">
            <label class="form-label">Code Verified! Enter New Password</label>
            <input type="password" class="form-input" id="newPassword" minlength="6">
        </div>
        <button type="submit" class="form-button" id="resetPasswordBtn">Reset Password</button>
    </div>
    
    <div class="forgot-link">
        <a onclick="switchAuthTab('forgot')">← Back to Forgot Password</a>
    </div>
</form>

        </div> <!-- CLOSE auth-container HERE -->
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Updating Progress...</div>
        </div>
    </div>

    <div class="modal-overlay" id="retryModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon">🎯</div>
                <div class="modal-title">Course Completed!</div>
                <div class="modal-text">You've already completed this course. Would you like to retry it for practice or continue?</div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button retry" onclick="retryLesson()">🔄 Retry</button>
                <button class="modal-button continue" onclick="closeModal()">✓ Continue</button>
            </div>
        </div>
    </div>

    <!-- DESKTOP NAVIGATION -->
    <div class="nav-container" id="navContainer">
        <div class="nav-tabs" id="navTabs">
            <button class="nav-tab active" onclick="showSection('home')">Overview</button>
            <button class="nav-tab" onclick="showSection('learn')">Learn</button>
            <button class="nav-tab" onclick="showSection('practice')">Practice</button>
            <button class="nav-tab" onclick="showSection('settings')">Settings</button>
            <button class="search-icon" onclick="toggleSearch()">
                <svg viewBox="0 0 24 24">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
            </button>
        </div>
        <div class="search-input-container" id="searchContainer">
            <div class="search-input-wrapper">
                <input type="text" class="search-input" id="searchInput" placeholder="Search courses..." oninput="handleSearch()">
                <button class="search-close-btn" onclick="toggleSearch()">×</button>
            </div>
            <div class="search-results" id="searchResults"></div>
        </div>
    </div>

    <!-- MOBILE NAVIGATION -->
<div class="mobile-nav">
    <div class="mobile-nav-items">
        <div class="mobile-nav-item active" onclick="showSectionMobile('home', this)">
            <div class="mobile-nav-icon">📊</div>
            <div class="mobile-nav-label">Overview</div>
        </div>
        <div class="mobile-nav-item" onclick="showSectionMobile('learn', this)">
            <div class="mobile-nav-icon">💻</div>
            <div class="mobile-nav-label">Learn</div>
        </div>
        <div class="mobile-nav-item" onclick="showSectionMobile('practice', this)">
            <div class="mobile-nav-icon">⚡</div>
            <div class="mobile-nav-label">Practice</div>
        </div>
        <div class="mobile-nav-item" onclick="showSectionMobile('settings', this)">
            <div class="mobile-nav-icon">⚙️</div>
            <div class="mobile-nav-label">Settings</div>
        </div>
        <div class="mobile-nav-item" onclick="toggleMobileSearch()">
            <div class="mobile-nav-icon">🔍</div>
            <div class="mobile-nav-label">Search</div>
        </div>
    </div>
</div>

    <!-- MOBILE SEARCH -->
    <div class="mobile-search-overlay" id="mobileSearchOverlay" onclick="closeMobileSearch()"></div>
    <div class="mobile-search-container" id="mobileSearchContainer">
        <div class="mobile-search-header">
            <button class="mobile-search-back" onclick="closeMobileSearch()">←</button>
            <input type="text" class="mobile-search-input" id="mobileSearchInput" placeholder="Search courses..." oninput="handleMobileSearch()">
        </div>
        <div class="mobile-search-results" id="mobileSearchResults"></div>
    </div>

    <div class="main-content">
        <div id="home" class="section active">
            <div class="dashboard">
                <div class="dashboard-header">
                    <h1 class="dashboard-title">⚡ Your Progress Dashboard</h1>
                    <p class="dashboard-subtitle">Track your learning journey in real-time</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">📚</div>
                        <div class="stat-value" id="totalCourses">0</div>
                        <div class="stat-label">Courses Started</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">✅</div>
                        <div class="stat-value" id="completedLessons">0</div>
                        <div class="stat-label">Lessons Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">🔥</div>
                        <div class="stat-value" id="streakDays">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">⏱️</div>
                        <div class="stat-value" id="totalTime">0h 0m</div>
                        <div class="stat-label">Time Studied</div>
                    </div>
                </div>

                <div class="progress-section">
    <!-- PROGRESS CONTROLS (FILTER + SET GOALS) -->
    <div class="progress-controls">
        <!-- Mobile Language Filter -->
        <div class="language-filter" id="languageFilter">
            <button class="filter-button" onclick="toggleFilter()">
                <span id="filterText">🌐 All Languages</span>
                <span class="filter-arrow">▼</span>
            </button>
            <div class="filter-dropdown">
                <div class="filter-option active" onclick="filterChart('all')">🌐 All Languages</div>
                <div class="filter-option" onclick="filterChart('python')">🐍 Python</div>
                <div class="filter-option" onclick="filterChart('javascript')">⚡ JavaScript</div>
                <div class="filter-option" onclick="filterChart('html')">🌐 HTML</div>
                <div class="filter-option" onclick="filterChart('css')">🎨 CSS</div>
                <div class="filter-option" onclick="filterChart('react')">⚛️ React</div>
            </div>
        </div>
        
        <!-- Set Goals Button -->
        <button class="set-goals-btn" onclick="openGoalsModal()">
            <span>🎯</span>
            <span>Set Goals</span>
        </button>
    </div>
    
    <h2>📊 Course Progress by Language</h2>
    
    <!-- Existing chart tabs (keep for desktop) -->
    <div class="chart-tabs">
        <div class="chart-tab active" onclick="switchChart('all')">All Languages</div>
        <div class="chart-tab" onclick="switchChart('python')">🐍 Python</div>
        <div class="chart-tab" onclick="switchChart('javascript')">⚡ JavaScript</div>
        <div class="chart-tab" onclick="switchChart('html')">🌐 HTML</div>
        <div class="chart-tab" onclick="switchChart('css')">🎨 CSS</div>
        <div class="chart-tab" onclick="switchChart('react')">⚛️ React</div>
    </div>


                    <div id="allChart" class="chart-container active">
                        <div class="bar-chart" id="allBarChart"></div>
                    </div>
                    <div id="pythonChart" class="chart-container">
                        <div class="bar-chart" id="pythonBarChart"></div>
                    </div>
                    <div id="javascriptChart" class="chart-container">
                        <div class="bar-chart" id="javascriptBarChart"></div>
                    </div>
                    <div id="htmlChart" class="chart-container">
                        <div class="bar-chart" id="htmlBarChart"></div>
                    </div>
                    <div id="cssChart" class="chart-container">
                        <div class="bar-chart" id="cssBarChart"></div>
                    </div>
                    <div id="reactChart" class="chart-container">
                        <div class="bar-chart" id="reactBarChart"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="learn" class="section">
            <div class="learn-section">
                <div class="learn-header">
                    <h1>💻 Master Programming</h1>
                    <p style="color: #8b949e; margin-top: 10px;">Choose a language and start your journey</p>
                </div>

                <div class="language-tabs">
                    <div class="language-tab active" onclick="switchLanguage('python')">🐍 Python</div>
                    <div class="language-tab" onclick="switchLanguage('javascript')">⚡ JavaScript</div>
                    <div class="language-tab" onclick="switchLanguage('html')">🌐 HTML</div>
                    <div class="language-tab" onclick="switchLanguage('css')">🎨 CSS</div>
                    <div class="language-tab" onclick="switchLanguage('react')">⚛️ React</div>
                </div>

                <div id="python-content" class="language-content active">
                    <div class="course-grid" id="python-courses"></div>
                </div>
                <div id="javascript-content" class="language-content">
                    <div class="course-grid" id="javascript-courses"></div>
                </div>
                <div id="html-content" class="language-content">
                    <div class="course-grid" id="html-courses"></div>
                </div>
                <div id="css-content" class="language-content">
                    <div class="course-grid" id="css-courses"></div>
                </div>
                <div id="react-content" class="language-content">
                    <div class="course-grid" id="react-courses"></div>
                </div>
            </div>
        </div>

        <div id="practice" class="section">
            <div class="practice-container">
                <div class="practice-header">
                    <h1>⚡ Code Playground</h1>
                    <p style="color: #8b949e; margin-top: 10px;">Write code and see it run in real-time</p>
                </div>

                <div class="practice-workspace">
                    <div class="code-panel">
                        <div class="panel-header">
    <div class="panel-title">
        <span>💻</span> Code Editor
    </div>
    <div style="display: flex; align-items: center; gap: 15px;">
        <div id="languageDetector" style="color: #64ffda; font-weight: 600; font-size: 0.9em;">
            Programming Language: <span id="detectedLang">None</span>
        </div>
        <button class="run-button" onclick="runCode()">
            <span>▶</span> Run Code
        </button>
    </div>
</div>
                        <div class="code-editor-area">
                            <textarea id="codeEditor" placeholder="// Write your code here...
console.log('Hello, World!');

// HTML Example:
document.body.innerHTML = '<h1>Hello from JavaScript!</h1>';"></textarea>
                        </div>
                    </div>

                    <div class="output-panel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span>📺</span> Output
                            </div>
                        </div>
                        <div class="output-content">
                            <iframe id="outputFrame" class="output-frame"></iframe>
                            <div id="consoleOutput" class="console-output" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="settings" class="section">
    <div class="settings-container">
        <div class="settings-header">
            <h1>⚙️ Settings</h1>
            <p style="color: #8b949e; margin-top: 10px;">Customize your learning experience</p>
        </div>

        <div class="account-header">
            <div class="account-info">
                <div class="account-avatar" id="userAvatar">A</div>
                <div class="account-details">
                    <h2 id="userName">User</h2>
                    <p id="userEmail">user@example.com</p>
                </div>
            </div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="settings-section">
            <h2>⚙️ Preferences</h2>
            <div class="settings-grid">
                <div class="setting-card">
                    <h3>🌓 Dark Mode</h3>
                    <p>Toggle between dark and light themes</p>
                    <div class="toggle-switch active" id="themeToggle" onclick="toggleTheme()"></div>
                </div>
                
                <div class="setting-card">
                    <h3>⏩ Auto-advance</h3>
                    <p>Move to next lesson automatically</p>
                    <div class="toggle-switch" onclick="toggleSetting(this)"></div>
                </div>
                
                <div class="setting-card">
                    <h3>📧 Email Notifications</h3>
                    <p>Get updates about your progress</p>
                    <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
                </div>
                
                <div class="setting-card">
                    <h3>🎯 Daily Goals</h3>
                    <p>Set learning time targets</p>
                    <div class="toggle-switch" onclick="toggleSetting(this)"></div>
                </div>
            </div>
        </div>
    </div>
</div>

    <div id="lessonView" class="lesson-view">
        <div class="lesson-header-bar">
            <div class="lesson-left">
                <button class="back-button" onclick="closeLesson()">← Back</button>
                <div class="lesson-title" id="lessonTitle"></div>
            </div>
            <div class="lesson-progress-info">
                <div class="progress-indicator" id="lessonProgressText">0% Complete</div>
                <div class="tab-switcher">
                    <button class="tab-switch-btn active" id="learnTabBtn" onclick="switchPanel('learn')">Learn</button>
                    <button class="tab-switch-btn" id="questionsTabBtn" onclick="switchPanel('questions')" disabled>Questions 🔒</button>
                </div>
            </div>
        </div>
        <div class="lesson-content">
            <div id="learnPanel" class="content-panel active">
                <div class="chat-container">
                    <div class="chat-messages" id="learnMessages"></div>
                </div>
            </div>
            <div id="questionsPanel" class="content-panel">
                <div class="chat-container">
                    <div class="chat-messages" id="questionMessages"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="update-splash" id="updateSplash">
    <div class="update-content">
        <div class="update-icon">✨</div>
        <h1 class="update-title" id="splashTitle">New Version</h1>
        <p class="update-version">Version 3.4</p>
        
        <div class="changelog">
            <h3>🎨 What's New</h3>
            <ul>
                <li>🖌️ Redesigned interface with smoother animations</li>
                <li>🤖 Enhanced AI keyword explanations with inline popups</li>
                <li>📚 2 additional courses per language (35 total courses!)</li>
                <li>📱 Major mobile optimization improvements</li>
                <li>🐛 Fixed horizontal scrolling issues on mobile</li>
                <li>⚡ Faster loading times and smoother transitions</li>
                <li>🔥 Improved streak animation system</li>
                <li>✅ Better progress tracking and visualization</li>
            </ul>
        
        <button class="close-splash-btn" onclick="closeUpdateSplash()">Let's Go! 🚀</button>
    </div>
</div>

<div class="streak-celebration" id="streakCelebration">
    <div class="streak-card-animated">
        <div class="streak-icon-big">🔥</div>
        <div class="streak-number-container">
            <div class="streak-number-big old">0</div>
            <div class="streak-number-big new">1</div>
        </div>
        <div class="streak-text-big">Day Streak!</div>
    </div>
</div>

<div class="ai-explanation-modal" id="aiExplanationModal" onclick="closeAIExplanation(event)">
    <div class="ai-explanation-content" onclick="event.stopPropagation()">
        <button class="ai-close-btn" onclick="closeAIExplanation()">×</button>
        <div class="ai-keyword-display" id="aiKeyword"></div>
        <div class="ai-loading" id="aiLoading">
    <div class="wave-container">
        <div class="wave-line"></div>
        <div class="wave-line"></div>
        <div class="wave-line"></div>
    </div>
</div>

        <div class="ai-explanation-text" id="aiExplanationText" style="display: none;"></div>
    </div>
</div>

<!-- Custom Logout Modal -->
<div id="logoutModal" class="custom-modal">
    <div class="custom-modal-content">
        <div class="custom-modal-icon">👋</div>
        <h2 class="custom-modal-title">Logout Confirmation</h2>
        <p class="custom-modal-text">Are you sure you want to logout?</p>
        <div class="custom-modal-buttons">
            <button class="custom-modal-btn cancel-btn" onclick="closeLogoutModal()">Cancel</button>
            <button class="custom-modal-btn confirm-btn" onclick="confirmLogout()">Logout</button>
        </div>
    </div>
</div>

<!-- GOALS MODAL -->
<div class="goals-modal" id="goalsModal">
    <div class="goals-modal-content">
        <div class="goals-header">
            <h2>🎯 Set Your Learning Goals</h2>
            <p class="goals-subtitle">Define your targets for each language</p>
        </div>
        
        <div id="goalsContainer">
            <!-- Goals will be generated by JS -->
        </div>
        
        <div class="goals-actions">
            <button class="goal-action-btn goal-cancel-btn" onclick="closeGoalsModal()">Cancel</button>
            <button class="goal-action-btn goal-save-btn" onclick="saveGoals()">💾 Save Goals</button>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script src="main.js"></script>

    <script>

        // Mistral AI Configuration
function getAIConfig() {
    return {
        apiKey: '', // Will be fetched from backend
        endpoint: 'https://api.mistral.ai/v1/chat/completions',
        model: 'mistral-tiny' // or 'mistral-small', 'mistral-medium'
    };
}

// Fetch AI config from backend
async function fetchAIConfig() {
    try {
        const response = await fetch('/api/ai-config');
        const config = await response.json();
        return {
            apiKey: config.MISTRAL_API_KEY || '',
            endpoint: 'https://api.mistral.ai/v1/chat/completions',
            model: 'mistral-tiny'
        };
    } catch (error) {
        console.warn('AI config not available:', error);
        return {
            apiKey: '',
            endpoint: 'https://api.mistral.ai/v1/chat/completions',
            model: 'mistral-small'
        };
    }
}

// Fetch EmailJS config from backend (Vercel serverless function)
fetch('/api/email-config')
  .then(res => res.json())
  .then(config => {
    const EMAIL_CONFIG = {
      serviceId: config.EMAIL_SERVICE_ID,
      templateId: config.EMAIL_TEMPLATE_ID,
      publicKey: config.EMAIL_PUBLIC_KEY
    };

    if (EMAIL_CONFIG.publicKey) {
      emailjs.init(EMAIL_CONFIG.publicKey);
      console.log('✅ EmailJS configured successfully');
    } else {
      console.warn('⚠️ EmailJS not configured - password reset will not work');
    }
  })
  .catch(err => console.error('Error fetching EmailJS config:', err));



let studyStartTime = null;
let totalStudyTime = 0;
let timerInterval = null;
let pendingLesson = null;
let soundEnabled = true;
let currentUser = null;

let userProgress = {
    python: { 
        course1: { completed: false, progress: 0, time: 0 },
        course2: { completed: false, progress: 0, time: 0 },
        course3: { completed: false, progress: 0, time: 0 },
        course4: { completed: false, progress: 0, time: 0 },
        course5: { completed: false, progress: 0, time: 0 },
        course6: { completed: false, progress: 0, time: 0 },
        course7: { completed: false, progress: 0, time: 0 }  // ← NEW
    },
    javascript: { 
        course1: { completed: false, progress: 0, time: 0 },
        course2: { completed: false, progress: 0, time: 0 },
        course3: { completed: false, progress: 0, time: 0 },
        course4: { completed: false, progress: 0, time: 0 },
        course5: { completed: false, progress: 0, time: 0 },
        course6: { completed: false, progress: 0, time: 0 },
        course7: { completed: false, progress: 0, time: 0 }  // ← NEW
    },
    html: { 
        course1: { completed: false, progress: 0, time: 0 },
        course2: { completed: false, progress: 0, time: 0 },
        course3: { completed: false, progress: 0, time: 0 },
        course4: { completed: false, progress: 0, time: 0 },
        course5: { completed: false, progress: 0, time: 0 },
        course6: { completed: false, progress: 0, time: 0 },
        course7: { completed: false, progress: 0, time: 0 }  // ← NEW
    },
    css: { 
        course1: { completed: false, progress: 0, time: 0 },
        course2: { completed: false, progress: 0, time: 0 },
        course3: { completed: false, progress: 0, time: 0 },
        course4: { completed: false, progress: 0, time: 0 },
        course5: { completed: false, progress: 0, time: 0 },
        course6: { completed: false, progress: 0, time: 0 },
        course7: { completed: false, progress: 0, time: 0 }  // ← NEW
    },
    react: { 
        course1: { completed: false, progress: 0, time: 0 },
        course2: { completed: false, progress: 0, time: 0 },
        course3: { completed: false, progress: 0, time: 0 },
        course4: { completed: false, progress: 0, time: 0 },
        course5: { completed: false, progress: 0, time: 0 },
        course6: { completed: false, progress: 0, time: 0 },
        course7: { completed: false, progress: 0, time: 0 }  // ← NEW
    }
};

const courses = {
    python: [
        { id: 'course1', title: 'Variables', desc: 'Store data', icon: '📦' },
        { id: 'course2', title: 'Print Function', desc: 'Display output', icon: '🖨️' },
        { id: 'course3', title: 'Strings', desc: 'Text manipulation', icon: '📝' },
        { id: 'course4', title: 'Math Operators', desc: 'Calculations', icon: '➗' },
        { id: 'course5', title: 'Concatenation', desc: 'Joining strings', icon: '🔗' },
        { id: 'course6', title: 'Loops', desc: 'Repeat code', icon: '🔄', isNew: true },
        { id: 'course7', title: 'Lists', desc: 'Store multiple items', icon: '📋', isNew: true }
    ],
    javascript: [
        { id: 'course1', title: 'Variables', desc: 'let, const & types', icon: '📦' },
        { id: 'course2', title: 'Strings & Templates', desc: 'Text handling', icon: '📝' },
        { id: 'course3', title: 'Functions', desc: 'Reusable code', icon: '🎯' },
        { id: 'course4', title: 'DOM Manipulation', desc: 'Control web pages', icon: '🌐' },
        { id: 'course5', title: 'Arrays & Objects', desc: 'Data structures', icon: '📚' },
        { id: 'course6', title: 'Events', desc: 'User interactions', icon: '🖱️', isNew: true },
        { id: 'course7', title: 'Async & Promises', desc: 'Handle async code', icon: '⏳', isNew: true }
    ],
    html: [
        { id: 'course1', title: 'HTML Structure', desc: 'Basic tags', icon: '🌐' },
        { id: 'course2', title: 'Text Formatting', desc: 'Bold, italic, etc', icon: '✍️' },
        { id: 'course3', title: 'Lists', desc: 'Organize content', icon: '📝' },
        { id: 'course4', title: 'Images & Media', desc: 'Visual content', icon: '🖼️' },
        { id: 'course5', title: 'Forms', desc: 'User input', icon: '📋' },
        { id: 'course6', title: 'Links', desc: 'Connect pages', icon: '🔗', isNew: true },
        { id: 'course7', title: 'Tables', desc: 'Display data', icon: '📊', isNew: true }
    ],
    css: [
        { id: 'course1', title: 'CSS Selectors', desc: 'Target elements', icon: '🎯' },
        { id: 'course2', title: 'Colors & Backgrounds', desc: 'Style appearance', icon: '🎨' },
        { id: 'course3', title: 'Box Model', desc: 'Spacing & layout', icon: '📦' },
        { id: 'course4', title: 'Fonts & Text', desc: 'Typography', icon: '✍️' },
        { id: 'course5', title: 'Flexbox & Grid', desc: 'Modern layouts', icon: '📐' },
        { id: 'course6', title: 'Responsive Design', desc: 'Mobile-first CSS', icon: '📱', isNew: true },
        { id: 'course7', title: 'Animations', desc: 'Bring pages to life', icon: '✨', isNew: true }
    ],
    react: [
        { id: 'course1', title: 'Components & JSX', desc: 'React basics', icon: '⚛️' },
        { id: 'course2', title: 'Props', desc: 'Pass data', icon: '📬' },
        { id: 'course3', title: 'State', desc: 'Dynamic data', icon: '🔄' },
        { id: 'course4', title: 'Events', desc: 'User interactions', icon: '🎯' },
        { id: 'course5', title: 'Conditionals', desc: 'Dynamic UI', icon: '🔀' },
        { id: 'course6', title: 'Lists & Keys', desc: 'Render arrays', icon: '📋', isNew: true },
        { id: 'course7', title: 'useEffect Hook', desc: 'Side effects', icon: '🪝', isNew: true }
    ]
};

const lessonContent = {
    python: {
        course1: {
            learn: [
                { bot: 'Welcome to Python! 🐍 Let\'s start with the absolute basics - <span class="keyword-highlight">variables</span>!' },
                { bot: 'A variable is like a labeled box that stores data:<br><div class="code-example"><code>name = "Alice"<br>age = 25<br>is_student = True</code></div>' },
                { bot: 'Python has several <span class="keyword-highlight">data types</span>:<br>- <strong>String</strong>: Text in quotes ("hello")<br>- <strong>Integer</strong>: Whole numbers (42)<br>- <strong>Float</strong>: Decimals (3.14)<br>- <strong>Boolean</strong>: True or False' },
                { bot: 'Variable names should be descriptive:<br><div class="code-example"><code>user_name = "Bob"    # Good ✓<br>x = "Bob"            # Bad ✗</code></div>' },
                { bot: 'You can check a variable\'s type:<br><div class="code-example"><code>age = 25<br>print(type(age))  # <class \'int\'></code></div>' },
                { bot: 'Variables can change their value:<br><div class="code-example"><code>score = 10<br>score = 20  # Now score is 20</code></div>' },
                { bot: 'Python is case-sensitive! <code>Name</code> and <code>name</code> are different variables.' },
                { bot: '✅ Great! Variables are the foundation of all programming!' }
            ],
            exercises: [
                { type: 'fill', question: 'Create a variable called name', code: '___BLANK___ = "John"', answer: 'name' },
                { type: 'mcq', question: 'Which is a valid variable name?', options: ['2name', 'user_age', 'user-age', 'user name'], correct: 1 },
                { type: 'fill', question: 'Store the number 42', code: 'answer = ___BLANK___', answer: '42' },
                { type: 'mcq', question: 'What type is "Hello"?', options: ['int', 'string', 'float', 'bool'], correct: 1 },
                { type: 'fill', question: 'Check variable type', code: 'print(___BLANK___(age))', answer: 'type' }
            ]
        },
        course2: {
            learn: [
                { bot: 'Now let\'s learn to display output with <span class="keyword-highlight">print()</span>! 📺' },
                { bot: 'The print function shows text and numbers on the screen:<br><div class="code-example"><code>print("Hello, World!")<br>print(42)</code></div>' },
                { bot: 'Print variables by using their names:<br><div class="code-example"><code>name = "Alice"<br>print(name)  # Outputs: Alice</code></div>' },
                { bot: 'Print multiple things separated by commas:<br><div class="code-example"><code>print("Python", "is", "awesome!")<br># Output: Python is awesome!</code></div>' },
                { bot: 'Change the separator with <span class="keyword-highlight">sep</span>:<br><div class="code-example"><code>print("apple", "orange", sep=", ")<br># Output: apple, orange</code></div>' },
                { bot: 'Remove the newline with <span class="keyword-highlight">end</span>:<br><div class="code-example"><code>print("Loading", end="...")<br>print("Done!")<br># Output: Loading...Done!</code></div>' },
                { bot: 'Print combines text and variables:<br><div class="code-example"><code>age = 25<br>print("I am", age, "years old")</code></div>' },
                { bot: '✅ Perfect! You can now display anything!' }
            ],
            exercises: [
                { type: 'fill', question: 'Display "Hello"', code: '___BLANK___("Hello")', answer: 'print' },
                { type: 'mcq', question: 'What does print(5 + 3) show?', options: ['5 + 3', '8', 'Error', '53'], correct: 1 },
                { type: 'fill', question: 'Print without newline', code: 'print("Hi", ___BLANK___="")', answer: 'end' },
                { type: 'mcq', question: 'Default separator in print?', options: ['Comma', 'Space', 'Newline', 'None'], correct: 1 },
                { type: 'fill', question: 'Change separator', code: 'print("a", "b", ___BLANK___="-")', answer: 'sep' }
            ]
        },
        course3: {
            learn: [
                { bot: 'Strings are text in Python! 📝 Let\'s master them.' },
                { bot: 'Create strings with quotes (single or double):<br><div class="code-example"><code>name = "Alice"<br>city = \'Paris\'</code></div>' },
                { bot: 'Strings have powerful <span class="keyword-highlight">methods</span>:<br><div class="code-example"><code>text = "python"<br>print(text.upper())  # PYTHON<br>print(text.lower())  # python</code></div>' },
                { bot: 'Replace text with <span class="keyword-highlight">.replace()</span>:<br><div class="code-example"><code>msg = "I like cats"<br>print(msg.replace("cats", "dogs"))</code></div>' },
                { bot: 'Check string contents:<br><div class="code-example"><code>filename = "report.pdf"<br>print(filename.endswith(".pdf"))  # True<br>print(filename.startswith("rep"))  # True</code></div>' },
                { bot: 'Count occurrences:<br><div class="code-example"><code>text = "banana"<br>print(text.count("a"))  # 3</code></div>' },
                { bot: 'Get string length:<br><div class="code-example"><code>word = "hello"<br>print(len(word))  # 5</code></div>' },
                { bot: 'Strings are indexed starting from 0:<br><div class="code-example"><code>word = "Python"<br>print(word[0])  # P<br>print(word[3])  # h</code></div>' },
                { bot: '✅ Strings are everywhere in programming!' }
            ],
            exercises: [
                { type: 'fill', question: 'Convert to uppercase', code: 'word = "hi"<br>print(word.___BLANK___())', answer: 'upper' },
                { type: 'mcq', question: 'What is "Hi".lower()?', options: ['HI', 'Hi', 'hi', 'Error'], correct: 2 },
                { type: 'fill', question: 'Replace text', code: 'text.___BLANK___("old", "new")', answer: 'replace' },
                { type: 'mcq', question: 'Check if starts with?', options: ['.begins()', '.startswith()', '.starts()', '.check()'], correct: 1 },
                { type: 'fill', question: 'Get string length', code: 'print(___BLANK___(word))', answer: 'len' }
            ]
        },
        course4: {
            learn: [
                { bot: 'Time for Math! ➗ Python is a powerful calculator.' },
                { bot: 'Basic arithmetic operators:<br><div class="code-example"><code>print(10 + 5)   # 15 Addition<br>print(10 - 5)   # 5 Subtraction<br>print(10 * 5)   # 50 Multiplication<br>print(10 / 5)   # 2.0 Division</code></div>' },
                { bot: 'Division always gives a decimal (float)!' },
                { bot: 'The <span class="keyword-highlight">power operator **</span>:<br><div class="code-example"><code>print(2 ** 3)   # 8 (2×2×2)<br>print(10 ** 2)  # 100 (10×10)</code></div>' },
                { bot: '<span class="keyword-highlight">Floor division //</span> gives only the whole part:<br><div class="code-example"><code>print(17 // 5)  # 3<br>print(20 // 6)  # 3</code></div>' },
                { bot: '<span class="keyword-highlight">Modulo %</span> gives the remainder:<br><div class="code-example"><code>print(17 % 5)   # 2<br>print(20 % 6)   # 2</code></div>' },
                { bot: 'Python follows PEMDAS order:<br><div class="code-example"><code>result = (5 + 3) * 2<br>print(result)  # 16, not 11</code></div>' },
                { bot: 'Variables work in math:<br><div class="code-example"><code>x = 10<br>y = 3<br>print(x + y)  # 13</code></div>' },
                { bot: '✅ Math is essential for programming!' }
            ],
            exercises: [
                { type: 'fill', question: 'Get remainder', code: 'print(17 ___BLANK___ 5)', answer: '%' },
                { type: 'mcq', question: 'What is 2 ** 3?', options: ['6', '8', '9', '5'], correct: 1 },
                { type: 'fill', question: 'Whole number division', code: 'print(17 ___BLANK___ 5)', answer: '//' },
                { type: 'mcq', question: 'What is (5 + 3) * 2?', options: ['11', '13', '16', '10'], correct: 2 },
                { type: 'fill', question: 'Square a number', code: 'print(5 ___BLANK___ 2)', answer: '**' }
            ]
        },
        course5: {
            learn: [
                { bot: 'Concatenation means joining strings! 🔗' },
                { bot: 'Use the <span class="keyword-highlight">+ operator</span>:<br><div class="code-example"><code>first = "Hello"<br>last = "World"<br>print(first + " " + last)  # Hello World</code></div>' },
                { bot: 'Remember to add spaces manually!' },
                { bot: '<span class="keyword-highlight">F-strings</span> are the modern way:<br><div class="code-example"><code>name = "Alice"<br>age = 25<br>print(f"I am {name}, age {age}")</code></div>' },
                { bot: 'F-strings can do math:<br><div class="code-example"><code>price = 100<br>print(f"Total: ${price * 1.1}")<br># Output: Total: $110.0</code></div>' },
                { bot: 'Repeat strings with <span class="keyword-highlight">*</span>:<br><div class="code-example"><code>print("Ha" * 3)   # HaHaHa<br>print("=" * 10)   # ==========</code></div>' },
                { bot: 'Great for separators and patterns!' },
                { bot: 'The <span class="keyword-highlight">.format()</span> method:<br><div class="code-example"><code>text = "Hello {}".format("World")<br>print(text)  # Hello World</code></div>' },
                { bot: '✅ Combining strings is super useful!' }
            ],
            exercises: [
                { type: 'fill', question: 'Join strings', code: 'result = "Hi" ___BLANK___ " there"', answer: '+' },
                { type: 'mcq', question: 'What does "A" * 4 give?', options: ['A4', 'AAAA', 'A*4', 'Error'], correct: 1 },
                { type: 'fill', question: 'Create f-string', code: 'name = "Bob"<br>print(___BLANK___"Hi {name}")', answer: 'f' },
                { type: 'mcq', question: 'What does "=" * 5 give?', options: ['=5', '5', '=====', 'Error'], correct: 2 },
                { type: 'fill', question: 'Use format method', code: 'text = "Hi {}".___BLANK___("there")', answer: 'format' }
            ]
        },
        course6: {
            learn: [
                { bot: 'Loops repeat code! 🔄 Save time and effort.' },
                { bot: 'The <span class="keyword-highlight">for loop</span>:<br><div class="code-example"><code>for i in range(5):<br>    print(i)<br># Prints: 0, 1, 2, 3, 4</code></div>' },
                { bot: 'range(5) goes from 0 to 4 (zero-indexing)!' },
                { bot: 'Specify start and end:<br><div class="code-example"><code>for i in range(2, 6):<br>    print(i)<br># Prints: 2, 3, 4, 5</code></div>' },
                { bot: 'The <span class="keyword-highlight">while loop</span>:<br><div class="code-example"><code>count = 0<br>while count < 3:<br>    print(count)<br>    count += 1</code></div>' },
                { bot: 'Be careful! While loops can run forever if the condition never becomes False.' },
                { bot: 'Loop through lists:<br><div class="code-example"><code>fruits = ["apple", "banana"]<br>for fruit in fruits:<br>    print(fruit)</code></div>' },
                { bot: 'Use <span class="keyword-highlight">break</span> to exit early:<br><div class="code-example"><code>for i in range(10):<br>    if i == 5:<br>        break<br>    print(i)  # Prints 0-4</code></div>' },
                { bot: '✅ Loops are powerful automation!' }
            ],
            exercises: [
                { type: 'fill', question: 'Start a for loop', code: '___BLANK___ i in range(3):<br>    print(i)', answer: 'for' },
                { type: 'mcq', question: 'How many times does range(5) loop?', options: ['4', '5', '6', 'Infinite'], correct: 1 },
                { type: 'fill', question: 'Start a while loop', code: '___BLANK___ x < 10:<br>    print(x)', answer: 'while' },
                { type: 'mcq', question: 'What does range(2, 5) produce?', options: ['2,3,4', '2,3,4,5', '0,1,2,3,4', '3,4,5'], correct: 0 },
                { type: 'fill', question: 'Exit loop early', code: 'if done:<br>    ___BLANK___', answer: 'break' }
            ]
        },
        course7: {
            learn: [
                { bot: 'Lists store multiple items! 📋 Perfect for collections.' },
                { bot: 'Create lists with square brackets:<br><div class="code-example"><code>fruits = ["apple", "banana", "orange"]<br>numbers = [1, 2, 3, 4, 5]</code></div>' },
                { bot: 'Access items by <span class="keyword-highlight">index</span> (starts at 0):<br><div class="code-example"><code>fruits = ["apple", "banana"]<br>print(fruits[0])  # apple<br>print(fruits[1])  # banana</code></div>' },
                { bot: 'Add items with <span class="keyword-highlight">.append()</span>:<br><div class="code-example"><code>fruits.append("grape")<br>print(fruits)  # ["apple", "banana", "grape"]</code></div>' },
                { bot: 'Remove items with <span class="keyword-highlight">.remove()</span>:<br><div class="code-example"><code>fruits.remove("banana")<br>print(fruits)  # ["apple", "grape"]</code></div>' },
                { bot: 'Get list length:<br><div class="code-example"><code>print(len(fruits))  # 2</code></div>' },
                { bot: 'Check if item exists with <span class="keyword-highlight">in</span>:<br><div class="code-example"><code>if "apple" in fruits:<br>    print("Found it!")</code></div>' },
                { bot: '✅ Lists are everywhere in Python!' }
            ],
            exercises: [
                { type: 'fill', question: 'Create a list', code: 'nums = ___BLANK___1, 2, 3]', answer: '[' },
                { type: 'mcq', question: 'First item index?', options: ['1', '0', '-1', 'first'], correct: 1 },
                { type: 'fill', question: 'Add to list', code: 'fruits.___BLANK___("grape")', answer: 'append' },
                { type: 'mcq', question: 'Get list length?', options: ['size()', 'length()', 'len()', 'count()'], correct: 2 },
                { type: 'fill', question: 'Check if exists', code: 'if "apple" ___BLANK___ fruits:', answer: 'in' }
            ]
        }
    },

    javascript: {
        course1: {
            learn: [
                { bot: 'Welcome to JavaScript! ⚡ The language of the web!' },
                { bot: 'Let\'s start with <span class="keyword-highlight">variables</span> - containers for data.' },
                { bot: 'Use <span class="keyword-highlight">let</span> for changeable variables:<br><div class="code-example"><code>let age = 25;<br>age = 26;  // Now age is 26<br>console.log(age);</code></div>' },
                { bot: 'Use <span class="keyword-highlight">const</span> for values that never change:<br><div class="code-example"><code>const PI = 3.14159;<br>// PI = 3.15;  // Error!</code></div>' },
                { bot: 'Avoid the old <span class="keyword-highlight">var</span> keyword - use let and const!' },
                { bot: 'JavaScript data types:<br>- <strong>String</strong>: "text"<br>- <strong>Number</strong>: 42, 3.14<br>- <strong>Boolean</strong>: true, false<br>- <strong>Undefined</strong>: not assigned<br>- <strong>Null</strong>: intentionally empty' },
                { bot: '<span class="keyword-highlight">console.log()</span> displays output:<br><div class="code-example"><code>let name = "Alex";<br>console.log("Hello, " + name);</code></div>' },
                { bot: 'Check variable type:<br><div class="code-example"><code>console.log(typeof 42);      // "number"<br>console.log(typeof "text");  // "string"</code></div>' }
            ],
            exercises: [
                { type: 'fill', question: 'Declare changeable variable', code: '___BLANK___ count = 10;', answer: 'let' },
                { type: 'mcq', question: 'Which creates a constant?', options: ['var', 'let', 'const', 'constant'], correct: 2 },
                { type: 'fill', question: 'Display output', code: '___BLANK___.log("Hi");', answer: 'console' },
                { type: 'mcq', question: 'What is typeof "hello"?', options: ['text', 'string', 'String', 'char'], correct: 1 },
                { type: 'fill', question: 'Declare constant', code: '___BLANK___ MAX = 100;', answer: 'const' }
            ]
        },
        course2: {
            learn: [
                { bot: 'Strings and template literals! 📝 Modern JavaScript text handling.' },
                { bot: 'Strings use quotes:<br><div class="code-example"><code>let name = "Alice";<br>let city = \'Paris\';<br>let msg = `Hello`;</code></div>' },
                { bot: '<span class="keyword-highlight">Template literals</span> use backticks:<br><div class="code-example"><code>let name = "Bob";<br>let age = 25;<br>console.log(`I am ${name}, age ${age}`);</code></div>' },
                { bot: 'Template literals can span multiple lines:<br><div class="code-example"><code>let poem = `Roses are red<br>Violets are blue`;</code></div>' },
                { bot: 'String methods:<br><div class="code-example"><code>let text = "hello";<br>console.log(text.toUpperCase());  // HELLO<br>console.log(text.length);         // 5</code></div>' },
                { bot: 'Check string contents:<br><div class="code-example"><code>let email = "test@email.com";<br>console.log(email.includes("@"));  // true<br>console.log(email.startsWith("test"));  // true</code></div>' },
                { bot: 'Extract parts with <span class="keyword-highlight">.slice()</span>:<br><div class="code-example"><code>let text = "JavaScript";<br>console.log(text.slice(0, 4));  // "Java"</code></div>' },
                { bot: 'Replace text:<br><div class="code-example"><code>let msg = "Hi Bob";<br>console.log(msg.replace("Bob", "Alice"));</code></div>' },
                { bot: '✅ Strings are fundamental to all programs!' }
            ],
            exercises: [
                { type: 'fill', question: 'Create template literal', code: 'let msg = ___BLANK___Hello ${name}`;', answer: '`' },
                { type: 'mcq', question: 'What makes text uppercase?', options: ['.upper()', '.toUpperCase()', '.uppercase()', '.UPPER()'], correct: 1 },
                { type: 'fill', question: 'Get string length', code: 'let size = text.___BLANK___;', answer: 'length' },
                { type: 'mcq', question: 'Check if string contains text?', options: ['.has()', '.contains()', '.includes()', '.find()'], correct: 2 },
                { type: 'fill', question: 'Replace text', code: 'text.___BLANK___("old", "new")', answer: 'replace' }
            ]
        },
        course3: {
            learn: [
                { bot: 'Functions are reusable code blocks! 🎯' },
                { bot: 'Define with <span class="keyword-highlight">function</span> keyword:<br><div class="code-example"><code>function greet(name) {<br>  return "Hello " + name;<br>}<br>console.log(greet("Alice"));</code></div>' },
                { bot: 'Functions take <span class="keyword-highlight">parameters</span>:<br><div class="code-example"><code>function add(a, b) {<br>  return a + b;<br>}<br>console.log(add(5, 3));  // 8</code></div>' },
                { bot: '<span class="keyword-highlight">Arrow functions</span> are shorter:<br><div class="code-example"><code>const multiply = (x, y) => x * y;<br>console.log(multiply(4, 5));  // 20</code></div>' },
                { bot: 'One parameter? Skip parentheses:<br><div class="code-example"><code>const square = x => x * x;<br>console.log(square(5));  // 25</code></div>' },
                { bot: '<span class="keyword-highlight">Scope</span> controls variable access:<br><div class="code-example"><code>function test() {<br>  let secret = "hidden";<br>  console.log(secret);  // Works<br>}<br>// console.log(secret);  // Error!</code></div>' },
                { bot: 'Global scope is accessible everywhere!' },
                { bot: 'No return? Function returns <span class="keyword-highlight">undefined</span>:<br><div class="code-example"><code>function sayHi() {<br>  console.log("Hi");<br>}<br>let result = sayHi();  // undefined</code></div>' },
                { bot: '✅ Functions organize your code!' }
            ],
            exercises: [
                { type: 'fill', question: 'Define a function', code: '___BLANK___ greet() {<br>  console.log("Hi");<br>}', answer: 'function' },
                { type: 'mcq', question: 'What does (x) => x * 2 do?', options: ['Divides by 2', 'Doubles x', 'Adds 2', 'Squares x'], correct: 1 },
                { type: 'fill', question: 'Return a value', code: 'function add(a, b) {<br>  ___BLANK___ a + b;<br>}', answer: 'return' },
                { type: 'mcq', question: 'What is scope?', options: ['Function size', 'Variable accessibility', 'Function speed', 'Function type'], correct: 1 },
                { type: 'fill', question: 'Arrow function', code: 'const double = x ___BLANK___ x * 2;', answer: '=>' }
            ]
        },
        course4: {
            learn: [
                { bot: 'The <span class="keyword-highlight">DOM</span> lets JavaScript control web pages! 🌐' },
                { bot: 'DOM = Document Object Model - your HTML as JavaScript objects.' },
                { bot: 'Select by ID:<br><div class="code-example"><code>let title = document.getElementById("title");<br>console.log(title);</code></div>' },
                { bot: 'Select multiple elements:<br><div class="code-example"><code>let buttons = document.querySelectorAll(".btn");<br>// All elements with class "btn"</code></div>' },
                { bot: '<span class="keyword-highlight">querySelector</span> gets first match:<br><div class="code-example"><code>let first = document.querySelector(".item");</code></div>' },
                { bot: 'Change element content:<br><div class="code-example"><code>let heading = document.getElementById("main");<br>heading.textContent = "New Text";<br>heading.innerHTML = "<strong>Bold</strong>";</code></div>' },
                { bot: 'Modify styles:<br><div class="code-example"><code>title.style.color = "blue";<br>title.style.fontSize = "30px";</code></div>' },
                { bot: 'Add/remove CSS classes:<br><div class="code-example"><code>element.classList.add("active");<br>element.classList.remove("hidden");<br>element.classList.toggle("selected");</code></div>' }
            ],
            exercises: [
                { type: 'fill', question: 'Select by ID', code: 'let el = document.___BLANK___("myDiv");', answer: 'getElementById' },
                { type: 'mcq', question: 'Change text content?', options: ['innerHTML', 'textContent', 'value', 'text'], correct: 1 },
                { type: 'fill', question: 'Select first match', code: 'let first = document.___BLANK___(".item");', answer: 'querySelector' },
                { type: 'mcq', question: 'Add CSS class?', options: ['.addClass()', '.classList.add()', '.class.add()', '.addStyle()'], correct: 1 },
                { type: 'fill', question: 'Change style', code: 'element.___BLANK___.color = "red";', answer: 'style' }
            ]
        },
        course5: {
            learn: [
                { bot: 'Arrays and objects organize data! 📚' },
                { bot: '<span class="keyword-highlight">Arrays</span> store ordered lists:<br><div class="code-example"><code>let fruits = ["apple", "banana", "orange"];<br>console.log(fruits[0]);  // "apple"</code></div>' },
                { bot: 'Zero-indexed - first item is at index 0!' },
                { bot: 'Array methods:<br><div class="code-example"><code>fruits.push("grape");     // Add to end<br>fruits.pop();            // Remove from end<br>fruits.length;           // Get size<br>fruits.includes("apple"); // Check exists</code></div>' },
                { bot: '<span class="keyword-highlight">.map()</span> transforms each item:<br><div class="code-example"><code>let nums = [1, 2, 3, 4];<br>let doubled = nums.map(n => n * 2);<br>// [2, 4, 6, 8]</code></div>' },
                { bot: '<span class="keyword-highlight">Objects</span> store key-value pairs:<br><div class="code-example"><code>let person = {<br>  name: "Bob",<br>  age: 30,<br>  city: "NYC"<br>};<br>console.log(person.name);  // "Bob"</code></div>' },
                { bot: 'Two ways to access properties:<br><div class="code-example"><code>person.age        // Dot notation<br>person["age"]     // Bracket notation</code></div>' },
                { bot: 'Arrays and objects can be nested!' },
                { bot: '✅ Data structures are essential!' }
            ],
            exercises: [
                { type: 'fill', question: 'Access first item', code: 'let nums = [5, 10];<br>console.log(nums___BLANK___);', answer: '[0]' },
                { type: 'mcq', question: 'Add to array end?', options: ['add()', 'push()', 'append()', 'insert()'], correct: 1 },
                { type: 'fill', question: 'Add to array', code: 'fruits.___BLANK___("grape");', answer: 'push' },
                { type: 'mcq', question: 'Access object property?', options: ['object[key]', 'object.key', 'Both', 'object->key'], correct: 2 },
                { type: 'fill', question: 'Get array size', code: 'let size = arr.___BLANK___;', answer: 'length' }
            ]
        },
        course6: {
            learn: [
                { bot: 'Events make pages interactive! 🖱️' },
                { bot: '<span class="keyword-highlight">click</span> is the most common:<br><div class="code-example"><code>let btn = document.getElementById("myBtn");<br>btn.addEventListener("click", function() {<br>  alert("Clicked!");<br>});</code></div>' },
                { bot: 'Arrow functions are cleaner:<br><div class="code-example"><code>btn.addEventListener("click", () => {<br>  console.log("Clicked!");<br>});</code></div>' },
                { bot: '<span class="keyword-highlight">Event object</span> has useful info:<br><div class="code-example"><code>btn.addEventListener("click", (event) => {<br>  console.log(event.target);  // The clicked element<br>  console.log(event.type);    // "click"<br>});</code></div>' },
                { bot: 'Handle input changes:<br><div class="code-example"><code>let input = document.getElementById("name");<br>input.addEventListener("input", (e) => {<br>  console.log(e.target.value);<br>});</code></div>' },
                { bot: 'Common events:<br>- <strong>click</strong>: Mouse click<br>- <strong>input</strong>: Input changes<br>- <strong>submit</strong>: Form submit<br>- <strong>keypress</strong>: Key pressed<br>- <strong>mouseover</strong>: Mouse enters' },
                { bot: 'Prevent default behavior:<br><div class="code-example"><code>form.addEventListener("submit", (e) => {<br>  e.preventDefault();  // Stop submission<br>  // Handle yourself<br>});</code></div>' },
                { bot: 'Remove event listeners:<br><div class="code-example"><code>function handler() { console.log("hi"); }<br>btn.addEventListener("click", handler);<br>btn.removeEventListener("click", handler);</code></div>' },
                { bot: '✅ Events bring websites to life!' }
            ],
            exercises: [
                { type: 'fill', question: 'Add click listener', code: 'btn.___BLANK___("click", fn);', answer: 'addEventListener' },
                { type: 'mcq', question: 'Event fires on typing?', options: ['click', 'input', 'change', 'type'], correct: 1 },
                { type: 'fill', question: 'Prevent default', code: 'event.___BLANK___();', answer: 'preventDefault' },
                { type: 'mcq', question: 'What is e.target?', options: ['Event type', 'Element that triggered event', 'Event time', 'Mouse position'], correct: 1 },
                { type: 'fill', question: 'Remove listener', code: 'btn.___BLANK___("click", fn);', answer: 'removeEventListener' }
            ]
        },
        course7: {
            learn: [
                { bot: 'Async code handles operations that take time! ⏳' },
                { bot: '<span class="keyword-highlight">Promises</span> represent future values:<br><div class="code-example"><code>const promise = new Promise((resolve, reject) => {<br>  setTimeout(() => resolve("Done!"), 1000);<br>});</code></div>' },
                { bot: 'Use <span class="keyword-highlight">.then()</span> for success:<br><div class="code-example"><code>promise.then(result => {<br>  console.log(result);  // "Done!" after 1 sec<br>});</code></div>' },
                { bot: 'Use <span class="keyword-highlight">.catch()</span> for errors:<br><div class="code-example"><code>promise<br>  .then(result => console.log(result))<br>  .catch(error => console.log(error));</code></div>' },
                { bot: '<span class="keyword-highlight">async/await</span> looks synchronous:<br><div class="code-example"><code>async function getData() {<br>  const result = await promise;<br>  console.log(result);<br>}</code></div>' },
                { bot: 'Always use <span class="keyword-highlight">try/catch</span> with await:<br><div class="code-example"><code>async function getData() {<br>  try {<br>    const result = await promise;<br>    console.log(result);<br>  } catch (error) {<br>    console.log(error);<br>  }<br>}</code></div>' },
                { bot: 'Fetch data from APIs:<br><div class="code-example"><code>async function getUser() {<br>  const response = await fetch("api.com/user");<br>  const data = await response.json();<br>  return data;<br>}</code></div>' },
                { bot: '✅ Async unlocks powerful features!' }
            ],
            exercises: [
                { type: 'fill', question: 'Create async function', code: '___BLANK___ function getData() {}', answer: 'async' },
                { type: 'mcq', question: 'Wait for promise?', options: ['wait', 'await', 'promise', 'then'], correct: 1 },
                { type: 'fill', question: 'Handle success', code: 'promise.___BLANK___(result => {})', answer: 'then' },
                { type: 'mcq', question: 'Catch async errors?', options: ['error', 'catch', 'fail', 'exception'], correct: 1 },
                { type: 'fill', question: 'Fetch from API', code: 'const res = await ___BLANK___("url")', answer: 'fetch' }
            ]
        }
    },

    html: {
        course1: {
            learn: [
                { bot: 'HTML builds web page structure! 🌐 Every website uses it.' },
                { bot: 'HTML uses <span class="keyword-highlight">tags</span> - usually in pairs (opening and closing).' },
                { bot: 'Basic HTML structure:<br><div class="code-example"><code>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;title&gt;My Page&lt;/title&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>    &lt;h1&gt;Hello!&lt;/h1&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;head&gt;</span> = metadata. <span class="keyword-highlight">&lt;body&gt;</span> = visible content.' },
                { bot: 'Headings from h1 (biggest) to h6 (smallest):<br><div class="code-example"><code>&lt;h1&gt;Main Title&lt;/h1&gt;<br>&lt;h2&gt;Section&lt;/h2&gt;<br>&lt;h3&gt;Subsection&lt;/h3&gt;</code></div>' },
                { bot: 'Use h1 for main title - only one per page!' },
                { bot: 'Paragraphs use <span class="keyword-highlight">&lt;p&gt;</span>:<br><div class="code-example"><code>&lt;p&gt;This is a paragraph.&lt;/p&gt;<br>&lt;p&gt;Another paragraph.&lt;/p&gt;</code></div>' },
                { bot: 'Line breaks with <span class="keyword-highlight">&lt;br&gt;</span> (self-closing):<br><div class="code-example"><code>&lt;p&gt;First line&lt;br&gt;Second line&lt;/p&gt;</code></div>' }
            ],
            exercises: [
                { type: 'fill', question: 'Create main heading', code: '___BLANK___Title&lt;/h1&gt;', answer: '<h1>' },
                { type: 'mcq', question: 'Largest heading?', options: ['h6', 'h3', 'h1', 'h0'], correct: 2 },
                { type: 'fill', question: 'Create paragraph', code: '___BLANK___Text&lt;/p&gt;', answer: '<p>' },
                { type: 'mcq', question: 'Visible content goes in?', options: ['<head>', '<body>', '<html>', '<content>'], correct: 1 },
                { type: 'fill', question: 'Add line break', code: 'Line 1___BLANK___Line 2', answer: '<br>' }
            ]
        },
        course2: {
            learn: [
                { bot: 'Text formatting makes content stand out! ✍️' },
                { bot: '<span class="keyword-highlight">&lt;strong&gt;</span> makes text bold (important):<br><div class="code-example"><code>&lt;strong&gt;Important text&lt;/strong&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;em&gt;</span> makes text italic (emphasized):<br><div class="code-example"><code>&lt;em&gt;Emphasized text&lt;/em&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;b&gt;</span> and <span class="keyword-highlight">&lt;i&gt;</span> also work:<br><div class="code-example"><code>&lt;b&gt;Bold&lt;/b&gt; and &lt;i&gt;Italic&lt;/i&gt;</code></div>' },
                { bot: 'Use strong/em for meaning, b/i for style only!' },
                { bot: '<span class="keyword-highlight">&lt;mark&gt;</span> highlights text:<br><div class="code-example"><code>&lt;mark&gt;Highlighted&lt;/mark&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;small&gt;</span> makes text smaller:<br><div class="code-example"><code>&lt;small&gt;Fine print&lt;/small&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;del&gt;</span> shows deleted text:<br><div class="code-example"><code>&lt;del&gt;Deleted&lt;/del&gt; &lt;ins&gt;Inserted&lt;/ins&gt;</code></div>' },
                { bot: '✅ Formatting makes content readable!' }
            ],
            exercises: [
                { type: 'fill', question: 'Make text bold', code: '&lt;___BLANK___&gt;Bold&lt;/strong&gt;', answer: 'strong' },
                { type: 'mcq', question: 'Which emphasizes text?', options: ['<strong>', '<em>', '<b>', '<mark>'], correct: 1 },
                { type: 'fill', question: 'Highlight text', code: '&lt;___BLANK___&gt;Highlighted&lt;/mark&gt;', answer: 'mark' },
                { type: 'mcq', question: 'Show deleted text?', options: ['<delete>', '<del>', '<removed>', '<strike>'], correct: 1 },
                { type: 'fill', question: 'Make text italic', code: '&lt;___BLANK___&gt;Italic&lt;/i&gt;', answer: 'i' }
            ]
        },
        course3: {
            learn: [
                { bot: 'Lists organize information! 📝 Two types: ordered and unordered.' },
                { bot: '<span class="keyword-highlight">Unordered lists</span> use bullets:<br><div class="code-example"><code>&lt;ul&gt;<br>  &lt;li&gt;First item&lt;/li&gt;<br>  &lt;li&gt;Second item&lt;/li&gt;<br>&lt;/ul&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">Ordered lists</span> use numbers:<br><div class="code-example"><code>&lt;ol&gt;<br>  &lt;li&gt;Step one&lt;/li&gt;<br>  &lt;li&gt;Step two&lt;/li&gt;<br>&lt;/ol&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;li&gt;</span> creates list items - works in both!' },
                { bot: 'Nest lists inside lists:<br><div class="code-example"><code>&lt;ul&gt;<br>  &lt;li&gt;Fruits<br>    &lt;ul&gt;<br>      &lt;li&gt;Apple&lt;/li&gt;<br>      &lt;li&gt;Banana&lt;/li&gt;<br>    &lt;/ul&gt;<br>  &lt;/li&gt;<br>&lt;/ul&gt;</code></div>' },
                { bot: 'Description lists for terms:<br><div class="code-example"><code>&lt;dl&gt;<br>  &lt;dt&gt;HTML&lt;/dt&gt;<br>  &lt;dd&gt;HyperText Markup Language&lt;/dd&gt;<br>&lt;/dl&gt;</code></div>' },
                { bot: 'Lists are great for menus, ingredients, steps!' },
                { bot: '✅ Lists structure your content!' }
            ],
            exercises: [
                { type: 'fill', question: 'Start ordered list', code: '___BLANK___<br>  &lt;li&gt;First&lt;/li&gt;<br>&lt;/ol&gt;', answer: '<ol>' },
                { type: 'mcq', question: 'Create list items?', options: ['<item>', '<li>', '<list>', '<l>'], correct: 1 },
                { type: 'fill', question: 'Start unordered list', code: '___BLANK___<br>  &lt;li&gt;Item&lt;/li&gt;<br>&lt;/ul&gt;', answer: '<ul>' },
                { type: 'mcq', question: 'Which uses numbers?', options: ['<ul>', '<ol>', '<li>', '<dl>'], correct: 1 },
                { type: 'fill', question: 'Create list item', code: '___BLANK___Text&lt;/li&gt;', answer: '<li>' }
            ]
        },
        course4: {
            learn: [
                { bot: 'Add images and media! 🖼️ Visual content engages users.' },
                { bot: '<span class="keyword-highlight">&lt;img&gt;</span> inserts images (self-closing):<br><div class="code-example"><code>&lt;img src="photo.jpg" alt="A sunset"&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">src</span> = image location (path or URL).' },
                { bot: '<span class="keyword-highlight">alt</span> = text description:<br>- Shows if image fails<br>- Read by screen readers<br>- Helps SEO<br>Always include it!' },
                { bot: 'Control size:<br><div class="code-example"><code>&lt;img src="pic.jpg" alt="Photo" width="300" height="200"&gt;</code></div>' },
                { bot: 'Add videos:<br><div class="code-example"><code>&lt;video controls width="400"&gt;<br>  &lt;source src="movie.mp4" type="video/mp4"&gt;<br>  Browser doesn\'t support video.<br>&lt;/video&gt;</code></div>' },
                { bot: '<strong>controls</strong> attribute adds play/pause buttons!' },
                { bot: 'Audio works similarly:<br><div class="code-example"><code>&lt;audio controls&gt;<br>  &lt;source src="song.mp3" type="audio/mp3"&gt;<br>&lt;/audio&gt;</code></div>' },
                { bot: '✅ Media makes sites engaging!' }
            ],
            exercises: [
                { type: 'fill', question: 'Insert image', code: '&lt;___BLANK___ src="pic.jpg" alt="Photo"&gt;', answer: 'img' },
                { type: 'mcq', question: '"alt" provides?', options: ['Size', 'Link', 'Description', 'Style'], correct: 2 },
                { type: 'fill', question: 'Specify image location', code: '&lt;img ___BLANK___="photo.jpg" alt="Pic"&gt;', answer: 'src' },
                { type: 'mcq', question: 'Add video controls?', options: ['control', 'controls', 'buttons', 'player'], correct: 1 },
                { type: 'fill', question: 'Add video', code: '&lt;___BLANK___ controls&gt;<br>  &lt;source src="vid.mp4"&gt;<br>&lt;/video&gt;', answer: 'video' }
            ]
        },
        course5: {
            learn: [
                { bot: 'Forms collect user input! 📋 Essential for interaction.' },
                { bot: '<span class="keyword-highlight">&lt;form&gt;</span> wraps all inputs:<br><div class="code-example"><code>&lt;form&gt;<br>  &lt;input type="text" placeholder="Name"&gt;<br>  &lt;button&gt;Submit&lt;/button&gt;<br>&lt;/form&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;input&gt;</span> has many types:<br>- text: Single-line<br>- email: Email address<br>- password: Hidden<br>- number: Numeric<br>- date: Date picker<br>- checkbox: Yes/no<br>- radio: Select one' },
                { bot: 'Inputs with labels:<br><div class="code-example"><code>&lt;label for="name"&gt;Name:&lt;/label&gt;<br>&lt;input type="text" id="name" name="name"&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;textarea&gt;</span> for long text:<br><div class="code-example"><code>&lt;textarea rows="5" cols="30"&gt;<br>Default text<br>&lt;/textarea&gt;</code></div>' },
                { bot: 'Dropdown menus:<br><div class="code-example"><code>&lt;select name="country"&gt;<br>  &lt;option value="us"&gt;USA&lt;/option&gt;<br>  &lt;option value="uk"&gt;UK&lt;/option&gt;<br>&lt;/select&gt;</code></div>' },
                { bot: 'Checkboxes for multiple choices:<br><div class="code-example"><code>&lt;input type="checkbox" id="agree"&gt;<br>&lt;label for="agree"&gt;I agree&lt;/label&gt;</code></div>' },
                { bot: '<strong>placeholder</strong> = hint text. <strong>required</strong> = mandatory field.' },
                { bot: '✅ Forms enable user interaction!' }
            ],
            exercises: [
                { type: 'fill', question: 'Create text input', code: '&lt;___BLANK___ type="text"&gt;', answer: 'input' },
                { type: 'mcq', question: 'Wrap form inputs?', options: ['<div>', '<form>', '<input>', '<fieldset>'], correct: 1 },
                { type: 'fill', question: 'Multi-line input', code: '&lt;___BLANK___ rows="5"&gt;&lt;/textarea&gt;', answer: 'textarea' },
                { type: 'mcq', question: 'Hide text input?', options: ['hidden', 'password', 'secret', 'private'], correct: 1 },
                { type: 'fill', question: 'Create dropdown', code: '&lt;___BLANK___ name="choice"&gt;<br>  &lt;option&gt;A&lt;/option&gt;<br>&lt;/select&gt;', answer: 'select' }
            ]
        },
        course6: {
            learn: [
                { bot: 'Links connect pages! 🔗 Fundamental to the web.' },
                { bot: '<span class="keyword-highlight">&lt;a&gt;</span> (anchor) creates links:<br><div class="code-example"><code>&lt;a href="https://google.com"&gt;Visit Google&lt;/a&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">href</span> = destination URL.' },
                { bot: 'Open in new tab:<br><div class="code-example"><code>&lt;a href="page.html" target="_blank"&gt;<br>  Open in New Tab<br>&lt;/a&gt;</code></div>' },
                { bot: 'Link to page sections:<br><div class="code-example"><code>&lt;a href="#section1"&gt;Jump to Section 1&lt;/a&gt;<br><br>&lt;h2 id="section1"&gt;Section 1&lt;/h2&gt;</code></div>' },
                { bot: 'Email links use <span class="keyword-highlight">mailto:</span>:<br><div class="code-example"><code>&lt;a href="mailto:you@email.com"&gt;Email Me&lt;/a&gt;</code></div>' },
                { bot: 'Phone links use <span class="keyword-highlight">tel:</span>:<br><div class="code-example"><code>&lt;a href="tel:+1234567890"&gt;Call Us&lt;/a&gt;</code></div>' },
                { bot: 'Download links:<br><div class="code-example"><code>&lt;a href="file.pdf" download&gt;Download PDF&lt;/a&gt;</code></div>' },
                { bot: '✅ Links create the web!' }
            ],
            exercises: [
                { type: 'fill', question: 'Create link', code: '&lt;___BLANK___ href="site.com"&gt;Click&lt;/a&gt;', answer: 'a' },
                { type: 'mcq', question: 'Attribute with URL?', options: ['link', 'url', 'href', 'src'], correct: 2 },
                { type: 'fill', question: 'Open in new tab', code: '&lt;a href="page.html" ___BLANK___="_blank"&gt;', answer: 'target' },
                { type: 'mcq', question: 'Link to email?', options: ['email:', 'mailto:', 'mail:', 'e:'], correct: 1 },
                { type: 'fill', question: 'Link to section', code: '&lt;a ___BLANK___="#top"&gt;Go to Top&lt;/a&gt;', answer: 'href' }
            ]
        },
        course7: {
            learn: [
                { bot: 'Tables display data in rows and columns! 📊' },
                { bot: 'Create with <span class="keyword-highlight">&lt;table&gt;</span>:<br><div class="code-example"><code>&lt;table&gt;<br>  &lt;tr&gt;<br>    &lt;td&gt;Cell 1&lt;/td&gt;<br>    &lt;td&gt;Cell 2&lt;/td&gt;<br>  &lt;/tr&gt;<br>&lt;/table&gt;</code></div>' },
                { bot: '<span class="keyword-highlight">&lt;tr&gt;</span> = rows, <span class="keyword-highlight">&lt;td&gt;</span> = cells.' },
                { bot: 'Headers with <span class="keyword-highlight">&lt;th&gt;</span>:<br><div class="code-example"><code>&lt;table&gt;<br>  &lt;tr&gt;<br>    &lt;th&gt;Name&lt;/th&gt;<br>    &lt;th&gt;Age&lt;/th&gt;<br>  &lt;/tr&gt;<br>&lt;/table&gt;</code></div>' },
                { bot: 'Organize with <span class="keyword-highlight">&lt;thead&gt;</span>, <span class="keyword-highlight">&lt;tbody&gt;</span>, <span class="keyword-highlight">&lt;tfoot&gt;</span>:<br><div class="code-example"><code>&lt;table&gt;<br>  &lt;thead&gt;<br>    &lt;tr&gt;&lt;th&gt;Product&lt;/th&gt;&lt;/tr&gt;<br>  &lt;/thead&gt;<br>  &lt;tbody&gt;<br>    &lt;tr&gt;&lt;td&gt;Apple&lt;/td&gt;&lt;/tr&gt;<br>  &lt;/tbody&gt;<br>&lt;/table&gt;</code></div>' },
                { bot: 'Merge cells with <span class="keyword-highlight">colspan</span> and <span class="keyword-highlight">rowspan</span>:<br><div class="code-example"><code>&lt;td colspan="2"&gt;Spans 2 columns&lt;/td&gt;<br>&lt;td rowspan="2"&gt;Spans 2 rows&lt;/td&gt;</code></div>' },
                { bot: 'Style tables with CSS!' },
                { bot: '✅ Tables organize data perfectly!' }
            ],
            exercises: [
                { type: 'fill', question: 'Create table', code: '&lt;___BLANK___&gt;&lt;/table&gt;', answer: 'table' },
                { type: 'mcq', question: 'Create row?', options: ['<td>', '<tr>', '<th>', '<row>'], correct: 1 },
                { type: 'fill', question: 'Create cell', code: '&lt;___BLANK___&gt;Data&lt;/td&gt;', answer: 'td' },
                { type: 'mcq', question: 'Create header cell?', options: ['<th>', '<header>', '<td>', '<head>'], correct: 0 },
                { type: 'fill', question: 'Span columns', code: '&lt;td ___BLANK___="2"&gt;', answer: 'colspan' }
            ]
        }
    },

    css: {
        course1: {
            learn: [
                { bot: 'CSS makes websites beautiful! 🎨 It controls colors, layout, fonts.' },
                { bot: 'CSS has three parts: <span class="keyword-highlight">selector</span>, <span class="keyword-highlight">property</span>, <span class="keyword-highlight">value</span>:<br><div class="code-example"><code>h1 {<br>  color: blue;<br>  font-size: 32px;<br>}</code></div>' },
                { bot: '<strong>Selector</strong> = what to style. <strong>Property</strong> = what to change. <strong>Value</strong> = new setting.' },
                { bot: '<span class="keyword-highlight">Class selectors</span> use a dot (reusable):<br><div class="code-example"><code>.highlight {<br>  background: yellow;<br>  padding: 10px;<br>}</code></div>' },
                { bot: 'Use in HTML: <code>&lt;p class="highlight"&gt;Text&lt;/p&gt;</code>' },
                { bot: '<span class="keyword-highlight">ID selectors</span> use hashtag (unique):<br><div class="code-example"><code>#main {<br>  width: 80%;<br>  margin: 0 auto;<br>}</code></div>' },
                { bot: 'Combine selectors:<br><div class="code-example"><code>div.box {        /* div with class box */<br>  border: 1px solid black;<br>}<br><br>h1, h2, h3 {     /* all headings */<br>  color: navy;<br>}</code></div>' },
                { bot: 'Universal selector * targets everything:<br><div class="code-example"><code>* {<br>  margin: 0;<br>  padding: 0;<br>}</code></div>' }
            ],
            exercises: [
                { type: 'fill', question: 'Style all paragraphs', code: '___BLANK___ {<br>  color: red;<br>}', answer: 'p' },
                { type: 'mcq', question: 'Target a class?', options: ['#name', '.name', 'name', '*name'], correct: 1 },
                { type: 'fill', question: 'Target by ID', code: '___BLANK___main { width: 100%; }', answer: '#' },
                { type: 'mcq', question: 'Select all elements?', options: ['all', '*', 'everything', '%'], correct: 1 },
                { type: 'fill', question: 'Target class "box"', code: '___BLANK___box { padding: 20px; }', answer: '.' }
            ]
        },
        course2: {
            learn: [
                { bot: 'Colors and backgrounds bring design to life! 🌈' },
                { bot: 'Set text color:<br><div class="code-example"><code>p {<br>  color: blue;          /* name */<br>  color: #FF5733;       /* hex */<br>  color: rgb(255, 87, 51);  /* RGB */<br>  color: rgba(255, 87, 51, 0.5);  /* with transparency */<br>}</code></div>' },
                { bot: 'Background colors:<br><div class="code-example"><code>body {<br>  background-color: lightblue;<br>  background: linear-gradient(to right, blue, purple);<br>}</code></div>' },
                { bot: 'Background images:<br><div class="code-example"><code>.hero {<br>  background-image: url(\'photo.jpg\');<br>  background-size: cover;<br>  background-position: center;<br>}</code></div>' },
                { bot: 'Opacity controls transparency:<br><div class="code-example"><code>.box {<br>  opacity: 0.5;  /* 50% transparent */<br>}</code></div>' },
                { bot: 'Hex colors are common:<br>- #FF0000 = red<br>- #00FF00 = green<br>- #0000FF = blue<br>- #FFFFFF = white<br>- #000000 = black' },
                { bot: 'RGB values range 0-255 for red, green, blue.' },
                { bot: '✅ Colors create visual impact!' }
            ],
            exercises: [
                { type: 'fill', question: 'Change text color', code: 'p {<br>  ___BLANK___: blue;<br>}', answer: 'color' },
                { type: 'mcq', question: 'Which is a hex color?', options: ['blue', '#FF0000', 'rgb(255,0,0)', 'All'], correct: 1 },
                { type: 'fill', question: 'Set background', code: 'div {<br>  ___BLANK___-color: yellow;<br>}', answer: 'background' },
                { type: 'mcq', question: 'Make element 50% transparent?', options: ['transparent: 50%', 'opacity: 0.5', 'transparency: 0.5', 'alpha: 50'], correct: 1 },
                { type: 'fill', question: 'Set background image', code: 'div {<br>  background-___BLANK___: url("pic.jpg");<br>}', answer: 'image' }
            ]
        },
        course3: {
            learn: [
                { bot: 'The Box Model controls spacing! 📦 Every element is a box.' },
                { bot: 'Four layers:<br>1. <span class="keyword-highlight">Content</span> - actual content<br>2. <span class="keyword-highlight">Padding</span> - space inside border<br>3. <span class="keyword-highlight">Border</span> - edge<br>4. <span class="keyword-highlight">Margin</span> - space outside' },
                { bot: 'Padding adds inside space:<br><div class="code-example"><code>.box {<br>  padding: 20px;           /* all sides */<br>  padding: 10px 20px;      /* vertical horizontal */<br>  padding: 10px 15px 20px 25px;  /* top right bottom left */<br>}</code></div>' },
                { bot: 'Margin adds outside space:<br><div class="code-example"><code>.card {<br>  margin: 20px;<br>  margin-top: 10px;<br>  margin-bottom: 30px;<br>}</code></div>' },
                { bot: 'Center with <code>margin: 0 auto;</code>!' },
                { bot: 'Borders:<br><div class="code-example"><code>.box {<br>  border: 2px solid black;<br>  border-radius: 10px;  /* rounded */<br>}</code></div>' },
                { bot: 'Set dimensions:<br><div class="code-example"><code>.container {<br>  width: 300px;<br>  height: 200px;<br>  max-width: 100%;  /* responsive */<br>}</code></div>' },
                { bot: '✅ Box model controls layout!' }
            ],
            exercises: [
                { type: 'fill', question: 'Add inside spacing', code: '.box {<br>  ___BLANK___: 15px;<br>}', answer: 'padding' },
                { type: 'mcq', question: 'Outside spacing?', options: ['padding', 'margin', 'border', 'space'], correct: 1 },
                { type: 'fill', question: 'Add border', code: '.box {<br>  ___BLANK___: 1px solid black;<br>}', answer: 'border' },
                { type: 'mcq', question: 'Round corners?', options: ['corner-radius', 'round', 'border-radius', 'radius'], correct: 2 },
                { type: 'fill', question: 'Set width', code: '.container {<br>  ___BLANK___: 500px;<br>}', answer: 'width' }
            ]
        },
        course4: {
            learn: [
                { bot: 'Fonts and typography! ✍️ Control text appearance.' },
                { bot: '<span class="keyword-highlight">font-family</span> changes font:<br><div class="code-example"><code>body {<br>  font-family: Arial, Helvetica, sans-serif;<br>}</code></div>' },
                { bot: 'Always list multiple fonts (fallbacks)!' },
                { bot: 'Font properties:<br><div class="code-example"><code>h1 {<br>  font-size: 32px;<br>  font-weight: bold;    /* or 700 */<br>  font-style: italic;<br>  text-decoration: underline;<br>}</code></div>' },
                { bot: 'Text alignment:<br><div class="code-example"><code>p {<br>  text-align: center;   /* left, right, center, justify */<br>  line-height: 1.6;     /* line spacing */<br>  letter-spacing: 2px;  /* letter spacing */<br>}</code></div>' },
                { bot: 'Text transform:<br><div class="code-example"><code>h1 {<br>  text-transform: uppercase;  /* UPPERCASE */<br>  text-transform: lowercase;  /* lowercase */<br>  text-transform: capitalize; /* Capitalize Each */<br>}</code></div>' },
                { bot: 'Import Google Fonts:<br><div class="code-example"><code>@import url(\'https://fonts.googleapis.com/css2?family=Roboto\');<br><br>body {<br>  font-family: \'Roboto\', sans-serif;<br>}</code></div>' },
                { bot: 'Font weights: 100-900 (400=normal, 700=bold).' },
                { bot: '✅ Typography affects readability!' }
            ],
            exercises: [
                { type: 'fill', question: 'Change font', code: 'body {<br>  ___BLANK___-family: Arial;<br>}', answer: 'font' },
                { type: 'mcq', question: 'Make text bold?', options: ['font-weight: bold', 'text-bold', 'bold: true', 'weight: heavy'], correct: 0 },
                { type: 'fill', question: 'Center text', code: 'p {<br>  text-___BLANK___: center;<br>}', answer: 'align' },
                { type: 'mcq', question: 'Make text uppercase?', options: ['text-transform: uppercase', 'text-upper', 'uppercase: true', 'transform: upper'], correct: 0 },
                { type: 'fill', question: 'Set font size', code: 'h1 {<br>  font-___BLANK___: 32px;<br>}', answer: 'size' }
            ]
        },
        course5: {
            learn: [
                { bot: 'Flexbox and Grid! 📐 Modern layout tools.' },
                { bot: '<span class="keyword-highlight">Flexbox</span> for one-dimensional layouts:<br><div class="code-example"><code>.container {<br>  display: flex;<br>  justify-content: center;  /* horizontal */<br>  align-items: center;      /* vertical */<br>}</code></div>' },
                { bot: 'Flex direction:<br><div class="code-example"><code>.container {<br>  display: flex;<br>  flex-direction: row;    /* default */<br>  flex-direction: column; /* vertical */<br>}</code></div>' },
                { bot: '<span class="keyword-highlight">justify-content</span> options:<br>- flex-start, flex-end, center<br>- space-between, space-around' },
                { bot: 'Wrap items:<br><div class="code-example"><code>.container {<br>  display: flex;<br>  flex-wrap: wrap;<br>}</code></div>' },
                { bot: '<span class="keyword-highlight">Grid</span> for two-dimensional:<br><div class="code-example"><code>.grid {<br>  display: grid;<br>  grid-template-columns: 1fr 1fr 1fr;  /* 3 equal */<br>  gap: 20px;<br>}</code></div>' },
                { bot: '<strong>fr</strong> = fraction of available space.' },
                { bot: '✅ Flexbox and Grid make layout easy!' }
            ],
            exercises: [
                { type: 'fill', question: 'Enable flexbox', code: '.container {<br>  display: ___BLANK___;<br>}', answer: 'flex' },
                { type: 'mcq', question: 'Center vertically in flex?', options: ['justify-content', 'align-items', 'center', 'vertical-align'], correct: 1 },
                { type: 'fill', question: 'Enable grid', code: '.container {<br>  display: ___BLANK___;<br>}', answer: 'grid' },
                { type: 'mcq', question: 'Create grid columns?', options: ['columns', 'grid-columns', 'grid-template-columns', 'template-columns'], correct: 2 },
                { type: 'fill', question: 'Space between items', code: '.grid {<br>  ___BLANK___: 20px;<br>}', answer: 'gap' }
            ]
        },
        course6: {
            learn: [
                { bot: 'Responsive design adapts to screen sizes! 📱' },
                { bot: '<span class="keyword-highlight">Media queries</span>:<br><div class="code-example"><code>@media (max-width: 768px) {<br>  .sidebar {<br>    display: none;<br>  }<br>  .main {<br>    width: 100%;<br>  }<br>}</code></div>' },
                { bot: 'Common breakpoints:<br>- Mobile: max-width: 480px<br>- Tablet: max-width: 768px<br>- Desktop: max-width: 1024px<br>- Large: max-width: 1200px' },
                { bot: 'Mobile-first approach:<br><div class="code-example"><code>/* Mobile first */<br>.container {<br>  width: 100%;<br>}<br><br>/* Desktop */<br>@media (min-width: 768px) {<br>  .container {<br>    width: 750px;<br>  }<br>}</code></div>' },
                { bot: 'Responsive units:<br>- <strong>%</strong>: Relative to parent<br>- <strong>vw/vh</strong>: Viewport width/height<br>- <strong>rem</strong>: Root font size<br>- <strong>em</strong>: Parent font' },
                { bot: 'Responsive images:<br><div class="code-example"><code>img {<br>  max-width: 100%;<br>  height: auto;<br>}</code></div>' },
                { bot: 'Viewport meta tag (in HTML):<br><div class="code-example"><code>&lt;meta name="viewport" <br>  content="width=device-width, initial-scale=1"&gt;</code></div>' },
                { bot: '✅ Responsive design is essential!' }
            ],
            exercises: [
                { type: 'fill', question: 'Start media query', code: '___BLANK___ (max-width: 600px) {<br>  /* styles */<br>}', answer: '@media' },
                { type: 'mcq', question: 'Responsive unit?', options: ['px', 'pt', '%', 'cm'], correct: 2 },
                { type: 'fill', question: 'Responsive image', code: 'img {<br>  ___BLANK___-width: 100%;<br>}', answer: 'max' },
                { type: 'mcq', question: 'vw stands for?', options: ['Very wide', 'Viewport width', 'View width', 'Vertical width'], correct: 1 },
                { type: 'fill', question: 'Tablet breakpoint', code: '@media (max-width: ___BLANK___px) {}', answer: '768' }
            ]
        },
        course7: {
            learn: [
                { bot: 'CSS Animations! ✨ Bring pages to life.' },
                { bot: '<span class="keyword-highlight">Transitions</span> animate changes:<br><div class="code-example"><code>.button {<br>  background: blue;<br>  transition: background 0.3s;<br>}<br>.button:hover {<br>  background: red;<br>}</code></div>' },
                { bot: 'Transition all properties:<br><div class="code-example"><code>.box {<br>  transition: all 0.5s ease;<br>}</code></div>' },
                { bot: '<span class="keyword-highlight">@keyframes</span> for complex animations:<br><div class="code-example"><code>@keyframes slideIn {<br>  from { transform: translateX(-100%); }<br>  to { transform: translateX(0); }<br>}</code></div>' },
                { bot: 'Apply animations:<br><div class="code-example"><code>.element {<br>  animation: slideIn 1s ease;<br>}</code></div>' },
                { bot: 'Animation properties:<br><div class="code-example"><code>.element {<br>  animation-name: slideIn;<br>  animation-duration: 2s;<br>  animation-delay: 0.5s;<br>  animation-iteration-count: infinite;<br>}</code></div>' },
                { bot: '<span class="keyword-highlight">Transform</span> changes appearance:<br><div class="code-example"><code>transform: rotate(45deg);<br>transform: scale(1.5);<br>transform: translate(50px, 100px);</code></div>' },
                { bot: '✅ Animations enhance user experience!' }
            ],
            exercises: [
                { type: 'fill', question: 'Add transition', code: '.box {<br>  ___BLANK___: all 0.3s;<br>}', answer: 'transition' },
                { type: 'mcq', question: 'Create keyframes?', options: ['@animation', '@keyframes', '@animate', '@frames'], correct: 1 },
                { type: 'fill', question: 'Apply animation', code: '.el {<br>  ___BLANK___: fadeIn 1s;<br>}', answer: 'animation' },
                { type: 'mcq', question: 'Rotate element?', options: ['transform: rotate()', 'rotate()', 'animation: rotate()', 'turn()'], correct: 0 },
                { type: 'fill', question: 'Scale to 2x', code: 'transform: ___BLANK___(2);', answer: 'scale' }
            ]
        }
    },

    react: {
        course1: {
            learn: [
                { bot: 'React builds user interfaces with components! ⚛️' },
                { bot: 'A <span class="keyword-highlight">component</span> is reusable UI:<br><div class="code-example"><code>function Welcome() {<br>  return &lt;h1&gt;Hello React!&lt;/h1&gt;;<br>}</code></div>' },
                { bot: 'Components are functions that return <span class="keyword-highlight">JSX</span>!' },
                { bot: '<span class="keyword-highlight">JSX</span> looks like HTML but is JavaScript:<br><div class="code-example"><code>const element = &lt;h1&gt;Hello!&lt;/h1&gt;;<br>const name = "Alice";<br>const greeting = &lt;p&gt;Hi, {name}&lt;/p&gt;;</code></div>' },
                { bot: 'Use curly braces {} for JavaScript in JSX!' },
                { bot: 'Components must return single parent:<br><div class="code-example"><code>// Wrong ❌<br>return (<br>  &lt;h1&gt;Title&lt;/h1&gt;<br>  &lt;p&gt;Text&lt;/p&gt;<br>)<br><br>// Correct ✅<br>return (<br>  &lt;div&gt;<br>    &lt;h1&gt;Title&lt;/h1&gt;<br>    &lt;p&gt;Text&lt;/p&gt;<br>  &lt;/div&gt;<br>)</code></div>' },
                { bot: 'Or use <span class="keyword-highlight">fragments</span> to avoid extra divs:<br><div class="code-example"><code>return (<br>  &lt;&gt;<br>    &lt;h1&gt;Title&lt;/h1&gt;<br>    &lt;p&gt;Text&lt;/p&gt;<br>  &lt;/&gt;<br>)</code></div>' },
                { bot: '✅ Components make UI reusable!' }
            ],
            exercises: [
                { type: 'fill', question: 'Create component', code: '___BLANK___ App() {<br>  return &lt;div&gt;Hi&lt;/div&gt;;<br>}', answer: 'function' },
                { type: 'mcq', question: 'What is JSX?', options: ['CSS', 'HTML-like JavaScript', 'JSON', 'XML'], correct: 1 },
                { type: 'fill', question: 'Embed JavaScript', code: '&lt;p&gt;Count: ___BLANK___count}&lt;/p&gt;', answer: '{' },
                { type: 'mcq', question: 'Wrap multiple elements without div?', options: ['<wrap>', '<>', '<group>', '<span>'], correct: 1 },
                { type: 'fill', question: 'Return JSX', code: 'function App() {<br>  ___BLANK___ &lt;div&gt;Hi&lt;/div&gt;;<br>}', answer: 'return' }
            ]
        },
        course2: {
            learn: [
                { bot: 'Props pass data between components! 📬 Like function parameters.' },
                { bot: 'Send props when using component:<br><div class="code-example"><code>&lt;Greeting name="Alice" age={25} /&gt;</code></div>' },
                { bot: 'Strings use quotes, everything else uses braces!' },
                { bot: 'Receive props as parameter:<br><div class="code-example"><code>function Greeting(props) {<br>  return (<br>    &lt;div&gt;<br>      &lt;h1&gt;Hello {props.name}!&lt;/h1&gt;<br>      &lt;p&gt;Age: {props.age}&lt;/p&gt;<br>    &lt;/div&gt;<br>  );<br>}</code></div>' },
                { bot: '<span class="keyword-highlight">Destructure</span> props:<br><div class="code-example"><code>function Greeting({name, age}) {<br>  return &lt;h1&gt;Hello {name}, age {age}!&lt;/h1&gt;;<br>}</code></div>' },
                { bot: 'Props can be any type:<br>- Strings: "text"<br>- Numbers: {42}<br>- Booleans: {true}<br>- Arrays: {[1, 2, 3]}<br>- Objects: { {key: "value"} }<br>- Functions: {handleClick}' },
                { bot: 'Props are <strong>read-only</strong> - never change them!' },
                { bot: '✅ Props enable component communication!' }
            ],
            exercises: [
                { type: 'fill', question: 'Access prop', code: 'function Card(props) {<br>  return &lt;p&gt;{props.___BLANK___}&lt;/p&gt;;<br>}', answer: 'title' },
                { type: 'mcq', question: 'Pass number prop?', options: ['num="5"', 'num={5}', 'num=(5)', 'num:5'], correct: 1 },
                { type: 'fill', question: 'Destructure props', code: 'function Card(___BLANK___name, age}) {<br>  return &lt;p&gt;{name}&lt;/p&gt;;<br>}', answer: '{' },
                { type: 'mcq', question: 'Can you modify props?', options: ['Yes', 'No', 'Sometimes', 'Only numbers'], correct: 1 },
                { type: 'fill', question: 'Pass string prop', code: '&lt;Card title___BLANK___"Hello" /&gt;', answer: '=' }
            ]
        },
        course3: {
            learn: [
                { bot: 'State makes components dynamic! 🔄' },
                { bot: 'Import <span class="keyword-highlight">useState</span>:<br><div class="code-example"><code>import { useState } from "react";</code></div>' },
                { bot: 'Create state:<br><div class="code-example"><code>const [count, setCount] = useState(0);<br>// count = current value<br>// setCount = update function<br>// 0 = initial value</code></div>' },
                { bot: 'Update state:<br><div class="code-example"><code>function Counter() {<br>  const [count, setCount] = useState(0);<br>  <br>  return (<br>    &lt;button onClick={() => setCount(count + 1)}&gt;<br>      Clicks: {count}<br>    &lt;/button&gt;<br>  );<br>}</code></div>' },
                { bot: 'State changes cause re-renders!' },
                { bot: 'Multiple state variables:<br><div class="code-example"><code>const [name, setName] = useState("");<br>const [age, setAge] = useState(0);<br>const [active, setActive] = useState(false);</code></div>' },
                { bot: 'State can be any type!' },
                { bot: '<strong>Never</strong> modify state directly - always use setter:<br><div class="code-example"><code>// Wrong ❌<br>count = count + 1;<br><br>// Correct ✅<br>setCount(count + 1);</code></div>' },
                { bot: '✅ State enables dynamic UIs!' }
            ],
            exercises: [
                { type: 'fill', question: 'Import useState', code: 'import { ___BLANK___ } from "react";', answer: 'useState' },
                { type: 'mcq', question: 'Update state?', options: ['setState', 'updateState', 'setCount', 'changeState'], correct: 2 },
                { type: 'fill', question: 'Create state', code: 'const [val, setVal] = ___BLANK___(0);', answer: 'useState' },
                { type: 'mcq', question: 'What happens when state changes?', options: ['Nothing', 'Component re-renders', 'Page reloads', 'Error'], correct: 1 },
                { type: 'fill', question: 'Update state', code: '___BLANK___(count + 1);', answer: 'setCount' }
            ]
        },
        course4: {
            learn: [
                { bot: 'Events handle user interactions! 🎯' },
                { bot: '<span class="keyword-highlight">onClick</span> is most common:<br><div class="code-example"><code>&lt;button onClick={handleClick}&gt;<br>  Click Me<br>&lt;/button&gt;</code></div>' },
                { bot: 'Define event handlers:<br><div class="code-example"><code>function App() {<br>  const handleClick = () => {<br>    alert("Clicked!");<br>  };<br>  <br>  return &lt;button onClick={handleClick}&gt;Click&lt;/button&gt;;<br>}</code></div>' },
                { bot: 'Or use inline:<br><div class="code-example"><code>&lt;button onClick={() => alert("Hi")}&gt;<br>  Click<br>&lt;/button&gt;</code></div>' },
                { bot: 'Handle input with <span class="keyword-highlight">onChange</span>:<br><div class="code-example"><code>function Form() {<br>  const [text, setText] = useState("");<br>  <br>  return (<br>    &lt;input <br>      value={text}<br>      onChange={(e) => setText(e.target.value)}<br>    /&gt;<br>  );<br>}</code></div>' },
                { bot: '<span class="keyword-highlight">Event object</span> properties:<br>- e.target: Triggered element<br>- e.target.value: Input value<br>- e.preventDefault(): Stop default' },
                { bot: 'Common events:<br>- onClick, onChange, onSubmit<br>- onMouseEnter, onKeyPress, onFocus' },
                { bot: '✅ Events make React interactive!' }
            ],
            exercises: [
                { type: 'fill', question: 'Add click handler', code: '&lt;button ___BLANK___={doSomething}&gt;', answer: 'onClick' },
                { type: 'mcq', question: 'Get input value in event?', options: ['e.value', 'e.target.value', 'e.input', 'e.getValue()'], correct: 1 },
                { type: 'fill', question: 'Handle input change', code: '&lt;input ___BLANK___={(e) => setText(e.target.value)} /&gt;', answer: 'onChange' },
                { type: 'mcq', question: 'Prevent default behavior?', options: ['e.stop()', 'e.preventDefault()', 'e.cancel()', 'e.block()'], correct: 1 },
                { type: 'fill', question: 'Handle form submit', code: '&lt;form ___BLANK___={handleSubmit}&gt;', answer: 'onSubmit' }
            ]
        },
        course5: {
            learn: [
                { bot: 'Conditional rendering shows different UI! 🔀' },
                { bot: 'Use <span class="keyword-highlight">if statements</span>:<br><div class="code-example"><code>function Greeting({isLoggedIn}) {<br>  if (isLoggedIn) {<br>    return &lt;h1&gt;Welcome back!&lt;/h1&gt;;<br>  }<br>  return &lt;h1&gt;Please log in&lt;/h1&gt;;<br>}</code></div>' },
                { bot: '<span class="keyword-highlight">Ternary operator</span> is shorter:<br><div class="code-example"><code>function App({isLoggedIn}) {<br>  return (<br>    &lt;div&gt;<br>      {isLoggedIn ? (<br>        &lt;Dashboard /&gt;<br>      ) : (<br>        &lt;Login /&gt;<br>      )}<br>    &lt;/div&gt;<br>  );<br>}</code></div>' },
                { bot: 'Logical <span class="keyword-highlight">&&</span> for simple conditions:<br><div class="code-example"><code>{hasError && &lt;ErrorMessage /&gt;}<br>{count > 0 && &lt;p&gt;Count: {count}&lt;/p&gt;}</code></div>' },
                { bot: 'If true, renders. If false, nothing renders!' },
                { bot: 'Conditionally set attributes:<br><div class="code-example"><code>&lt;button <br>  className={isActive ? "active" : "inactive"}<br>  disabled={!canSubmit}<br>&gt;<br>  Submit<br>&lt;/button&gt;</code></div>' },
                { bot: 'Combine multiple conditions:<br><div class="code-example"><code>{isLoggedIn && hasAccess && &lt;AdminPanel /&gt;}<br>{status === "loading" && &lt;Spinner /&gt;}<br>{error ? &lt;Error msg={error} /&gt; : &lt;Content /&gt;}</code></div>' },
                { bot: '✅ Conditionals create dynamic UIs!' }
            ],
            exercises: [
                { type: 'fill', question: 'Conditional with &&', code: '{isActive ___BLANK___ &lt;div&gt;Active&lt;/div&gt;}', answer: '&&' },
                { type: 'mcq', question: 'Ternary operator syntax?', options: ['if-else', '? :', '&&', '||'], correct: 1 },
                { type: 'fill', question: 'Map over array', code: '{items.___BLANK___(item => &lt;li&gt;{item}&lt;/li&gt;)}', answer: 'map' },
                { type: 'mcq', question: 'Required prop when rendering lists?', options: ['id', 'key', 'index', 'unique'], correct: 1 },
                { type: 'fill', question: 'Ternary condition', code: '{isReady ___BLANK___ &lt;Start /&gt; : &lt;Wait /&gt;}', answer: '?' }
            ]
        },
        course6: {
            learn: [
                { bot: 'Lists display multiple items! 📋 Perfect for dynamic content.' },
                { bot: 'Use <span class="keyword-highlight">.map()</span> to render arrays:<br><div class="code-example"><code>const fruits = ["apple", "banana", "orange"];<br><br>return (<br>  &lt;ul&gt;<br>    {fruits.map((fruit, index) => (<br>      &lt;li key={index}&gt;{fruit}&lt;/li&gt;<br>    ))}<br>  &lt;/ul&gt;<br>);</code></div>' },
                { bot: 'Always add <span class="keyword-highlight">key</span> prop - helps React track items!' },
                { bot: 'Render array of objects:<br><div class="code-example"><code>const users = [<br>  { id: 1, name: "Alice" },<br>  { id: 2, name: "Bob" }<br>];<br><br>return (<br>  &lt;div&gt;<br>    {users.map(user => (<br>      &lt;p key={user.id}&gt;{user.name}&lt;/p&gt;<br>    ))}<br>  &lt;/div&gt;<br>);</code></div>' },
                { bot: 'Use unique IDs for keys, not array indices when possible!' },
                { bot: 'Filter arrays before mapping:<br><div class="code-example"><code>const activeUsers = users.filter(u => u.active);<br><br>return (<br>  &lt;div&gt;<br>    {activeUsers.map(user => (<br>      &lt;Card key={user.id} data={user} /&gt;<br>    ))}<br>  &lt;/div&gt;<br>);</code></div>' },
                { bot: 'Combine map with conditional rendering:<br><div class="code-example"><code>{items.length > 0 ? (<br>  items.map(item => &lt;div key={item.id}&gt;{item.name}&lt;/div&gt;)<br>) : (<br>  &lt;p&gt;No items&lt;/p&gt;<br>)}</code></div>' },
                { bot: 'Extract list items into separate components for cleaner code!' },
                { bot: '✅ Lists are essential for dynamic data!' }
            ],
            exercises: [
                { type: 'fill', question: 'Render array items', code: '{items.___BLANK___(item => &lt;div&gt;{item}&lt;/div&gt;)}', answer: 'map' },
                { type: 'mcq', question: 'Required for list items?', options: ['id', 'key', 'index', 'name'], correct: 1 },
                { type: 'fill', question: 'Add key to list item', code: '&lt;li ___BLANK___={item.id}&gt;{item.name}&lt;/li&gt;', answer: 'key' },
                { type: 'mcq', question: 'Filter items before rendering?', options: ['.filter()', '.select()', '.where()', '.get()'], correct: 0 },
                { type: 'fill', question: 'Map with index', code: '{arr.map((item, ___BLANK___) => ...)}', answer: 'index' }
            ]
        },
        course7: {
            learn: [
                { bot: 'useEffect runs code after render! 🪝 Perfect for side effects.' },
                { bot: 'Import useEffect:<br><div class="code-example"><code>import { useState, useEffect } from "react";</code></div>' },
                { bot: 'Basic useEffect runs after every render:<br><div class="code-example"><code>useEffect(() => {<br>  console.log("Component rendered!");<br>});</code></div>' },
                { bot: 'Add <span class="keyword-highlight">dependency array</span> to control when it runs:<br><div class="code-example"><code>useEffect(() => {<br>  console.log("Count changed!");<br>}, [count]);  // Only runs when count changes</code></div>' },
                { bot: 'Empty array [] runs only once (on mount):<br><div class="code-example"><code>useEffect(() => {<br>  console.log("Component mounted!");<br>}, []);</code></div>' },
                { bot: 'Fetch data with useEffect:<br><div class="code-example"><code>useEffect(() => {<br>  fetch("api.com/data")<br>    .then(res => res.json())<br>    .then(data => setData(data));<br>}, []);</code></div>' },
                { bot: '<span class="keyword-highlight">Cleanup function</span> runs before unmount:<br><div class="code-example"><code>useEffect(() => {<br>  const timer = setInterval(() => {}, 1000);<br>  return () => clearInterval(timer);<br>}, []);</code></div>' },
                { bot: 'Common use cases:<br>- Fetch data from APIs<br>- Set up subscriptions<br>- Manually change DOM<br>- Set up timers' },
                { bot: '✅ useEffect handles side effects perfectly!' }
            ],
            exercises: [
                { type: 'fill', question: 'Import useEffect', code: 'import { ___BLANK___ } from "react";', answer: 'useEffect' },
                { type: 'mcq', question: 'When does useEffect run with []?', options: ['Every render', 'Once on mount', 'Never', 'On unmount'], correct: 1 },
                { type: 'fill', question: 'Add dependency', code: 'useEffect(() => {}, ___BLANK___count]);', answer: '[' },
                { type: 'mcq', question: 'What does cleanup function do?', options: ['Deletes component', 'Runs before unmount', 'Cleans state', 'Resets props'], correct: 1 },
                { type: 'fill', question: 'Complete useEffect syntax', code: '___BLANK___(() => {});', answer: 'useEffect' }
            ]
        }
    }
};

let currentLesson = null;
let learnMessageIndex = 0;
let learnCompleted = false;
let selectedMCQ = {};
let correctAnswers = 0;
let isRetryMode = false;

let currentVerificationCode = null;
let currentForgotEmail = null;

// ==================== NOTIFICATION SYSTEM ====================
function showNotification(message, type = 'info') {
    // Remove any existing notifications
    const existingNotif = document.querySelector('.notification-toast');
    if (existingNotif) {
        existingNotif.remove();
    }
    
    // Create notification element
    const notification = document.createElement('div');
    notification.className = `notification-toast notification-${type}`;
    
    // Set icon based on type
    let icon = 'ℹ️';
    if (type === 'success') icon = '✅';
    if (type === 'error') icon = '❌';
    if (type === 'warning') icon = '⚠️';
    
    notification.innerHTML = `
        <span class="notification-icon">${icon}</span>
        <span class="notification-message">${message}</span>
    `;
    
    // Add to page
    document.body.appendChild(notification);
    
    // Animate in
    setTimeout(() => notification.classList.add('show'), 10);
    
    // Auto remove after 4 seconds
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
    }, 4000);
}

function handleForgotPassword(event) {
    event.preventDefault();
    
    const email = document.getElementById('forgotEmail').value.trim().toLowerCase();
    const btn = document.getElementById('forgotBtn');
    
    if (!email) {
        showNotification('Please enter your email', 'error');
        return;
    }
    
    // Check if user exists
    const userDataStr = localStorage.getItem('user_' + email);
    
    if (!userDataStr) {
        showNotification('Email not found. Please sign up first!', 'error');
        return;
    }
    
    const userData = JSON.parse(userDataStr);
    
    btn.disabled = true;
    btn.textContent = 'Sending Code...';
    
    // Generate 6-digit verification code
    const verificationCode = Math.floor(100000 + Math.random() * 900000).toString();
    
    // Store verification data
    currentVerificationCode = verificationCode;
    currentForgotEmail = email;
    
    // Fetch EmailJS config and send email
    fetch('/api/email-config')
        .then(res => res.json())
        .then(config => {
            const templateParams = {
                to_email: email,
                to_name: userData.name || 'User',
                verification_code: verificationCode,
                user_name: userData.name || 'User'
            };
            
            return emailjs.send(
                config.EMAIL_SERVICE_ID,
                config.EMAIL_TEMPLATE_ID,
                templateParams,
                config.EMAIL_PUBLIC_KEY
            );
        })
        .then(() => {
            showNotification('✅ Verification code sent to ' + email, 'success');
            btn.disabled = false;
            btn.textContent = 'Send Code';
            
            // Switch to verify form
            setTimeout(() => {
                switchAuthTab('verify');
            }, 1500);
        })
        .catch((error) => {
            console.error('Email error:', error);
            showNotification('❌ Failed to send email. Please try again.', 'error');
            btn.disabled = false;
            btn.textContent = 'Send Code';
        });
}

// Step 1: Verify the code only
function verifyCodeOnly() {
    const inputs = document.querySelectorAll('.otp-input');
    const code = Array.from(inputs).map(input => input.value).join('');
    const btn = document.getElementById('verifyCodeBtn');
    
    if (code.length !== 6) {
        showAuthMessage('verifyMessage', 'Please enter all 6 digits!', 'error');
        return;
    }
    
    if (!currentVerificationCode || !currentForgotEmail) {
        showAuthMessage('verifyMessage', 'Session expired. Please request a new code.', 'error');
        setTimeout(() => switchAuthTab('forgot'), 2000);
        return;
    }
    
    if (code !== currentVerificationCode) {
        showAuthMessage('verifyMessage', '✗ Invalid verification code!', 'error');
        inputs.forEach(input => input.value = '');
        inputs[0].focus();
        return;
    }
    
    // Code is correct!
    showAuthMessage('verifyMessage', '✓ Code verified! Enter your new password below.', 'success');
    btn.disabled = true;
    inputs.forEach(input => input.disabled = true);
    
    // Show password step
    setTimeout(() => {
        document.getElementById('codeStep').style.display = 'none';
        document.getElementById('passwordStep').style.display = 'block';
        document.getElementById('newPassword').focus();
    }, 1500);
}

// Initialize OTP inputs with auto-focus
function initOTPInputs() {
    const inputs = document.querySelectorAll('.otp-input');
    
    inputs.forEach((input, index) => {
        // Auto-focus next input
        input.addEventListener('input', (e) => {
            if (e.target.value.length === 1 && index < inputs.length - 1) {
                inputs[index + 1].focus();
            }
        });
        
        // Handle backspace
        input.addEventListener('keydown', (e) => {
            if (e.key === 'Backspace' && !e.target.value && index > 0) {
                inputs[index - 1].focus();
            }
        });
        
        // Only allow numbers
        input.addEventListener('input', (e) => {
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });
        
        // Handle paste
        input.addEventListener('paste', (e) => {
            e.preventDefault();
            const pastedData = e.clipboardData.getData('text').slice(0, 6);
            const digits = pastedData.split('');
            digits.forEach((digit, i) => {
                if (inputs[i] && /[0-9]/.test(digit)) {
                    inputs[i].value = digit;
                }
            });
            if (digits.length === 6) {
                inputs[5].focus();
            }
        });
    });
}

// Step 2: Reset password
function handleVerifyCode(e) {
    e.preventDefault();
    
    const newPassword = document.getElementById('newPassword').value;
    const btn = document.getElementById('resetPasswordBtn');
    
    if (!newPassword || newPassword.length < 6) {
        alert('Password must be at least 6 characters!');
        return;
    }
    
    btn.disabled = true;
    btn.textContent = 'Resetting...';
    
    // Update password
    const userDataStr = localStorage.getItem('user_' + currentForgotEmail);
    const userData = JSON.parse(userDataStr);
    userData.password = newPassword;
    localStorage.setItem('user_' + currentForgotEmail, JSON.stringify(userData));
    
    alert('✓ Password reset successful! Please login with your new password.');
    
    // Clear verification data
    currentVerificationCode = null;
    currentForgotEmail = null;
    
    // Reset and go to login
    document.getElementById('verifyForm').reset();
    document.getElementById('codeStep').style.display = 'block';
    document.getElementById('passwordStep').style.display = 'none';
    document.querySelectorAll('.otp-input').forEach(input => input.disabled = false);
    btn.disabled = false;
    btn.textContent = 'Reset Password';
    
    switchAuthTab('login');
}

function switchAuthTab(tab) {
    const authTabs = document.querySelector('.auth-tabs');
    const allForms = document.querySelectorAll('.auth-form');
    
    // Clear all messages
    ['loginMessage', 'signupMessage', 'forgotMessage', 'verifyMessage'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.innerHTML = '';
    });
    
    // Hide all forms first
    allForms.forEach(f => f.classList.remove('active'));
    
    if (tab === 'login') {
        authTabs.style.display = 'flex';
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.auth-tab')[0].classList.add('active');
        document.getElementById('loginForm').classList.add('active');
    } else if (tab === 'signup') {
        authTabs.style.display = 'flex';
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.auth-tab')[1].classList.add('active');
        document.getElementById('signupForm').classList.add('active');
    } else if (tab === 'forgot') {
        authTabs.style.display = 'none';
        document.getElementById('forgotForm').classList.add('active');
    } else if (tab === 'verify') {
        authTabs.style.display = 'none';
        document.getElementById('verifyForm').classList.add('active');
        setTimeout(initOTPInputs, 100);
    }
}

function handleSignup(e) {
    e.preventDefault();
    
    const name = document.getElementById('signupName').value.trim();
    const email = document.getElementById('signupEmail').value.trim().toLowerCase();
    const password = document.getElementById('signupPassword').value;
    const btn = document.getElementById('signupBtn');
    
    const existingUser = localStorage.getItem('user_' + email);
    if (existingUser) {
        showAuthMessage('signupMessage', 'Account already exists! Please login.', 'error');
        return;
    }
    
    btn.disabled = true;
    btn.textContent = 'Signing up...';
    
    setTimeout(() => {
        const userData = {
            name: name,
            email: email,
            password: password,
            createdAt: new Date().toISOString()
        };
        
        localStorage.setItem('user_' + email, JSON.stringify(userData));
        
        showAuthMessage('signupMessage', 'Account created successfully! Logging you in...', 'success');
        btn.disabled = false;
        btn.textContent = 'Create Account';
        
        document.getElementById('signupForm').reset();
        
        setTimeout(() => {
            document.getElementById('loginEmail').value = email;
            switchAuthTab('login');
        }, 1500);
    }, 1000);
}

function handleLogin(e) {
    e.preventDefault();
    
    const email = document.getElementById('loginEmail').value.trim().toLowerCase();
    const password = document.getElementById('loginPassword').value;
    const btn = document.getElementById('loginBtn');
    
    const userDataStr = localStorage.getItem('user_' + email);
    
    if (!userDataStr) {
        showAuthMessage('loginMessage', 'Account doesn\'t exist. Please sign up!', 'error');
        return;
    }
    
    const userData = JSON.parse(userDataStr);
    
    if (userData.password !== password) {
        showAuthMessage('loginMessage', 'Incorrect password. Try again!', 'error');
        return;
    }
    
    btn.disabled = true;
    btn.textContent = 'Logging in...';
    
    setTimeout(() => {
        localStorage.setItem('currentUser', email);
        currentUser = email;
        initializeApp();
    }, 1000);
}

function showAuthMessage(elementId, message, type) {
    const msgEl = document.getElementById(elementId);
    msgEl.innerHTML = `<div class="auth-message ${type}">${message}</div>`;
}

function initializeApp() {
    document.getElementById('authScreen').style.display = 'none';
    
    const savedProgress = localStorage.getItem('progress_' + currentUser);
    if (savedProgress) {
        const loadedProgress = JSON.parse(savedProgress);
        
        Object.keys(userProgress).forEach(lang => {
            Object.keys(userProgress[lang]).forEach(courseId => {
                if (loadedProgress[lang] && loadedProgress[lang][courseId]) {
                    userProgress[lang][courseId] = loadedProgress[lang][courseId];
                }
            });
        });
        
        localStorage.setItem('progress_' + currentUser, JSON.stringify(userProgress));
        soundEnabled = localStorage.getItem('soundEnabled') !== 'false';
    }
    
    const savedTime = localStorage.getItem('studyTime_' + currentUser);
    if (savedTime) {
        totalStudyTime = parseInt(savedTime);
    }
    
    const userData = JSON.parse(localStorage.getItem('user_' + currentUser));
    if (userData) {
        const firstName = userData.name.split(' ')[0];
        document.getElementById('userName').textContent = firstName;
        document.getElementById('userEmail').textContent = userData.email;
        document.getElementById('userAvatar').textContent = firstName.charAt(0).toUpperCase();
    }
    
    renderCourses();
    updateDashboard();
    checkStreakStatus();
    
    // Check for updates - will show splash for new users after 0.3s
    checkForUpdates();
}

function logout() {
    document.getElementById('logoutModal').classList.add('active');
}

function closeLogoutModal() {
    document.getElementById('logoutModal').classList.remove('active');
}

function confirmLogout() {
    localStorage.removeItem('currentUser');
    location.reload();
}

function checkStreakStatus() {
    const today = new Date().toDateString();
    const lastActivity = localStorage.getItem('lastActivity_' + currentUser);
    const currentStreak = parseInt(localStorage.getItem('streak_' + currentUser) || '0');
    
    if (lastActivity && currentStreak > 0) {
        const lastDate = new Date(lastActivity);
        const todayDate = new Date(today);
        const diffTime = todayDate - lastDate;
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        
        if (diffDays > 1) {
            // Streak broken - reset to 0
            const brokenStreak = currentStreak;
            localStorage.setItem('streak_' + currentUser, '0');
            
            // Show broken streak message
            setTimeout(() => {
                const modal = document.createElement('div');
                modal.className = 'streak-broken-modal';
                modal.innerHTML = `
                    <div class="streak-broken-content">
                        <div class="streak-broken-icon">💔</div>
                        <h2 class="streak-broken-title">Streak Broken!</h2>
                        <p class="streak-broken-text">You had a ${brokenStreak} day streak.</p>
                        <p class="streak-broken-encourage">Complete a lesson today to start fresh!</p>
                        <button class="close-broken-btn" onclick="this.closest('.streak-broken-modal').remove()">Continue</button>
                    </div>
                `;
                document.body.appendChild(modal);
                setTimeout(() => modal.classList.add('active'), 100);
            }, 1000);
        }
    }
}

function checkAuth() {
    const savedUser = localStorage.getItem('currentUser');
    if (savedUser) {
        currentUser = savedUser;
        initializeApp();
    } else {
        document.getElementById('authScreen').style.display = 'flex';
    }
}

window.addEventListener('DOMContentLoaded', () => {
    checkAuth();
    
    const codeEditor = document.getElementById('codeEditor');
    const detectedLangSpan = document.getElementById('detectedLang');
    
    if (codeEditor && detectedLangSpan) {
        codeEditor.addEventListener('input', () => {
            const language = detectLanguage(codeEditor.value);
            detectedLangSpan.textContent = language;
            
            if (language === 'None' || language === 'Unknown') {
                detectedLangSpan.style.color = '#8b949e';
            } else {
                detectedLangSpan.style.color = '#64ffda';
            }
        });
    }
});

window.addEventListener('resize', () => {
    if (window.innerWidth <= 768) {
        createMobileStatsCarousel();
        updateMobileStatsCarousel();
    }
});

function toggleTheme() {
    document.body.classList.toggle('light-mode');
    document.documentElement.classList.toggle('light-mode');
    const toggle = document.getElementById('themeToggle');
    toggle.classList.toggle('active');
}

function toggleSearch() {
    const container = document.getElementById('navContainer');
    const tabs = document.getElementById('navTabs');
    const searchContainer = document.getElementById('searchContainer');
    const searchInput = document.getElementById('searchInput');
    
    if (container.classList.contains('search-active')) {
        // Closing search - faster
        searchContainer.classList.remove('active');
        document.getElementById('searchResults').classList.remove('active');
        searchInput.value = '';
        
        // Wait for search to fade out (reduced time)
        setTimeout(() => {
            container.classList.remove('search-active');
            tabs.style.opacity = '0';
            tabs.style.display = 'flex';
            tabs.classList.remove('show-tabs');
            
            // Trigger reflow to restart animation
            void tabs.offsetWidth;
            
            // Fade in tabs with animation
            setTimeout(() => {
                tabs.classList.add('show-tabs');
                tabs.style.transition = 'opacity 0.3s ease';
                tabs.style.opacity = '1';
            }, 30);
        }, 200); // Reduced from 300ms
    } else {
        // Opening search - faster
        tabs.style.transition = 'opacity 0.2s ease';
        tabs.style.opacity = '0';
        
        setTimeout(() => {
            container.classList.add('search-active');
            tabs.style.display = 'none';
            
            setTimeout(() => {
                searchContainer.classList.add('active');
                searchInput.focus();
            }, 50);
        }, 200); // Reduced from 300ms
    }
}

function toggleMobileSearch() {
    document.getElementById('mobileSearchOverlay').classList.add('active');
    document.getElementById('mobileSearchContainer').classList.add('active');
    setTimeout(() => {
        document.getElementById('mobileSearchInput').focus();
    }, 400);
}

function closeMobileSearch() {
    document.getElementById('mobileSearchOverlay').classList.remove('active');
    document.getElementById('mobileSearchContainer').classList.remove('active');
    document.getElementById('mobileSearchInput').value = '';
    document.getElementById('mobileSearchResults').innerHTML = '';
}

function handleSearch() {
    const query = document.getElementById('searchInput').value.toLowerCase();
    const results = document.getElementById('searchResults');
    
    if (!query) {
        results.classList.remove('active');
        return;
    }
    
    const matches = [];
    Object.keys(courses).forEach(lang => {
        courses[lang].forEach((course, index) => {
            if (course.title.toLowerCase().includes(query) || 
                course.desc.toLowerCase().includes(query) ||
                lang.includes(query)) {
                
                const isLocked = index > 0 && !userProgress[lang]['course' + index]?.completed;
                const isCompleted = userProgress[lang][course.id]?.completed;
                
                matches.push({
                    lang,
                    course,
                    langName: lang.charAt(0).toUpperCase() + lang.slice(1),
                    isLocked,
                    isCompleted,
                    index
                });
            }
        });
    });
    
    if (matches.length > 0) {
        results.innerHTML = matches.map(m => {
            let statusBadge = '';
            let clickable = !m.isLocked;
            
            if (m.isCompleted) {
                statusBadge = '<span style="color: #00ff00; margin-left: 8px;">✓ Completed</span>';
            } else if (m.isLocked) {
                statusBadge = '<span style="color: #ff6b6b; margin-left: 8px;">🔒 Locked</span>';
            } else {
                statusBadge = '<span style="color: #64ffda; margin-left: 8px;">📖 Available</span>';
            }
            
            const onClick = clickable 
                ? `onclick="openCourseFromSearch('${m.lang}', '${m.course.id}', '${m.course.title}')"` 
                : `style="opacity: 0.5; cursor: not-allowed;"`;
            
            return `
                <div class="search-result-item" ${onClick}>
                    <div class="search-result-title">${m.course.icon} ${m.course.title}${statusBadge}</div>
                    <div class="search-result-desc">${m.langName} • ${m.course.desc}</div>
                </div>
            `;
        }).join('');
        results.classList.add('active');
    } else {
        results.innerHTML = '<div class="search-result-item">No courses found</div>';
        results.classList.add('active');
    }
}

function handleMobileSearch() {
    const query = document.getElementById('mobileSearchInput').value.toLowerCase();
    const results = document.getElementById('mobileSearchResults');
    
    if (!query) {
        results.innerHTML = '';
        return;
    }
    
    const matches = [];
    Object.keys(courses).forEach(lang => {
        courses[lang].forEach((course, index) => {
            if (course.title.toLowerCase().includes(query) || 
                course.desc.toLowerCase().includes(query) ||
                lang.includes(query)) {
                
                const isLocked = index > 0 && !userProgress[lang]['course' + index]?.completed;
                const isCompleted = userProgress[lang][course.id]?.completed;
                
                matches.push({
                    lang,
                    course,
                    langName: lang.charAt(0).toUpperCase() + lang.slice(1),
                    isLocked,
                    isCompleted,
                    index
                });
            }
        });
    });
    
    if (matches.length > 0) {
        results.innerHTML = matches.map(m => {
            let statusBadge = '';
            let clickable = !m.isLocked;
            
            if (m.isCompleted) {
                statusBadge = '<span style="color: #00ff00; margin-left: 8px;">✓ Completed</span>';
            } else if (m.isLocked) {
                statusBadge = '<span style="color: #ff6b6b; margin-left: 8px;">🔒 Locked</span>';
            } else {
                statusBadge = '<span style="color: #64ffda; margin-left: 8px;">📖 Available</span>';
            }
            
            const onClick = clickable 
                ? `onclick="openCourseFromSearch('${m.lang}', '${m.course.id}', '${m.course.title}'); closeMobileSearch();"` 
                : `style="opacity: 0.5; cursor: not-allowed;"`;
            
            return `
                <div class="search-result-item" ${onClick}>
                    <div class="search-result-title">${m.course.icon} ${m.course.title}${statusBadge}</div>
                    <div class="search-result-desc">${m.langName} • ${m.course.desc}</div>
                </div>
            `;
        }).join('');
    } else {
        results.innerHTML = '<div class="search-result-item">No courses found</div>';
    }
}

function openCourseFromSearch(lang, courseId, courseName) {
    const courseIndex = courses[lang].findIndex(c => c.id === courseId);
    const isLocked = courseIndex > 0 && !userProgress[lang]['course' + courseIndex]?.completed;
    
    if (isLocked) {
        alert('🔒 This course is locked! Complete the previous course to unlock it.');
        return;
    }
    
    toggleSearch();
    showSection('learn');
    switchLanguage(lang);
    
    const isCompleted = userProgress[lang][courseId]?.completed;
    
    if (isCompleted) {
        showRetryModal(lang, courseId, courseName);
    } else {
        openLesson(lang, courseId, courseName);
    }
}

function showSection(sectionId) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
    document.getElementById(sectionId).classList.add('active');
    
    const activeTab = Array.from(document.querySelectorAll('.nav-tab')).find(
        tab => tab.textContent.toLowerCase().includes(sectionId === 'home' ? 'overview' : sectionId)
    );
    if (activeTab) activeTab.classList.add('active');
    
    if (sectionId === 'home') {
        updateDashboard();
    }
}

function showSectionMobile(sectionId, element) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.mobile-nav-item').forEach(i => i.classList.remove('active'));
    document.getElementById(sectionId).classList.add('active');
    element.classList.add('active');
    
    if (sectionId === 'home') {
        updateDashboard();
    }
}

function switchLanguage(lang) {
    document.querySelectorAll('.language-tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.language-content').forEach(c => c.classList.remove('active'));
    event.target.classList.add('active');
    document.getElementById(lang + '-content').classList.add('active');
}

function switchChart(type) {
    document.querySelectorAll('.chart-tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.chart-container').forEach(c => c.classList.remove('active'));
    event.target.classList.add('active');
    document.getElementById(type + 'Chart').classList.add('active');
    updateCharts();
}

function renderCourses() {
    // Check if user has seen new courses
    const newCoursesSeenDate = localStorage.getItem('newCoursesSeen_' + currentUser);
    const now = new Date().getTime();
    const oneDayMs = 24 * 60 * 60 * 1000;
    const shouldShowNew = !newCoursesSeenDate || (now - parseInt(newCoursesSeenDate)) < oneDayMs;
    
    // Mark that user has seen new courses (first time only)
    if (!newCoursesSeenDate) {
        localStorage.setItem('newCoursesSeen_' + currentUser, now.toString());
    }
    
    Object.keys(courses).forEach(lang => {
        const container = document.getElementById(lang + '-courses');
        container.innerHTML = '';
        
        courses[lang].forEach((course, index) => {
            const isLocked = index > 0 && !userProgress[lang]['course' + index]?.completed;
            const isCompleted = userProgress[lang][course.id]?.completed;
            const progress = userProgress[lang][course.id]?.progress || 0;
            const isNew = course.isNew && shouldShowNew;
            
            const card = document.createElement('div');
            card.className = 'course-card' + (isLocked ? ' locked' : '');
            card.innerHTML = `
                ${isNew ? '<div class="new-badge">✨ NEW</div>' : ''}
                ${isLocked ? '<div class="lock-overlay">🔒 Complete previous</div>' : ''}
                ${isCompleted ? '<div class="completed-badge">✓ Completed</div>' : ''}
                <div class="course-header">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">${course.icon}</div>
                    <div class="course-title">${course.title}</div>
                    <div class="course-desc">${course.desc}</div>
                </div>
                <div class="course-progress-bar">
                    <div class="course-progress-header">
                        <span class="course-progress-name">Progress</span>
                        <span class="course-progress-percent">${progress}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                </div>
            `;
            
            if (!isLocked) {
                card.onclick = () => {
                    if (isCompleted) {
                        showRetryModal(lang, course.id, course.title);
                    } else {
                        openLesson(lang, course.id, course.title);
                    }
                };
            }
            
            container.appendChild(card);
        });
    });
}

function showRetryModal(language, courseId, courseName) {
    pendingLesson = { language, courseId, courseName };
    document.getElementById('retryModal').classList.add('active');
}

function closeModal() {
    document.getElementById('retryModal').classList.remove('active');
    pendingLesson = null;
}

function retryLesson() {
    if (!pendingLesson) return;
    isRetryMode = true;
    const { language, courseId, courseName } = pendingLesson;
    closeModal();
    
    setTimeout(() => {
        openLesson(language, courseId, courseName);
    }, 300);
}

function openLesson(language, courseId, courseName) {
    currentLesson = { language, courseId, courseName };
    learnCompleted = false;
    learnMessageIndex = 0;
    correctAnswers = 0;
    selectedMCQ = {};
    
    studyStartTime = Date.now();
    if (timerInterval) clearInterval(timerInterval);
    timerInterval = setInterval(updateTimer, 1000);
    
    document.getElementById('lessonTitle').textContent = courseName;
    document.getElementById('lessonView').classList.add('active');
    document.getElementById('learnMessages').innerHTML = '';
    document.getElementById('questionMessages').innerHTML = '';
    
    document.getElementById('questionsTabBtn').disabled = true;
    document.getElementById('questionsTabBtn').innerHTML = 'Questions 🔒';
    
    switchPanel('learn');
    updateLessonProgress();
    displayNextLearnMessage();
}

function closeLesson() {
    if (studyStartTime && currentLesson && !isRetryMode) {
        const sessionTime = Math.floor((Date.now() - studyStartTime) / 1000);
        userProgress[currentLesson.language][currentLesson.courseId].time += sessionTime;
        totalStudyTime += sessionTime;
        
        localStorage.setItem('progress_' + currentUser, JSON.stringify(userProgress));
        localStorage.setItem('studyTime_' + currentUser, totalStudyTime.toString());
    }
    if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
    }
    studyStartTime = null;
    isRetryMode = false;
    
    document.getElementById('lessonView').classList.remove('active');
    currentLesson = null;
    renderCourses();
    updateDashboard();
}

function updateTimer() {
    if (!studyStartTime) return;
    const elapsed = Math.floor((Date.now() - studyStartTime) / 1000) + totalStudyTime;
    const hours = Math.floor(elapsed / 3600);
    const minutes = Math.floor((elapsed % 3600) / 60);
    document.getElementById('totalTime').textContent = `${hours}h ${minutes}m`;
}

function switchPanel(panel) {
    if (panel === 'questions' && !learnCompleted) return;
    
    document.querySelectorAll('.tab-switch-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.content-panel').forEach(p => p.classList.remove('active'));
    
    if (panel === 'learn') {
        document.getElementById('learnTabBtn').classList.add('active');
        document.getElementById('learnPanel').classList.add('active');
    } else {
        document.getElementById('questionsTabBtn').classList.add('active');
        document.getElementById('questionsPanel').classList.add('active');
        if (document.getElementById('questionMessages').children.length === 0) {
            displayQuestions();
        }
    }
}

async function displayNextLearnMessage() {
    if (!currentLesson || !currentLesson.language || !currentLesson.courseId) {
        console.warn('currentLesson is not properly set:', currentLesson);
        return;
    }

    const content = lessonContent[currentLesson.language]?.[currentLesson.courseId];
    if (!content) {
        console.warn('Lesson content not found for:', currentLesson);
        return;
    }

    const learnMessages = document.getElementById('learnMessages');
    if (!learnMessages) {
        console.warn('Element with id "learnMessages" not found in the DOM.');
        return;
    }

    if (learnMessageIndex >= content.learn.length) {
        learnCompleted = true;
        const questionsBtn = document.getElementById('questionsTabBtn');
        if (questionsBtn) {
            questionsBtn.disabled = false;
            questionsBtn.innerHTML = 'Questions ✓';
        }

        const unlockMsg = document.createElement('div');
        unlockMsg.className = 'message';
        unlockMsg.innerHTML = `
            <div class="message-avatar">🤖</div>
            <div class="message-bubble">
                ✅ Learning complete! Switch to <strong>Questions</strong> tab to test yourself!
            </div>
        `;
        learnMessages.appendChild(unlockMsg);
        learnMessages.scrollTop = learnMessages.scrollHeight;
        return;
    }

    const typingDiv = document.createElement('div');
    typingDiv.className = 'message';
    typingDiv.innerHTML = `
        <div class="message-avatar">🤖</div>
        <div class="message-bubble">
            <div class="typing-indicator">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>
    `;
    learnMessages.appendChild(typingDiv);
    learnMessages.scrollTop = learnMessages.scrollHeight;

    setTimeout(async () => {
        typingDiv.remove();

        const msg = content.learn[learnMessageIndex];
        if (!msg || !msg.bot) {
            console.warn('Message content missing at index', learnMessageIndex);
            learnMessageIndex++;
            return;
        }

        const highlightedContent = await highlightKeywords(msg.bot);

        const messageDiv = document.createElement('div');
        messageDiv.className = 'message';
        messageDiv.style.opacity = '0';
        messageDiv.style.transform = 'translateY(10px)';
        messageDiv.innerHTML = `
            <div class="message-avatar">🤖</div>
            <div class="message-bubble">${highlightedContent}</div>
        `;
        learnMessages.appendChild(messageDiv);
        
        learnMessages.scrollTop = learnMessages.scrollHeight;
        
        requestAnimationFrame(() => {
            messageDiv.style.transition = 'all 0.4s ease';
            messageDiv.style.opacity = '1';
            messageDiv.style.transform = 'translateY(0)';
        });

        learnMessageIndex++;
        updateLessonProgress();

        if (learnMessageIndex < content.learn.length) {
            setTimeout(displayNextLearnMessage, 600);
        } else {
            learnCompleted = true;
            const questionsBtn = document.getElementById('questionsTabBtn');
            if (questionsBtn) {
                questionsBtn.disabled = false;
                questionsBtn.innerHTML = 'Questions ✓';
            }

            const unlockMsg = document.createElement('div');
            unlockMsg.className = 'message';
            unlockMsg.style.opacity = '0';
            unlockMsg.style.transform = 'translateY(10px)';
            unlockMsg.innerHTML = `
                <div class="message-avatar">🤖</div>
                <div class="message-bubble">
                    ✅ Learning complete! Switch to <strong>Questions</strong> tab to test yourself!
                </div>
            `;
            learnMessages.appendChild(unlockMsg);
            learnMessages.scrollTop = learnMessages.scrollHeight;
            
            requestAnimationFrame(() => {
                unlockMsg.style.transition = 'all 0.4s ease';
                unlockMsg.style.opacity = '1';
                unlockMsg.style.transform = 'translateY(0)';
            });
        }
    }, 800);
}

function updateLessonProgress() {
    const content = lessonContent[currentLesson.language]?.[currentLesson.courseId];
    if (!content) return;
    
    const totalSteps = content.learn.length + content.exercises.length;
    const completedSteps = learnMessageIndex + correctAnswers;
    const progress = Math.round((completedSteps / totalSteps) * 100);
    
    document.getElementById('lessonProgressText').textContent = `${progress}% Complete`;
    
    if (!isRetryMode) {
        userProgress[currentLesson.language][currentLesson.courseId].progress = progress;
        localStorage.setItem('progress_' + currentUser, JSON.stringify(userProgress));
    }
}

function displayQuestions() {
    const content = lessonContent[currentLesson.language]?.[currentLesson.courseId];
    if (!content) return;
    
    const questionMessages = document.getElementById('questionMessages');
    
    const welcomeDiv = document.createElement('div');
    welcomeDiv.className = 'message';
    welcomeDiv.innerHTML = `
        <div class="message-avatar">🤖</div>
        <div class="message-bubble">🎯 Test your knowledge!</div>
    `;
    questionMessages.appendChild(welcomeDiv);
    
    content.exercises.forEach((exercise, index) => {
        const exerciseDiv = document.createElement('div');
        exerciseDiv.className = 'message';
        
        if (exercise.type === 'fill') {
            const codeWithBlanks = exercise.code.replace(/___BLANK___/g, 
                `<span class="code-blank-wrapper"><input type="text" class="code-blank" data-index="${index}" placeholder="____"></span>`);
            
            exerciseDiv.innerHTML = `
                <div class="message-avatar">🤖</div>
                <div class="message-bubble">
                    <div class="exercise-box">
                        <div class="exercise-title">✏️ ${exercise.question}</div>
                        <div class="code-fill">${codeWithBlanks}</div>
                        <button class="submit-button" onclick="checkFillAnswer(${index}, '${exercise.answer}')">Check</button>
                        <div id="feedback-${index}"></div>
                    </div>
                </div>
            `;
        } else if (exercise.type === 'mcq') {
            let optionsHTML = exercise.options.map((opt, i) => 
                `<div class="mcq-option" onclick="selectOption(this, ${index}, ${i})">${opt}</div>`
            ).join('');
            
            exerciseDiv.innerHTML = `
                <div class="message-avatar">🤖</div>
                <div class="message-bubble">
                    <div class="exercise-box">
                        <div class="exercise-title">❓ ${exercise.question}</div>
                        <div class="mcq-options" data-correct="${exercise.correct}" data-exercise="${index}">
                            ${optionsHTML}
                        </div>
                        <button class="submit-button" onclick="checkMCQAnswer(${index})">Check</button>
                        <div id="feedback-${index}"></div>
                    </div>
                </div>
            `;
        }
        
        questionMessages.appendChild(exerciseDiv);
    });
}

function selectOption(element, exerciseIndex, optionIndex) {
    element.parentElement.querySelectorAll('.mcq-option').forEach(opt => opt.classList.remove('selected'));
    element.classList.add('selected');
    selectedMCQ[exerciseIndex] = optionIndex;
}

function checkMCQAnswer(exerciseIndex) {
    const content = lessonContent[currentLesson.language][currentLesson.courseId];
    const exercise = content.exercises[exerciseIndex];
    const selected = selectedMCQ[exerciseIndex];
    const feedbackDiv = document.getElementById('feedback-' + exerciseIndex);
    const optionsContainer = document.querySelector(`.mcq-options[data-exercise="${exerciseIndex}"]`);
    const options = optionsContainer.querySelectorAll('.mcq-option');
    const submitBtn = optionsContainer.closest('.exercise-box').querySelector('.submit-button');
    
    if (selected === undefined) {
        feedbackDiv.innerHTML = '<div class="feedback incorrect">Select an answer!</div>';
        return;
    }
    
    if (selected === exercise.correct) {
        options[selected].classList.add('correct');
        options.forEach(opt => {
            opt.style.pointerEvents = 'none';
            opt.style.cursor = 'not-allowed';
            opt.style.opacity = '0.7';
        });
        submitBtn.disabled = true;
        submitBtn.style.opacity = '0.5';
        submitBtn.style.cursor = 'not-allowed';
        feedbackDiv.innerHTML = '<div class="feedback correct">✅ Correct!</div>';
        correctAnswers++;
        updateLessonProgress();
        checkCompletion();
    } else {
        options[selected].classList.add('incorrect');
        options[exercise.correct].classList.add('correct');
        feedbackDiv.innerHTML = '<div class="feedback incorrect">❌ Try again!</div>';
        setTimeout(() => {
            options[selected].classList.remove('incorrect', 'selected');
            options[exercise.correct].classList.remove('correct');
            selectedMCQ[exerciseIndex] = undefined;
        }, 1500);
    }
}

function checkFillAnswer(exerciseIndex, correctAnswer) {
    const blank = document.querySelector(`.code-blank[data-index="${exerciseIndex}"]`);
    const wrapper = blank.parentElement;
    const userAnswer = blank.value.trim();
    const feedbackDiv = document.getElementById('feedback-' + exerciseIndex);
    const submitBtn = wrapper.closest('.exercise-box').querySelector('.submit-button');
    
    if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
        wrapper.classList.remove('incorrect');
        wrapper.classList.add('correct');
        blank.disabled = true;
        blank.style.cursor = 'not-allowed';
        submitBtn.disabled = true;
        submitBtn.style.opacity = '0.5';
        submitBtn.style.cursor = 'not-allowed';
        feedbackDiv.innerHTML = '<div class="feedback correct">✅ Correct!</div>';
        correctAnswers++;
        updateLessonProgress();
        checkCompletion();
    } else {
        wrapper.classList.remove('correct');
        wrapper.classList.add('incorrect');
        feedbackDiv.innerHTML = '<div class="feedback incorrect">❌ Wrong! Answer: ' + correctAnswer + '</div>';
        setTimeout(() => {
            wrapper.classList.remove('incorrect');
            blank.value = '';
        }, 500);
    }
}

function checkCompletion() {
    const content = lessonContent[currentLesson.language][currentLesson.courseId];
    if (correctAnswers >= content.exercises.length) {
        const questionMessages = document.getElementById('questionMessages');
        
        const completeMsg = document.createElement('div');
        completeMsg.className = 'message';
        completeMsg.innerHTML = `
            <div class="message-avatar">🤖</div>
            <div class="message-bubble">
                🎉 Excellent work! You've mastered this lesson!
                <button class="next-button" onclick="completeLesson()">Finish Lesson</button>
            </div>
        `;
        questionMessages.appendChild(completeMsg);
        questionMessages.scrollTop = questionMessages.scrollHeight;
    }
}

function completeLesson() {
    if (!isRetryMode) {
        userProgress[currentLesson.language][currentLesson.courseId].completed = true;
        userProgress[currentLesson.language][currentLesson.courseId].progress = 100;
        
        localStorage.setItem('progress_' + currentUser, JSON.stringify(userProgress));
        
        const today = new Date().toDateString();
        const lastActivity = localStorage.getItem('lastActivity_' + currentUser);
        const currentStreak = parseInt(localStorage.getItem('streak_' + currentUser) || '0');
        
        let newStreak = currentStreak;
        let showStreak = false;
        
        if (!lastActivity) {
            newStreak = 1;
            showStreak = true;
            localStorage.setItem('streak_' + currentUser, '1');
            localStorage.setItem('lastActivity_' + currentUser, today);
        } else if (lastActivity !== today) {
            const lastDate = new Date(lastActivity);
            const todayDate = new Date(today);
            const diffTime = todayDate - lastDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 1) {
                newStreak = currentStreak + 1;
                showStreak = true;
            } else if (diffDays > 1) {
                newStreak = 1;
                showStreak = false;
            }
            
            localStorage.setItem('streak_' + currentUser, newStreak.toString());
            localStorage.setItem('lastActivity_' + currentUser, today);
        }
        
        document.getElementById('lessonView').classList.remove('active');
        currentLesson = null;
        
        showSection('home');
        
        if (showStreak && newStreak > 0) {
            setTimeout(() => {
                showStreakCelebration(newStreak);
            }, 300);
        }
    } else {
        closeLesson();
    }
}

function showStreakCelebration(streakNumber) {
    const isMobile = window.innerWidth <= 768;
    
    if (isMobile) {
        // Mobile: Navigate to streak card in carousel FIRST
        showSection('home');
        
        setTimeout(() => {
            // Slide to streak card (index 2 - third card)
            goToStatsSlide(2);
            
            // Wait for carousel to settle
            setTimeout(() => {
                const statsCards = document.querySelectorAll('.stats-carousel-slide .stat-card');
                const streakCard = statsCards[2]; // Third card is streak
                
                if (!streakCard) return;
                
                // Get card position
                const rect = streakCard.getBoundingClientRect();
                const oldStreak = streakNumber - 1;
                
                // Create floating card clone
                const floatingCard = document.createElement('div');
                floatingCard.className = 'floating-streak-card';
                floatingCard.innerHTML = `
                    <div class="stat-icon">🔥</div>
                    <div class="stat-value" id="floatingStreakValue">${oldStreak}</div>
                    <div class="stat-label">Day Streak</div>
                `;
                
                floatingCard.style.cssText = `
                    position: fixed;
                    left: ${rect.left}px;
                    top: ${rect.top}px;
                    width: ${rect.width}px;
                    height: ${rect.height}px;
                    background: rgba(30, 30, 30, 0.95);
                    border: 2px solid rgba(100, 255, 218, 0.3);
                    border-radius: 20px;
                    padding: 30px;
                    z-index: 9999;
                    transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
                    box-shadow: 0 10px 40px rgba(100, 255, 218, 0.3);
                `;
                
                // Hide original card
                streakCard.style.opacity = '0';
                
                // Add to body
                document.body.appendChild(floatingCard);
                
                // Create overlay
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0);
                    z-index: 9998;
                    transition: background 0.5s ease;
                `;
                document.body.appendChild(overlay);
                
                // Animate to center
                setTimeout(() => {
                    overlay.style.background = 'rgba(0, 0, 0, 0.8)';
                    
                    const centerX = window.innerWidth / 2;
                    const centerY = window.innerHeight / 2;
                    
                    floatingCard.style.left = centerX + 'px';
                    floatingCard.style.top = centerY + 'px';
                    floatingCard.style.transform = 'translate(-50%, -50%) scale(1.2)';
                    floatingCard.style.boxShadow = '0 20px 60px rgba(100, 255, 218, 0.5)';
                }, 100);
                
                // Animate number change
                setTimeout(() => {
                    const valueElement = document.getElementById('floatingStreakValue');
                    
                    // Create number slide container
                    valueElement.style.position = 'relative';
                    valueElement.style.overflow = 'hidden';
                    valueElement.style.height = '60px';
                    
                    const numberContainer = document.createElement('div');
                    numberContainer.style.cssText = `
                        position: relative;
                        width: 100%;
                        height: 100%;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
                    `;
                    
                    const oldNumber = document.createElement('div');
                    oldNumber.textContent = oldStreak;
                    oldNumber.style.cssText = `
                        font-size: 2.5em;
                        color: #64ffda;
                        font-weight: 700;
                        min-height: 60px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    `;
                    
                    const newNumber = document.createElement('div');
                    newNumber.textContent = streakNumber;
                    newNumber.style.cssText = `
                        font-size: 2.5em;
                        color: #64ffda;
                        font-weight: 700;
                        min-height: 60px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        text-shadow: 0 0 30px rgba(100, 255, 218, 0.8);
                    `;
                    
                    numberContainer.appendChild(oldNumber);
                    numberContainer.appendChild(newNumber);
                    
                    valueElement.innerHTML = '';
                    valueElement.appendChild(numberContainer);
                    
                    // Slide animation
                    setTimeout(() => {
                        numberContainer.style.transform = 'translateY(-60px)';
                    }, 100);
                    
                    // Pulse card
                    setTimeout(() => {
                        floatingCard.style.transform = 'translate(-50%, -50%) scale(1.25)';
                    }, 300);
                    
                    setTimeout(() => {
                        floatingCard.style.transform = 'translate(-50%, -50%) scale(1.2)';
                    }, 600);
                    
                }, 1000);
                
                // Fly back to original position
                setTimeout(() => {
                    overlay.style.background = 'rgba(0, 0, 0, 0)';
                    floatingCard.style.left = rect.left + 'px';
                    floatingCard.style.top = rect.top + 'px';
                    floatingCard.style.transform = 'translate(0, 0) scale(1)';
                    floatingCard.style.boxShadow = '0 10px 40px rgba(100, 255, 218, 0.3)';
                }, 3000);
                
                // Clean up
                setTimeout(() => {
                    floatingCard.style.opacity = '0';
                    
                    setTimeout(() => {
                        floatingCard.remove();
                        overlay.remove();
                        streakCard.style.opacity = '1';
                        
                        // Update the actual streak value
                        document.getElementById('streakDays').textContent = streakNumber;
                        updateMobileStatsCarousel();
                    }, 500);
                }, 3500);
                
            }, 600);
        }, 300);
        
        return; // Exit early for mobile
    }
    
    // DESKTOP VERSION (keep existing desktop code below)
    const celebration = document.getElementById('streakCelebration');
    const card = celebration.querySelector('.streak-card-animated');
    const numberContainer = card.querySelector('.streak-number-container');
    
    const statCards = document.querySelectorAll('.stat-card');
    let streakCard = null;
    statCards.forEach(c => {
        if (c.textContent.includes('Day Streak')) {
            streakCard = c;
        }
    });
    
    if (!streakCard) return;
    
    streakCard.classList.add('animating');
    
    const rect = streakCard.getBoundingClientRect();
    const oldStreak = streakNumber - 1;
    
    const cardWidth = rect.width;
    const cardHeight = rect.height;
    card.style.width = cardWidth + 'px';
    card.style.height = cardHeight + 'px';
    
    numberContainer.innerHTML = `
        <div class="streak-number-big" style="transform: translateY(0); opacity: 1;">${oldStreak}</div>
    `;
    
    card.style.left = (rect.left + rect.width / 2) + 'px';
    card.style.top = (rect.top + rect.height / 2) + 'px';
    card.style.transform = 'translate(-50%, -50%) scale(1)';
    card.style.opacity = '1';
    
    celebration.style.display = 'flex';
    celebration.classList.add('active');
    
    setTimeout(() => {
        celebration.classList.add('show-bg');
        
        const centerX = window.innerWidth / 2;
        const centerY = window.innerHeight / 2;
        
        card.style.left = centerX + 'px';
        card.style.top = centerY + 'px';
        card.style.transform = 'translate(-50%, -50%) scale(1.15)';
        
        setTimeout(() => {
            numberContainer.innerHTML = `
                <div class="streak-number-big" style="transform: translateY(0); opacity: 0;">${oldStreak}</div>
                <div class="streak-number-big" style="transform: translateY(60px); opacity: 1;">${streakNumber}</div>
            `;
            
            setTimeout(() => {
                const numbers = numberContainer.querySelectorAll('.streak-number-big');
                numbers[0].style.transform = 'translateY(-60px)';
                numbers[0].style.opacity = '0';
                numbers[1].style.transform = 'translateY(0)';
                numbers[1].style.opacity = '1';
            }, 50);
        }, 800);
        
        setTimeout(() => {
            card.style.left = (rect.left + rect.width / 2) + 'px';
            card.style.top = (rect.top + rect.height / 2) + 'px';
            card.style.transform = 'translate(-50%, -50%) scale(1)';
            celebration.classList.remove('show-bg');
            
            setTimeout(() => {
                card.style.opacity = '0';
                
                setTimeout(() => {
                    celebration.classList.remove('active');
                    celebration.style.display = 'none';
                    
                    streakCard.classList.remove('animating');
                    
                    card.style.left = '';
                    card.style.top = '';
                    card.style.transform = '';
                    card.style.opacity = '';
                    card.style.width = '';
                    card.style.height = '';
                    
                    updateDashboard();
                    renderCourses();
                }, 500);
            }, 800);
        }, 2500);
        
    }, 500);
}

function updateDashboard() {
    let totalStarted = 0;
    let totalCompleted = 0;
    
    Object.keys(userProgress).forEach(lang => {
        Object.keys(userProgress[lang]).forEach(course => {
            if (userProgress[lang][course].progress > 0) totalStarted++;
            if (userProgress[lang][course].completed) totalCompleted++;
        });
    });
    
    document.getElementById('totalCourses').textContent = totalStarted;
    document.getElementById('completedLessons').textContent = totalCompleted;
    const currentStreak = parseInt(localStorage.getItem('streak_' + currentUser) || '0');
    document.getElementById('streakDays').textContent = currentStreak;
    
    const hours = Math.floor(totalStudyTime / 3600);
    const minutes = Math.floor((totalStudyTime % 3600) / 60);
    document.getElementById('totalTime').textContent = `${hours}h ${minutes}m`;
    
    updateCharts();
    
    // ADD THIS LINE:
    if (window.innerWidth <= 768) {
        createMobileStatsCarousel();
        updateMobileStatsCarousel();
    }
}

function updateCharts() {
    const allChart = document.getElementById('allBarChart');
    allChart.innerHTML = `
        <div class="chart-y-labels">
            <span>100%</span>
            <span>80%</span>
            <span>60%</span>
            <span>40%</span>
            <span>20%</span>
            <span>0%</span>
        </div>
    `;
    
    Object.keys(userProgress).forEach(lang => {
        const avgProgress = calculateAvgProgress(lang);
        const bar = createBarItem(lang.toUpperCase(), avgProgress);
        allChart.appendChild(bar);
    });
    
    Object.keys(userProgress).forEach(lang => {
        const chart = document.getElementById(lang + 'BarChart');
        chart.innerHTML = `
            <div class="chart-y-labels">
                <span>100%</span>
                <span>80%</span>
                <span>60%</span>
                <span>40%</span>
                <span>20%</span>
                <span>0%</span>
            </div>
        `;
        
        courses[lang].forEach(course => {
            const progress = userProgress[lang][course.id]?.progress || 0;
            const bar = createBarItem(course.title, progress);
            chart.appendChild(bar);
        });
    });
}

function createMobileStatsCarousel() {
    const isMobile = window.innerWidth <= 768;
    if (!isMobile) return;
    
    const dashboard = document.querySelector('.dashboard');
    if (!dashboard) return;
    
    // Check if carousel already exists
    if (document.querySelector('.mobile-stats-carousel')) return;
    
    const statsGrid = document.querySelector('.stats-grid');
    if (!statsGrid) return;
    
    // Create carousel
    const carousel = document.createElement('div');
    carousel.className = 'mobile-stats-carousel';
    carousel.innerHTML = `
        <div class="stats-carousel-track" id="statsCarouselTrack"></div>
        <div class="stats-carousel-dots" id="statsCarouselDots"></div>
    `;
    
    // Insert carousel before stats-grid
    statsGrid.parentNode.insertBefore(carousel, statsGrid);
    
    updateMobileStatsCarousel();
}

function updateMobileStatsCarousel() {
    const track = document.getElementById('statsCarouselTrack');
    const dots = document.getElementById('statsCarouselDots');
    
    if (!track || !dots) return;
    
    // Get all stat cards data
    const statsData = [
        {
            icon: '📚',
            value: document.getElementById('totalCourses').textContent,
            label: 'Courses Started'
        },
        {
            icon: '✅',
            value: document.getElementById('completedLessons').textContent,
            label: 'Lessons Completed'
        },
        {
            icon: '🔥',
            value: document.getElementById('streakDays').textContent,
            label: 'Day Streak'
        },
        {
            icon: '⏱️',
            value: document.getElementById('totalTime').textContent,
            label: 'Time Studied'
        }
    ];
    
    track.innerHTML = '';
    dots.innerHTML = '';
    
    statsData.forEach((stat, index) => {
        // Create slide
        const slide = document.createElement('div');
        slide.className = 'stats-carousel-slide';
        slide.innerHTML = `
            <div class="stat-card">
                <div class="stat-icon">${stat.icon}</div>
                <div class="stat-value">${stat.value}</div>
                <div class="stat-label">${stat.label}</div>
            </div>
        `;
        track.appendChild(slide);
        
        // Create dot
        const dot = document.createElement('div');
        dot.className = 'stats-carousel-dot' + (index === 0 ? ' active' : '');
        dot.onclick = () => goToStatsSlide(index);
        dots.appendChild(dot);
    });
    
    initStatsCarouselSwipe();
}

let currentStatsSlide = 0;
let statsStartX = 0;
let statsIsDragging = false;

function initStatsCarouselSwipe() {
    const track = document.getElementById('statsCarouselTrack');
    if (!track) return;
    
    track.addEventListener('touchstart', (e) => {
        statsStartX = e.touches[0].clientX;
        statsIsDragging = true;
    });
    
    track.addEventListener('touchmove', (e) => {
        if (!statsIsDragging) return;
        const currentX = e.touches[0].clientX;
        const diff = statsStartX - currentX;
        
        if (Math.abs(diff) > 10) {
            e.preventDefault();
        }
    });
    
    track.addEventListener('touchend', (e) => {
        if (!statsIsDragging) return;
        const endX = e.changedTouches[0].clientX;
        const diff = statsStartX - endX;
        
        if (Math.abs(diff) > 50) {
            if (diff > 0 && currentStatsSlide < 3) {
                goToStatsSlide(currentStatsSlide + 1);
            } else if (diff < 0 && currentStatsSlide > 0) {
                goToStatsSlide(currentStatsSlide - 1);
            }
        }
        
        statsIsDragging = false;
    });
}

function goToStatsSlide(index) {
    currentStatsSlide = index;
    const track = document.getElementById('statsCarouselTrack');
    const dots = document.querySelectorAll('.stats-carousel-dot');
    
    if (track) {
        track.style.transform = `translateX(-${index * 100}%)`;
    }
    
    dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
    });
}

function calculateAvgProgress(language) {
    const coursesList = Object.keys(userProgress[language]);
    const total = coursesList.reduce((sum, course) => {
        const progress = userProgress[language][course]?.progress || 0;
        return sum + progress;
    }, 0);
    return Math.round(total / coursesList.length);
}

function createBarItem(label, progress) {
    const div = document.createElement('div');
    div.className = 'bar-item';
    
    const heightPercent = Math.min(progress, 100);
    
    div.innerHTML = `
        <div class="bar" style="height: 0%" data-target="${heightPercent}">
            <div class="bar-value" data-target="${progress}">0%</div>
        </div>
        <div class="bar-label">${label}</div>
    `;
    
    setTimeout(() => {
        const bar = div.querySelector('.bar');
        const valueEl = div.querySelector('.bar-value');
        bar.style.height = heightPercent + '%';        
        let current = 0;
        const increment = Math.max(1, Math.ceil(progress / 30));
        const interval = setInterval(() => {
            current += increment;
            if (current >= progress) {
                current = progress;
                clearInterval(interval);
            }
            valueEl.textContent = current + '%';
        }, 30);
    }, 100);
    
    return div;
}

function runCode() {
    const code = document.getElementById('codeEditor').value;
    const language = detectLanguage(code);
    const outputFrame = document.getElementById('outputFrame');
    
    if (!code.trim()) {
        outputFrame.srcdoc = '<div style="padding: 20px; color: #999; text-align: center;">Write some code and click Run to see results</div>';
        return;
    }
    
    if (language === 'Python') {
    const encodedCode = btoa(unescape(encodeURIComponent(code)));
    
    outputFrame.srcdoc = `<!DOCTYPE html>
<html><head><meta charset="UTF-8">
<style>
body { font-family: Arial; padding: 20px; background: #fff; }
.loading { text-align: center; color: #667eea; font-weight: bold; padding: 20px; }
.loading-spinner { display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 15px; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
.output { background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 15px; font-family: monospace; white-space: pre-wrap; }
.output-title { font-weight: bold; color: #495057; border-bottom: 2px solid #dee2e6; padding-bottom: 8px; margin-bottom: 10px; }
.output-line { margin: 5px 0; color: #0066cc; }
.error { color: #dc3545; font-weight: bold; background: #fff3cd; border: 1px solid #ffc107; border-radius: 5px; padding: 10px; margin: 10px 0; }
</style>
<script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"><\/script>
</head><body>
<div class="loading" id="loading"><div class="loading-spinner"></div><div>Loading Python...</div></div>
<div id="output" class="output" style="display:none;"><div class="output-title">🐍 Python Output</div><div id="output-content"></div></div>
<script>
async function runPython() {
  const outputDiv = document.getElementById("output");
  const outputContent = document.getElementById("output-content");
  const loading = document.getElementById("loading");
  
  try {
    const pyodide = await loadPyodide();
    loading.style.display = "none";
    outputDiv.style.display = "block";
    
    await pyodide.runPythonAsync(\`
import sys
from io import StringIO
sys.stdout = StringIO()
\`);
    
    const userCodeBase64 = "${encodedCode}";
    const decodedCode = decodeURIComponent(escape(atob(userCodeBase64)));
    
    await pyodide.runPythonAsync(decodedCode);
    
    const output = pyodide.runPython("sys.stdout.getvalue()");
    if (output) {
      output.split("\\n").forEach(line => {
        if (line.trim()) {
          const lineDiv = document.createElement("div");
          lineDiv.className = "output-line";
          lineDiv.textContent = "▶ " + line;
          outputContent.appendChild(lineDiv);
        }
      });
    } else {
      outputContent.innerHTML = "<div class='output-line'>Program executed successfully (no output)</div>";
    }
    
  } catch (error) {
    loading.style.display = "none";
    outputDiv.style.display = "block";
    const errorMsg = error.message || error.toString();
    outputContent.innerHTML = "<div class='error'>✗ Error: " + errorMsg + "</div>";
  }
}
runPython();
<\/script>
</body></html>`;
    return;
}

    if (language === 'HTML') {
        outputFrame.srcdoc = code;
        return;
    }
    
    if (language === 'CSS') {
        outputFrame.srcdoc = `<!DOCTYPE html>
<html><head><meta charset="UTF-8">
<style>${code}</style>
</head><body>
<h1>CSS Applied</h1>
<p>Your CSS styles are loaded. Add some HTML to see the effects!</p>
<div class="box">Sample Box</div>
</body></html>`;
        return;
    }
    
    const escapedCode = code.replace(/\\/g, '\\\\').replace(/`/g, '\\`').replace(/\$/g, '\\$');
    
    const jsHTML = `<!DOCTYPE html>
<html><head><meta charset="UTF-8">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: Arial; padding: 20px; background: #fff; color: #333; line-height: 1.6; }
.console-output { background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 15px; margin-top: 20px; font-family: monospace; white-space: pre-wrap; }
.console-log { color: #0066cc; margin: 5px 0; padding: 3px 0; }
.console-error { color: #dc3545; margin: 5px 0; padding: 3px 0; font-weight: bold; }
.console-title { font-weight: bold; color: #495057; border-bottom: 2px solid #dee2e6; padding-bottom: 8px; margin-bottom: 10px; }
</style>
</head><body>
<div id="output"></div>
<div id="console" class="console-output" style="display:none;">
  <div class="console-title">📟 Console Output</div>
  <div id="console-content"></div>
</div>
<script>
const consoleDiv = document.getElementById("console");
const consoleContent = document.getElementById("console-content");
const originalLog = console.log;
console.log = function(...args) {
  consoleDiv.style.display = "block";
  const logDiv = document.createElement("div");
  logDiv.className = "console-log";
  logDiv.textContent = "▶ " + args.map(arg => typeof arg === "object" ? JSON.stringify(arg, null, 2) : String(arg)).join(" ");
  consoleContent.appendChild(logDiv);
  originalLog.apply(console, args);
};
const originalError = console.error;
console.error = function(...args) {
  consoleDiv.style.display = "block";
  const errorDiv = document.createElement("div");
  errorDiv.className = "console-error";
  errorDiv.textContent = "✗ " + args.join(" ");
  consoleContent.appendChild(errorDiv);
  originalError.apply(console, args);
};
window.onerror = function(msg, url, line) {
  console.error("Error: " + msg + (line ? " (Line " + line + ")" : ""));
  return true;
};
try {
  ${escapedCode}
} catch(e) {
  console.error(e.message);
}
<\/script>
</body></html>`;
    
    outputFrame.srcdoc = jsHTML;
}

function detectLanguage(code) {
    if (!code || code.trim().length === 0) {
        return 'None';
    }
    
    const trimmedCode = code.trim();
    const lowerCode = trimmedCode.toLowerCase();
    
    if (/^<!DOCTYPE/i.test(trimmedCode) ||
        /^<html/i.test(trimmedCode) ||
        /<html[\s>]/i.test(lowerCode) ||
        /<head>/i.test(lowerCode) ||
        /<body>/i.test(lowerCode) ||
        (/<div/i.test(lowerCode) && /<\/div>/i.test(lowerCode)) ||
        (/<p>/i.test(lowerCode) && /<\/p>/i.test(lowerCode)) ||
        /<h[1-6]>/i.test(lowerCode)) {
        return 'HTML';
    }
    
    if (/^\s*[\w-#.]+\s*\{[\s\S]*\}/m.test(code) ||
        /@media|@keyframes/i.test(lowerCode) ||
        /body\s*\{|\.[\w-]+\s*\{|#[\w-]+\s*\{/i.test(lowerCode)) {
        return 'CSS';
    }
    
    if (/\bdef\s+\w+\s*\(/i.test(lowerCode) ||
        /\bprint\s*\(/i.test(lowerCode) ||
        /\bimport\s+\w+/i.test(lowerCode) ||
        /\bfrom\s+\w+\s+import/i.test(lowerCode) ||
        /\binput\s*\(/i.test(lowerCode) ||
        /\bint\s*\(/i.test(lowerCode) ||
        /\bstr\s*\(/i.test(lowerCode) ||
        /\blen\s*\(/i.test(lowerCode) ||
        /\brange\s*\(/i.test(lowerCode) ||
        /\belif\b/i.test(lowerCode) ||
        /^\s*#[^<]/m.test(code) ||
        /:$/m.test(trimmedCode)) {
        return 'Python';
    }
    
    if (/\bfunction\s+\w+\s*\(/i.test(lowerCode) ||
        /\b(const|let|var)\s+\w+/i.test(lowerCode) ||
        /=>/i.test(code) ||
        /console\.log/i.test(lowerCode) ||
        /document\./i.test(lowerCode)) {
        return 'JavaScript';
    }
    
    return 'Unknown';
}

window.addEventListener('message', (e) => {
    if (e.data.type === 'log' || e.data.type === 'error') {
        const consoleOutput = document.getElementById('consoleOutput');
        consoleOutput.style.display = 'block';
        consoleOutput.textContent += (e.data.type === 'error' ? '❌ ' : '✓ ') + e.data.data + '\n';
    }
});

function toggleSetting(element) {
    element.classList.toggle('active');
}

function resetProgress() {
    if (confirm('Are you sure? This will delete all your progress!')) {
        Object.keys(userProgress).forEach(lang => {
            Object.keys(userProgress[lang]).forEach(course => {
                userProgress[lang][course] = { completed: false, progress: 0, time: 0 };
            });
        });
        totalStudyTime = 0;
        
        localStorage.setItem('progress_' + currentUser, JSON.stringify(userProgress));
        localStorage.setItem('studyTime_' + currentUser, '0');
        
        renderCourses();update

        updateDashboard();
        alert('✅ Progress reset successfully!');
    }
}

function checkForUpdates() {
    const currentVersion = '3.4';
    const lastSeenVersion = localStorage.getItem('lastSeenVersion_' + currentUser);
    const isNewUser = !localStorage.getItem('isReturningUser_' + currentUser);
    
    if (isNewUser) {
        localStorage.setItem('isReturningUser_' + currentUser, 'true');
        setTimeout(() => {
            document.getElementById('splashTitle').textContent = 'Recently Released';
            document.getElementById('updateSplash').classList.add('active');
            document.body.classList.add('splash-open');
        }, 300);
    } else if (lastSeenVersion !== currentVersion) {
        setTimeout(() => {
            document.getElementById('splashTitle').textContent = 'New Version';
            document.getElementById('updateSplash').classList.add('active');
            document.body.classList.add('splash-open');
        }, 1000);
    }
}

function closeUpdateSplash() {
    const currentVersion = '3.4';
    localStorage.setItem('lastSeenVersion_' + currentUser, currentVersion);
    document.getElementById('updateSplash').classList.remove('active');
    document.body.classList.remove('splash-open');
}

function showPreviewExplanation() {
    const preview = document.getElementById('previewExplanation');
    preview.classList.add('show');
    
    setTimeout(() => {
        preview.classList.remove('show');
    }, 2500);
}

const highlightCache = new Map();

async function highlightKeywords(text) {
    if (highlightCache.has(text)) {
        return highlightCache.get(text);
    }
    
    if (text.length < 50 || !containsCodeContent(text)) {
        return text;
    }
    
    try {
        const config = await fetchAIConfig();
        
        if (!config.apiKey) {
            highlightCache.set(text, text);
            return text;
        }
        
        const response = await fetch(config.endpoint, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${config.apiKey}`
            },
            body: JSON.stringify({
                model: config.model,
                messages: [
                    {
                        role: 'user',
                        content: `Identify 2-4 CORE programming concepts/terms from this lesson that a beginner MUST understand. Only return technical terms, NOT common words like "automatically", "important", "essential". Return ONLY a JSON array: "${text.replace(/"/g, '\\"').substring(0, 500)}"`
                    }
                ],
                max_tokens: 40,
                temperature: 0.2
            })
        });
        
        if (!response.ok) throw new Error('API failed');
        
        const data = await response.json();
        const content = data.choices[0].message.content;
        
        const match = content.match(/\[.*\]/);
        if (!match) {
            highlightCache.set(text, text);
            return text;
        }
        
        const keywords = JSON.parse(match[0]);
        let highlightedText = text;
        
        const technicalKeywords = keywords.filter(keyword => {
            const lower = keyword.toLowerCase();
            const commonWords = ['automatically', 'important', 'essential', 'fundamental', 'basic', 'simple', 'easy', 'quickly', 'useful', 'great', 'good', 'best'];
            return !commonWords.includes(lower) && keyword.length > 2;
        });
        
        technicalKeywords.forEach(keyword => {
            const parts = highlightedText.split(/(<[^>]+>)/);
            highlightedText = parts.map((part, index) => {
                if (index % 2 === 0) {
                    const regex = new RegExp(`\\b(${keyword.replace(/[()]/g, '\\$&')})\\b`, 'gi');
                    return part.replace(regex, match => {
                        return `<span class="keyword-highlight" onclick="showInlineAI(event, '${match}')" ontouchstart="showInlineAI(event, '${match}')">${match}</span>`;
                    });
                }
                return part;
            }).join('');
        });
        
        highlightCache.set(text, highlightedText);
        return highlightedText;
        
    } catch (error) {
        console.error('Highlight error:', error);
        highlightCache.set(text, text);
        return text;
    }
}

let currentInlinePopup = null;

async function showInlineAI(event, keyword) {
    event.preventDefault(); // Prevent default touch behavior
    event.stopPropagation();
    
    // Close existing popup if any
    if (currentInlinePopup) {
        closeInlineAI();
        return;
    }
    
    const clickedElement = event.target;
    const rect = clickedElement.getBoundingClientRect();
    
    const overlay = document.createElement('div');
    overlay.className = 'inline-ai-overlay';
    overlay.onclick = closeInlineAI;
    overlay.ontouchstart = closeInlineAI; // Add touch support
    document.body.appendChild(overlay);
    
    const popup = document.createElement('div');
    popup.className = 'inline-ai-popup';
    popup.onclick = (e) => e.stopPropagation();
    popup.ontouchstart = (e) => e.stopPropagation(); // Prevent closing on touch inside
    
    // Mobile-specific positioning
    const isMobile = window.innerWidth <= 768;
    
    if (isMobile) {
        // Center popup on mobile
        popup.style.left = '50%';
        popup.style.top = '50%';
        popup.style.transform = 'translate(-50%, -50%) scale(0.8)';
        popup.style.maxWidth = '90vw';
        popup.style.width = '90vw';
    } else {
        // Desktop positioning
        popup.style.left = rect.left + (rect.width / 2) + 'px';
        popup.style.top = rect.top + 'px';
        popup.style.transform = 'translate(-50%, 0) scale(0.8)';
    }
    
    popup.style.opacity = '0';
    popup.style.visibility = 'hidden';
    
    popup.innerHTML = `
        <div class="inline-ai-arrow"></div>
        <div class="inline-ai-header">
            <div class="inline-ai-keyword">${keyword}</div>
            <button class="inline-ai-close" onclick="closeInlineAI()">×</button>
        </div>
        <div class="inline-ai-content">
            <div class="inline-ai-loading">
                <div class="wave-container">
                    <div class="wave-line"></div>
                    <div class="wave-line"></div>
                    <div class="wave-line"></div>
                </div>
            </div>
            <div class="inline-ai-text" style="display: none;"></div>
        </div>
    `;
    
    document.body.appendChild(popup);
    
    const popupRect = popup.getBoundingClientRect();
    const viewportHeight = window.innerHeight;
    const viewportWidth = window.innerWidth;
    const spaceAbove = rect.top;
    const spaceBelow = viewportHeight - rect.bottom;
    const popupHeight = popupRect.height || 250;
    
    let finalTop, finalTransform, arrowPosition;
    
    if (spaceAbove > popupHeight + 30 && spaceAbove > spaceBelow) {
        finalTop = rect.top - 20;
        finalTransform = 'translate(-50%, -100%) scale(0.8)';
        arrowPosition = 'bottom';
        popup.classList.add('popup-above');
    } else {
        finalTop = rect.bottom + 20;
        finalTransform = 'translate(-50%, 0) scale(0.8)';
        arrowPosition = 'top';
        popup.classList.add('popup-below');
    }
    
    let finalLeft = rect.left + (rect.width / 2);
    const popupWidth = popupRect.width || 350;
    
    if (finalLeft - popupWidth / 2 < 10) {
        finalLeft = popupWidth / 2 + 10;
    } else if (finalLeft + popupWidth / 2 > viewportWidth - 10) {
        finalLeft = viewportWidth - popupWidth / 2 - 10;
    }
    
    popup.style.left = finalLeft + 'px';
    popup.style.top = finalTop + 'px';
    popup.style.transform = finalTransform;
    popup.style.visibility = 'visible';
    
    const arrow = popup.querySelector('.inline-ai-arrow');
    if (arrowPosition === 'bottom') {
        arrow.style.bottom = '-10px';
        arrow.style.top = 'auto';
        arrow.style.borderTop = '10px solid rgba(100, 255, 218, 0.4)';
        arrow.style.borderBottom = 'none';
    } else {
        arrow.style.top = '-10px';
        arrow.style.bottom = 'auto';
        arrow.style.borderBottom = '10px solid rgba(100, 255, 218, 0.4)';
        arrow.style.borderTop = 'none';
    }
    
    currentInlinePopup = { overlay, popup };
    
    setTimeout(() => {
    overlay.classList.add('active');
    popup.style.transition = 'all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)';
    
    if (isMobile) {
        // Mobile: scale up to center
        popup.style.transform = 'translate(-50%, -50%) scale(1)';
        popup.style.opacity = '1';
    } else {
        // Desktop: existing logic
        if (arrowPosition === 'bottom') {
            popup.style.transform = 'translate(-50%, -100%) scale(1)';
        } else {
            popup.style.transform = 'translate(-50%, 0) scale(1)';
        }
        popup.style.opacity = '1';
    }
}, 50);
    
    const startTime = Date.now();
    
    // Inside showInlineAI() function, replace the API call with:
try {
    const config = await fetchAIConfig();
    
    if (!config.apiKey) {
        throw new Error('AI API key not configured');
    }
    
    const response = await fetch(config.endpoint, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${config.apiKey}`
        },
        body: JSON.stringify({
            model: config.model,
            messages: [
                {
                    role: 'user',
                    content: `Explain "${keyword}" in programming in 2-3 simple sentences for beginners.`
                }
            ],
            max_tokens: 100,
            temperature: 0.7
        })
    });
    
    if (!response.ok) {
        throw new Error(`API Error: ${response.status}`);
    }

        
        const data = await response.json();
        
        const minLoadingTime = 800;
        const elapsedTime = Date.now() - startTime;
        const remainingTime = Math.max(0, minLoadingTime - elapsedTime);
        
        setTimeout(() => {
            const loadingDiv = popup.querySelector('.inline-ai-loading');
            const textDiv = popup.querySelector('.inline-ai-text');
            
            if (loadingDiv && textDiv) {
                loadingDiv.style.display = 'none';
                textDiv.textContent = data.choices[0].message.content;
                textDiv.style.display = 'block';
            }
        }, remainingTime);
        
    } catch (error) {
        console.error('AI Error:', error);
        const loadingDiv = popup.querySelector('.inline-ai-loading');
        const textDiv = popup.querySelector('.inline-ai-text');
        
        if (loadingDiv && textDiv) {
            loadingDiv.style.display = 'none';
            textDiv.textContent = 'Sorry, could not load explanation. Please try again.';
            textDiv.style.display = 'block';
            textDiv.style.color = '#ff6b6b';
        }
    }
}

function closeInlineAI() {
    if (currentInlinePopup) {
        currentInlinePopup.overlay.remove();
        currentInlinePopup.popup.remove();
        currentInlinePopup = null;
    }
}

function containsCodeContent(text) {
    return /\bfunction\b|\bvar\b|\blet\b|\bconst\b|\bclass\b|\bdef\b|\bprint\b|\breturn\b|<code>/i.test(text);
}

function smoothTypeInline(element, text) {
    const words = text.split(' ');
    element.innerHTML = '';
    let wordIndex = 0;
    
    function revealNextWord() {
        if (wordIndex < words.length) {
            const word = words[wordIndex];
            
            const container = document.createElement('span');
            container.className = 'word-reveal-container';
            
            const glowOuter = document.createElement('span');
            glowOuter.className = 'word-glow-outer';
            
            const glowInner = document.createElement('span');
            glowInner.className = 'word-glow-inner';
            
            const glowCore = document.createElement('span');
            glowCore.className = 'word-glow-core';
            
            const textSpan = document.createElement('span');
            textSpan.className = 'word-reveal-text-inline';
            textSpan.textContent = word + ' ';
            
            container.appendChild(glowOuter);
            container.appendChild(glowInner);
            container.appendChild(glowCore);
            container.appendChild(textSpan);
            element.appendChild(container);
            
            wordIndex++;
            setTimeout(revealNextWord, 85); // Slightly slower for dramatic effect
        }
    }
    
    revealNextWord();
}

// Added smoothTypeWithGlow function that was missing
function smoothTypeWithGlow(element, text) {
    const words = text.split(' ');
    element.innerHTML = '';
    let wordIndex = 0;
    
    function revealNextWord() {
        if (wordIndex < words.length) {
            const word = words[wordIndex];
            
            const container = document.createElement('span');
            container.className = 'word-reveal-container';
            
            const glowOuter = document.createElement('span');
            glowOuter.className = 'word-glow-outer';
            
            const glowInner = document.createElement('span');
            glowInner.className = 'word-glow-inner';
            
            const glowCore = document.createElement('span');
            glowCore.className = 'word-glow-core';
            
            const textSpan = document.createElement('span');
            textSpan.className = 'word-reveal-text';
            textSpan.innerHTML = word + ' ';
            
            container.appendChild(glowOuter);
            container.appendChild(glowInner);
            container.appendChild(glowCore);
            container.appendChild(textSpan);
            element.appendChild(container);
            
            wordIndex++;
            setTimeout(revealNextWord, 80);
        }
    }
    
    revealNextWord();
}

async function showAIExplanation(keyword) {
    const modal = document.getElementById('aiExplanationModal');
    const keywordDisplay = document.getElementById('aiKeyword');
    const loading = document.getElementById('aiLoading');
    const explanationText = document.getElementById('aiExplanationText');
    
    keywordDisplay.textContent = keyword;
    loading.style.display = 'block';
    explanationText.style.display = 'none';
    explanationText.innerHTML = '';
    
    modal.classList.add('active');
    
    const startTime = Date.now();
    
    // ✅ UPDATED: Now uses environment variable
    try {
        const config = getAIConfig();
        
        if (!config.apiKey) {
            throw new Error('AI API key not configured');
        }
        
        const response = await fetch(config.endpoint, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${config.apiKey}`
            },
            body: JSON.stringify({
                model: config.model,
                messages: [
                    {
                        role: 'user',
                        content: `Explain "${keyword}" in programming in 2-3 simple sentences for beginners.`
                    }
                ],
                max_tokens: 100,
                temperature: 0.7
            })
        });
        
        if (!response.ok) {
            throw new Error('API request failed');
        }
        
        const data = await response.json();
        const explanation = data.choices[0].message.content;
        
        const elapsedTime = Date.now() - startTime;
        const remainingTime = Math.max(0, 2000 - elapsedTime);
        
        setTimeout(() => {
            loading.style.display = 'none';
            explanationText.style.display = 'block';
            smoothTypeWithGlow(explanationText, explanation);
        }, remainingTime);
        
    } catch (error) {
        console.error('Error fetching AI explanation:', error);
        
        const explanations = {
            'print()': 'The <code>print()</code> function displays output to the console or terminal. It\'s one of the most basic and essential functions for seeing what your code is doing.',
            'variable': 'A variable is a named container that stores data. Think of it as a labeled box where you can put information and retrieve it later using its name.',
            'function': 'A function is a reusable block of code that performs a specific task. Functions help organize code, avoid repetition, and make programs easier to understand and maintain.',
            'loop': 'A loop repeats a block of code multiple times. Common types include <code>for</code> loops (repeat a specific number of times) and <code>while</code> loops (repeat while a condition is true).',
            'array': 'An array is an ordered collection of items stored in a single variable. You can access items by their position (index), starting from 0.',
            'object': 'An object stores data as key-value pairs, like a dictionary. Each piece of data has a name (key) and a value associated with it.',
            'const': 'The <code>const</code> keyword declares a constant variable that cannot be reassigned. Once you set its value, it stays the same throughout your program.',
            'let': 'The <code>let</code> keyword declares a variable that can be changed (reassigned) later in your code. Use it for values that need to update.',
            'state': 'State is data that changes over time in your application. When state updates, the UI automatically re-renders to reflect the new data.',
            'props': 'Props (properties) are how you pass data from a parent component to a child component in React. They work like function parameters.',
            'JSX': 'JSX is a syntax extension that lets you write HTML-like code in JavaScript. React transforms JSX into JavaScript function calls.',
            'DOM': 'The DOM (Document Object Model) is a programming interface for web documents. It represents the page structure as a tree of objects that JavaScript can manipulate.',
            'useState': 'useState is a React Hook that lets you add state to functional components. It returns the current state value and a function to update it.',
            'useEffect': 'useEffect is a React Hook for side effects. It runs after render and is perfect for data fetching, subscriptions, or manually changing the DOM.',
            'component': 'A component is a reusable piece of UI in React. Components are like JavaScript functions that accept inputs (props) and return React elements.',
            'CSS': 'CSS (Cascading Style Sheets) is a language for styling HTML elements. It controls colors, layouts, fonts, and visual appearance of web pages.',
            'HTML': 'HTML (HyperText Markup Language) is the standard language for creating web pages. It uses tags to structure content like headings, paragraphs, and links.',
            'string': 'A string is a sequence of characters used to represent text. Strings are enclosed in quotes and can contain letters, numbers, and symbols.',
            'boolean': 'A boolean is a data type with only two values: true or false. Booleans are used for logic and decision-making in programs.',
            'if': 'The if statement executes code only when a condition is true. It\'s fundamental for making decisions in your programs.',
            'for': 'A for loop repeats code a specific number of times. It\'s commonly used to iterate through arrays or perform actions a set number of times.'
        };
        
        const explanation = explanations[keyword.toLowerCase()] || 
            `<strong>${keyword}</strong> is an important programming concept. Understanding it will help you write better code.`;
        
        const elapsedTime = Date.now() - startTime;
        const remainingTime = Math.max(0, 2000 - elapsedTime);
        
        setTimeout(() => {
            loading.style.display = 'none';
            explanationText.style.display = 'block';
            smoothTypeWithGlow(explanationText, explanation + '<p style="color: #8b949e; font-size: 0.9em; margin-top: 15px;">⚠️ AI explanation unavailable - showing fallback content</p>');
        }, remainingTime);
    }
}

function closeAIExplanation(event) {
    if (event && event.target !== event.currentTarget) return;
    document.getElementById('aiExplanationModal').classList.remove('active');
}

function createPreviewPanel() {
    const existingPanel = document.querySelector('.preview-panel');
    if (existingPanel) return existingPanel;
    
    const lessonView = document.querySelector('.lesson-view');
    const chatMessages = document.querySelector('.chat-messages');
    
    // Wrap content in container
    const container = document.createElement('div');
    container.className = 'lesson-container';
    
    const mainContent = document.createElement('div');
    mainContent.className = 'lesson-main';
    
    // Move chat messages to main content
    mainContent.appendChild(chatMessages);
    
    // Create preview panel
    const previewPanel = document.createElement('div');
    previewPanel.className = 'preview-panel';
    previewPanel.innerHTML = `
        <h3>
            <span>👁️</span>
            Live Preview
        </h3>
        <div class="preview-content" id="livePreview">
            <p style="color: #8b949e; text-align: center; padding: 40px 20px;">
                Preview will appear here when you reach code examples
            </p>
        </div>
    `;
    
    container.appendChild(mainContent);
    container.appendChild(previewPanel);
    
    lessonView.insertBefore(container, lessonView.querySelector('.lesson-progress'));
    
    return previewPanel;
}

function updateLivePreview(content, type = 'html') {
    const previewContent = document.getElementById('livePreview');
    if (!previewContent) return;
    
    if (type === 'html') {
        const iframe = document.createElement('iframe');
        iframe.className = 'preview-iframe';
        iframe.srcdoc = `
            <!DOCTYPE html>
            <html>
            <head>
                <style>
                    body { 
                        font-family: Arial, sans-serif; 
                        padding: 20px;
                        margin: 0;
                    }
                </style>
            </head>
            <body>${content}</body>
            </html>
        `;
        previewContent.innerHTML = '';
        previewContent.appendChild(iframe);
    } else if (type === 'css') {
        const iframe = document.createElement('iframe');
        iframe.className = 'preview-iframe';
        iframe.srcdoc = `
            <!DOCTYPE html>
            <html>
            <head>
                <style>
                    ${content}
                    body { padding: 20px; }
                </style>
            </head>
            <body>
                <div class="box">Sample Box</div>
                <button class="button">Sample Button</button>
                <p>Sample Text</p>
            </body>
            </html>
        `;
        previewContent.innerHTML = '';
        previewContent.appendChild(iframe);
    } else if (type === 'animation') {
        const iframe = document.createElement('iframe');
        iframe.className = 'preview-iframe';
        iframe.srcdoc = `
            <!DOCTYPE html>
            <html>
            <head>
                <style>
                    body { 
                        display: flex; 
                        justify-content: center; 
                        align-items: center; 
                        min-height: 100vh; 
                        margin: 0;
                        background: #f0f0f0;
                    }
                    ${content}
                </style>
            </head>
            <body>
                <div class="element">Hover Me!</div>
            </body>
            </html>
        `;
        previewContent.innerHTML = '';
        previewContent.appendChild(iframe);
    }
}

// Auto-detect code examples and show previews
function enhanceCodeExamples() {
    const codeExamples = document.querySelectorAll('.code-example');
    
    codeExamples.forEach((example, index) => {
        const code = example.querySelector('code');
        if (!code) return;
        
        const codeText = code.textContent;
        
        // Detect code type
        let type = 'html';
        if (codeText.includes('transition:') || codeText.includes('@keyframes') || codeText.includes('animation:')) {
            type = 'animation';
        } else if (codeText.includes('{') && codeText.includes('}') && codeText.includes(':')) {
            type = 'css';
        }
        
        // Add "Try It" button
        if (!example.querySelector('.try-it-btn')) {
            const tryBtn = document.createElement('button');
            tryBtn.className = 'try-it-btn';
            tryBtn.innerHTML = '▶️ Try It Live';
            tryBtn.onclick = () => {
                updateLivePreview(codeText, type);
                tryBtn.innerHTML = '✅ Preview Updated!';
                setTimeout(() => {
                    tryBtn.innerHTML = '▶️ Try It Live';
                }, 2000);
            };
            example.appendChild(tryBtn);
        }
    });
}

// ============================================
// KEYWORD TOOLTIP PORTAL SYSTEM
// ============================================

let activeTooltip = null;
let tooltipTimeout = null;

// Create and show tooltip
function showKeywordTooltip(element) {
    // Clear any pending hide
    if (tooltipTimeout) {
        clearTimeout(tooltipTimeout);
        tooltipTimeout = null;
    }
    
    // Remove existing tooltip
    if (activeTooltip) {
        hideKeywordTooltip();
    }
    
    const rect = element.getBoundingClientRect();
    const scrollY = window.pageYOffset || document.documentElement.scrollTop;
    const scrollX = window.pageXOffset || document.documentElement.scrollLeft;
    
    // Create tooltip
    const tooltip = document.createElement('div');
    tooltip.className = 'keyword-tooltip-portal';
    tooltip.innerHTML = '💡 Ask AI';
    
    // Position ABOVE the keyword with spacing
    const tooltipTop = rect.top + scrollY - 60; // 60px above
    const tooltipLeft = rect.left + scrollX + (rect.width / 2);
    
    tooltip.style.top = tooltipTop + 'px';
    tooltip.style.left = tooltipLeft + 'px';
    tooltip.style.transform = 'translateX(-50%) translateY(10px) scale(0.9)';
    tooltip.style.opacity = '0';
    
    // Create arrow
    const arrow = document.createElement('div');
    arrow.className = 'keyword-tooltip-arrow';
    
    const arrowTop = rect.top + scrollY - 12; // Just above keyword
    const arrowLeft = rect.left + scrollX + (rect.width / 2);
    
    arrow.style.top = arrowTop + 'px';
    arrow.style.left = arrowLeft + 'px';
    arrow.style.transform = 'translateX(-50%) scale(0)';
    arrow.style.opacity = '0';
    
    // Add to body
    document.body.appendChild(tooltip);
    document.body.appendChild(arrow);
    
    // Animate in
    requestAnimationFrame(() => {
        tooltip.style.transition = 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
        tooltip.style.transform = 'translateX(-50%) translateY(0) scale(1)';
        tooltip.style.opacity = '1';
        
        arrow.style.transition = 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
        arrow.style.transform = 'translateX(-50%) scale(1)';
        arrow.style.opacity = '1';
    });
    
    activeTooltip = { tooltip, arrow, element };
}

// Hide tooltip
function hideKeywordTooltip() {
    if (!activeTooltip) return;
    
    const { tooltip, arrow } = activeTooltip;
    
    // Animate out
    tooltip.style.transform = 'translateX(-50%) translateY(10px) scale(0.9)';
    tooltip.style.opacity = '0';
    arrow.style.transform = 'translateX(-50%) scale(0)';
    arrow.style.opacity = '0';
    
    // Remove after animation
    setTimeout(() => {
        if (tooltip && tooltip.parentNode) tooltip.remove();
        if (arrow && arrow.parentNode) arrow.remove();
    }, 300);
    
    activeTooltip = null;
}

// Event listeners for desktop
document.addEventListener('mouseover', function(e) {
    if (e.target.classList.contains('keyword-highlight')) {
        // Only show on desktop
        if (window.innerWidth > 768) {
            showKeywordTooltip(e.target);
        }
    }
});

document.addEventListener('mouseout', function(e) {
    if (e.target.classList.contains('keyword-highlight')) {
        // Delay hiding slightly to prevent flicker
        tooltipTimeout = setTimeout(() => {
            hideKeywordTooltip();
        }, 100);
    }
});

// Update position on scroll
let scrollTimeout;
window.addEventListener('scroll', function() {
    if (activeTooltip) {
        // Hide tooltip on scroll
        hideKeywordTooltip();
    }
}, true);

// Update position on resize
window.addEventListener('resize', function() {
    if (activeTooltip) {
        hideKeywordTooltip();
    }
});

// Clean up on page unload
window.addEventListener('beforeunload', function() {
    if (activeTooltip) {
        hideKeywordTooltip();
    }
});

// ============================================
// LANGUAGE FILTER FUNCTIONS
// ============================================

function toggleFilter() {
    const filter = document.getElementById('languageFilter');
    if (filter) {
        filter.classList.toggle('active');
    }
}

function filterChart(language) {
    const filter = document.getElementById('languageFilter');
    const filterText = document.getElementById('filterText');
    const options = document.querySelectorAll('.filter-option');
    
    // Update active state
    options.forEach(opt => opt.classList.remove('active'));
    event.target.classList.add('active');
    
    // Update filter text with icons
    const icons = {
        'all': '🌐 All Languages',
        'python': '🐍 Python',
        'javascript': '⚡ JavaScript',
        'html': '🌐 HTML',
        'css': '🎨 CSS',
        'react': '⚛️ React'
    };
    
    if (filterText) {
        filterText.textContent = icons[language] || '🌐 All Languages';
    }
    
    // Close dropdown
    if (filter) {
        filter.classList.remove('active');
    }
    
    // Switch to the selected chart
    switchChart(language);
}

// Close filter dropdown when clicking outside
document.addEventListener('click', function(e) {
    const filter = document.getElementById('languageFilter');
    if (filter && !filter.contains(e.target)) {
        filter.classList.remove('active');
    }
});

// ============================================
// CHART SWITCHING (Update existing function)
// ============================================

function switchChart(type) {
    // Remove active from all tabs
    document.querySelectorAll('.chart-tab').forEach(t => t.classList.remove('active'));
    
    // Remove active from all containers
    document.querySelectorAll('.chart-container').forEach(c => c.classList.remove('active'));
    
    // Add active to clicked tab (if triggered by tab click)
    if (event && event.target && event.target.classList.contains('chart-tab')) {
        event.target.classList.add('active');
    } else {
        // If triggered by filter, activate the corresponding tab
        const tabs = document.querySelectorAll('.chart-tab');
        tabs.forEach(tab => {
            const tabText = tab.textContent.toLowerCase();
            if (tabText.includes(type) || (type === 'all' && tabText.includes('all'))) {
                tab.classList.add('active');
            }
        });
    }
    
    // Show the selected chart
    const chartToShow = document.getElementById(type + 'Chart');
    if (chartToShow) {
        chartToShow.classList.add('active');
    }
    
    // Update charts
    updateCharts();
}
</script>
</body>
</html>
